* Bioinformatics                                                     :career:
:PROPERTIES:
:CREATED:  [2020-07-02 Thu 13:14]
:ID:       b03025b7-4b60-4196-8d7f-d947c7d64b28
:header-args: :tangle no :tangle-mode (identity #o555) :mkdirp yes :noweb yes :comments org
:END:
** [[file:~/repos/basecamp/basecamp.org::*Basecamp][Basecamp]]
** [[id:271b4d5f-727e-496e-b835-8fe9f8655655][Bioinformatics pipeline]]
** [[id:d482d49c-9dbe-43cd-a188-b1662a9ce348][Bioinformatics research project module]]
** [[id:0f1f4aa4-c755-42ff-8f81-8a32c14293a0][Cell-free DNA (cfDNA) and circulating-tumor DNA (ctDNA)]]
** [[id:39F11977-BE11-47CF-98B1-14CE6D9B97C4][Information Science / Data Science]]
** Repository administration
[[file:.gitignore]]
*** README
:PROPERTIES:
:ID:       72583990-6a92-4ccf-bc5e-08442ef893a9
:export_file_name: README
:END:

[![validate-schema](https://img.shields.io/github/actions/workflow/status/jeszyman/biotools/validate-schema.yaml?branch=master&label=validate-schema)](https://github.com/jeszyman/biotools/actions/workflows/validate-schema.yaml)
*** Continuous Improvement
**** Metadata validation
#+begin_src yaml :tangle ./.github/workflows/validate-schema.yaml
name: validate-schema
on:
  push:
    branches: [master, main]
  pull_request:
    branches: [master, main]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          pip install frictionless openpyxl pandas

      - name: Run validation
        run: |
          bash scripts/ci_validate.sh

      - name: Display validation report
        if: always()  # Show report even if validation fails
        run: |
          cat examples/validation-report.txt
#+end_src

** Bioinformatics metadata
#+begin_src python :tangle ./scripts/validate_data_schema.py
#!/usr/bin/env python3
"""
Validate a Frictionless schema YAML file structure only (no data validation).
CLI:
  --schema  Path to Frictionless Package/descriptor (e.g., data_model.yaml)
  --cwd     Optional working directory (chdir before running)
Exit: 0 if valid, 1 otherwise.
"""
import os
import sys
import argparse
from frictionless import Package, FrictionlessException

def parse_args():
    p = argparse.ArgumentParser(description="Validate Frictionless schema YAML structure only.")
    p.add_argument("--schema", required=True, help="Path to Package/descriptor YAML (e.g., data_model.yaml)")
    p.add_argument("--cwd", default=None, help="Optional working directory (chdir before running)")
    return p.parse_args()


def validate_schema_file(path: str):
    """Validate Frictionless schema/package structure only (no data validation)."""
    errors = []
    resource_reports = []

    # Try to load the package
    try:
        pkg = Package(path)  # validate package metadata (no data read)
    except FrictionlessException as e:
        errors.append(("package-error", e.error.note))
        for r in e.reasons:
            errors.append((r.type, r.note))
        return resource_reports, errors

    # Validate each resource's schema
    for res in pkg.resources:
        try:
            res.schema.to_descriptor()  # validate schema only
            resource_reports.append((res.name, "OK"))
        except FrictionlessException as e:
            errs = [(f"{res.name}: {e.error.type}", e.error.note)]
            errs.extend([(f"{res.name}: {r.type}", r.note) for r in e.reasons])
            errors.extend(errs)
            resource_reports.append((res.name, "ERROR"))
        except Exception as e:
            errors.append((f"{res.name}: schema-error", str(e)))
            resource_reports.append((res.name, "ERROR"))

    return resource_reports, errors


def render_report(path, resource_reports, errors):
    """Render validation report."""
    print(f"Schema validation report for: {path}")
    print()

    if resource_reports:
        print(f"Resources found: {len(resource_reports)}")
        for name, status in resource_reports:
            status_symbol = "✓" if status == "OK" else "✗"
            print(f"  {status_symbol} {name}: {status}")
        print()

    if not errors:
        print("Result: ✓ All schemas are valid")
        return True
    else:
        print("Schema errors found:")
        for error_type, note in errors:
            print(f"  • {error_type}: {note}")
        print()
        print("Result: ✗ Schema validation failed")
        return False


def main():
    args = parse_args()

    if args.cwd:
        os.chdir(args.cwd)

    try:
        resource_reports, errors = validate_schema_file(args.schema)
        is_valid = render_report(args.schema, resource_reports, errors)
        return 0 if is_valid else 1
    except Exception as e:
        print(f"Error validating schema file '{args.schema}': {e}")
        return 1


if __name__ == "__main__":
    sys.exit(main())
#+end_src

#+begin_src python :tangle ./scripts/input_data_validator.py
# - Data model validator

#!/usr/bin/env python3
# ./scripts/input_data_validator.py
"""
Validate ALL Excel sheets corresponding to resources in a Frictionless package.
Strict header check: every schema-declared field must be present in the sheet header.
Only schema-declared fields are validated (extra columns ignored).
Includes foreign key validation across resources.

Exit 0 iff every resource validates; otherwise 1.

CLI:
  --schema   Path to Frictionless Package/descriptor (e.g., data_model.yaml)
  --xlsx     Path to the Excel file
  --report   Path to write a compact, aggregated report (text)
  --cwd      Optional working directory (chdir before running)
"""
import os
import sys
import argparse
from collections import defaultdict, Counter
from typing import Dict, List, Tuple

from frictionless import Package, Resource, formats, FrictionlessException


# -------------------- arg parsing --------------------
def parse_args():
    p = argparse.ArgumentParser(description="Validate Excel vs schema for ALL resources (schema fields only, strict header).")
    p.add_argument("--schema", required=True, help="Path to Package/descriptor YAML (e.g., data_model.yaml)")
    p.add_argument("--xlsx", required=True, help="Path to Excel file")
    p.add_argument("--report", required=True, help="Where to write compact validation report (txt)")
    p.add_argument("--cwd", default=None, help="Optional working directory (chdir before running)")
    return p.parse_args()


# -------------------- header checker --------------------
class HeaderError(Exception):
    """Raised when schema-declared fields are missing from the sheet header."""
    def __init__(self, missing_fields):
        self.missing_fields = list(missing_fields)
        msg = "Missing schema fields in sheet header: " + ", ".join(self.missing_fields)
        super().__init__(msg)


class HeaderReport:
    """Adapter so header failures render via the same code path as frictionless reports."""
    def __init__(self, missing_fields):
        self.valid = False
        self._missing_fields = list(missing_fields)

    def flatten(self, fields):
        # expected fields: ["rowNumber","fieldName","code","message"]
        out = []
        for f in self._missing_fields:
            out.append((None, f, "missing-field", f"Column '{f}' not found in sheet header"))
        return out


# -------------------- utils --------------------
def is_blank_value(value):
    if value is None:
        return True
    if isinstance(value, str):
        return value.strip() == ""
    return False if isinstance(value, (int, float)) else (str(value).strip() == "")


def is_row_blank(row_dict, threshold=1):
    return sum(1 for v in row_dict.values() if not is_blank_value(v)) < threshold


# -------------------- core validation --------------------
def validate_one_table(xlsx_path: str, sheet: str, pkg_path: str):
    """
    Validate a single sheet by projecting to schema fields only with STRICT header check.
    Returns a report-like object with .valid and .flatten(...).
    """
    pkg = Package(pkg_path)
    res = pkg.get_resource(sheet)  # resource name == sheet name
    schema = res.schema
    expected = [f.name for f in schema.fields]

    ctrl = formats.ExcelControl(sheet=sheet)
    projected_rows = []
    blank_rows_skipped = 0

    try:
        with Resource(path=xlsx_path, control=ctrl) as src:
            header_labels = list(src.header.to_list()) if src.header else []
            missing_from_sheet = [f for f in expected if f not in header_labels]
            if missing_from_sheet:
                raise HeaderError(missing_from_sheet)

            for row in src.read_rows():
                d = row.to_dict() if hasattr(row, "to_dict") else dict(row)
                proj = {k: d.get(k) for k in expected}
                if is_row_blank(proj, threshold=1):
                    blank_rows_skipped += 1
                    continue
                projected_rows.append(proj)
    except FrictionlessException as e:
        # Treat missing sheet / IO / parse failures as header-level issues
        return HeaderReport([f"<sheet:{sheet}> {e.error.note or 'sheet error'}"])
    except HeaderError as e:
        return HeaderReport(e.missing_fields)

    # Validate only schema fields
    return Resource(data=projected_rows, schema=schema).validate()


def flatten_issues(report):
    return list(report.flatten(["rowNumber", "fieldName", "code", "message"]))


def render_table_block(name: str, report, max_rows=20) -> Tuple[str, bool, int, int]:
    """Return (block_text, valid, n_header, n_rows_with_issues)."""
    lines = []
    lines.append(f"[{name}] valid: {report.valid}\n")

    issues = flatten_issues(report)

    # header issues
    header_issues = {}
    for row, field, code, msg in issues:
        if row is None:
            header_issues[field or ""] = (msg or "").strip()
    if header_issues:
        lines.append("  Header problems:")
        for f, m in header_issues.items():
            lines.append(f"    - {f}: {m}")
        lines.append("")

    # data issues grouped by row
    by_row = defaultdict(list)
    for row, field, code, msg in issues:
        if row is None:
            continue
        by_row[row].append((field or "", code or "error", (msg or "").strip()))

    # code summary
    code_counts = Counter(code for rows in by_row.values() for _, code, _ in rows)
    if code_counts:
        lines.append("  Error code summary:")
        for c, n in code_counts.most_common():
            lines.append(f"    - {c}: {n}")
        lines.append("")

    # sample rows
    n_show = min(max_rows, len(by_row))
    lines.append(f"  First {n_show} problematic rows (of {len(by_row)}):")
    for rownum in sorted(by_row)[:n_show]:
        seen = set()
        compact = []
        for field, code, msg in by_row[rownum]:
            key = (field, code, msg[:120])
            if key in seen:
                continue
            seen.add(key)
            if len(msg) > 140:
                msg = msg[:137] + "..."
            compact.append((field, code, msg))
        lines.append(f"    - row {rownum}:")
        for field, code, msg in compact:
            label = field if field else "<row>"
            lines.append(f"      {label}: [{code}] {msg}")
    lines.append("")

    return "\n".join(lines), bool(report.valid), len(header_issues), len(by_row)


# -------------------- foreign key validation --------------------
def validate_foreign_keys(xlsx_path: str, schema_path: str):
    """
    Validate foreign key constraints across all resources.
    Returns list of FK violation issues.
    """
    fk_issues = []
    try:
        # Create package with paths pointing to actual xlsx
        pkg = Package(schema_path)
        for res in pkg.resources:
            res.path = xlsx_path
            res.control = {"type": "excel", "sheet": res.name}

        # Validate entire package (includes FK checks)
        pkg_report = pkg.validate()

        if not pkg_report.valid:
            # Extract FK-specific errors
            for task in pkg_report.tasks:
                if hasattr(task, 'errors'):
                    for error in task.errors:
                        # Foreign key errors typically have 'foreign' or 'key' in type
                        error_type = getattr(error, 'type', '')
                        if 'foreign' in error_type.lower() or 'key' in error_type.lower():
                            fk_issues.append({
                                'resource': task.resource.name if hasattr(task, 'resource') else '<unknown>',
                                'row': getattr(error, 'rowNumber', None),
                                'field': getattr(error, 'fieldName', None),
                                'type': error_type,
                                'message': getattr(error, 'message', str(error))
                            })
    except Exception as e:
        fk_issues.append({
            'resource': '<package>',
            'row': None,
            'field': None,
            'type': 'foreign-key-validation-error',
            'message': str(e)
        })

    return fk_issues


# -------------------- main --------------------
def main():
    args = parse_args()
    if args.cwd:
        os.chdir(args.cwd)

    pkg = Package(args.schema)
    resource_names = [r.name for r in pkg.resources]

    blocks: List[str] = []
    all_valid = True
    total_header_issues = 0
    total_rows_with_issues = 0
    total_data_issues = 0

    # Validate each resource individually
    for name in resource_names:
        report = validate_one_table(args.xlsx, name, args.schema)
        block, ok, n_hdr, n_rows = render_table_block(name, report)
        blocks.append(block)
        all_valid = all_valid and ok
        total_header_issues += n_hdr
        total_rows_with_issues += n_rows

        # count total data issues from the already-flattened view
        issues = flatten_issues(report)
        data_issues = [t for t in issues if t[0] is not None]
        total_data_issues += len(data_issues)

    # Validate foreign keys across resources
    fk_issues = validate_foreign_keys(args.xlsx, args.schema)

    if fk_issues:
        fk_lines = [
            "=== Foreign Key Violations ===",
            f"Total FK issues: {len(fk_issues)}",
            ""
        ]
        for issue in fk_issues[:20]:  # Show first 20
            row_info = f"row {issue['row']}" if issue['row'] else "header"
            field_info = f"[{issue['field']}]" if issue['field'] else ""
            fk_lines.append(f"  {issue['resource']} {row_info} {field_info}: {issue['message']}")
        if len(fk_issues) > 20:
            fk_lines.append(f"  ... and {len(fk_issues) - 20} more")
        fk_lines.append("")
        blocks.append("\n".join(fk_lines))
        all_valid = False

    total_fk_issues = len(fk_issues)

    summary = [
        "=== Validation Summary (all tables) ===",
        f"Resources checked: {len(resource_names)}",
        f"All valid: {all_valid}",
        f"Header issues: {total_header_issues}",
        f"Rows with issues: {total_rows_with_issues}",
        f"Total data issues: {total_data_issues}",
        f"Foreign key issues: {total_fk_issues}",
        "",
        f"[input-data-validator] wrote report -> {args.report}",
    ]

    os.makedirs(os.path.dirname(args.report), exist_ok=True)
    with open(args.report, "w", encoding="utf-8") as fh:
        fh.write("\n".join(blocks + summary))

    print(summary[-1])
    return 0 if all_valid else 1


if __name__ == "__main__":
    sys.exit(main())
#+end_src

#+begin_src bash :tangle ./scripts/ci_validate.sh
#!/bin/bash
set -e

echo "==> Validating schema structure..."
python scripts/validate_data_schema.py --schema examples/example-metadata-schema.yaml

echo "==> Building Excel from TSVs..."
python scripts/build_excel_from_tsv.py \
  --schema examples/example-metadata-schema.yaml \
  --tsv-dir examples \
  --output examples/example-metadata.xlsx

echo "==> Validating data against schema..."
python scripts/input_data_validator.py \
  --schema examples/example-metadata-schema.yaml \
  --xlsx examples/example-metadata.xlsx \
  --report examples/validation-report.txt

echo "==> Validation complete!"
echo ""
cat examples/validation-report.txt
#+end_src

#+begin_src python :tangle ./scripts/build_excel_from_tsv.py
#!/usr/bin/env python3
"""
Build Excel workbook from TSV files based on Frictionless schema.

For each resource in the schema, reads the corresponding TSV file
and creates a sheet in the Excel workbook.

CLI:
  --schema    Path to Frictionless schema YAML
  --tsv-dir   Directory containing TSV files (named {resource}.tsv)
  --output    Path to write Excel file
  --cwd       Optional working directory (chdir before running)

Exit: 0 if successful, 1 otherwise.
"""
import os
import sys
import argparse
from pathlib import Path

import pandas as pd
from frictionless import Package


def parse_args():
    p = argparse.ArgumentParser(
        description="Build Excel workbook from TSV files based on schema."
    )
    p.add_argument("--schema", required=True, help="Path to Frictionless schema YAML")
    p.add_argument("--tsv-dir", required=True, help="Directory containing TSV files")
    p.add_argument("--output", required=True, help="Output Excel file path")
    p.add_argument("--cwd", default=None, help="Optional working directory")
    return p.parse_args()


def build_excel_from_tsvs(schema_path: str, tsv_dir: str, output_path: str):
    """
    Read schema, load TSV files, create Excel workbook.

    Args:
        schema_path: Path to Frictionless schema YAML
        tsv_dir: Directory containing TSV files named {resource}.tsv
        output_path: Where to write the Excel file

    Returns:
        Dict with resource names and row counts
    """
    # Load schema to get resource names
    pkg = Package(schema_path)
    resource_names = [r.name for r in pkg.resources]

    tsv_dir_path = Path(tsv_dir)
    output_dir = Path(output_path).parent

    # Ensure output directory exists
    output_dir.mkdir(parents=True, exist_ok=True)

    # Track results
    results = {}
    missing = []

    # Create Excel writer
    with pd.ExcelWriter(output_path, engine='openpyxl') as writer:
        for resource_name in resource_names:
            tsv_path = tsv_dir_path / f"{resource_name}.tsv"

            if not tsv_path.exists():
                missing.append(resource_name)
                print(f"Warning: TSV file not found for resource '{resource_name}': {tsv_path}")
                continue

            # Read TSV
            # keep_default_na=False prevents pandas from converting strings like "NA" to NaN
            df = pd.read_csv(tsv_path, sep='\t', keep_default_na=False)

            # Replace empty strings with None for cleaner Excel representation
            df = df.replace('', None)

            # Write to Excel sheet
            df.to_excel(writer, sheet_name=resource_name, index=False)

            results[resource_name] = len(df)
            print(f"✓ {resource_name}: {len(df)} rows")

    if missing:
        print(f"\nWarning: {len(missing)} resource(s) had no TSV file:")
        for name in missing:
            print(f"  - {name}")

    return results, missing


def main():
    args = parse_args()

    if args.cwd:
        os.chdir(args.cwd)

    try:
        results, missing = build_excel_from_tsvs(
            args.schema,
            args.tsv_dir,
            args.output
        )

        total_rows = sum(results.values())
        print(f"\nCreated {args.output}")
        print(f"Total resources: {len(results)}")
        print(f"Total rows: {total_rows}")

        # Exit with error if any TSVs were missing
        if missing:
            print(f"\nError: {len(missing)} resource(s) missing TSV files")
            return 1

        return 0

    except Exception as e:
        print(f"Error building Excel from TSVs: {e}", file=sys.stderr)
        import traceback
        traceback.print_exc()
        return 1


if __name__ == "__main__":
    sys.exit(main())
#+end_src

- With Libreoffice calc
  - Use Excel A1 formula syntax (Tools -> Options -> LibreOffice Calc -> Formula -> Formula Options -> Formula syntax)
*** Example data
#+name: subjects
| subject_id | organism_type | notes                   |
|------------+---------------+-------------------------|
| par0001    | human         | Initial enrollment      |
| par0002    | human         |                         |
| par0003    | human         | Withdrawn from study    |
| mou0001    | mouse         | PDX model establishment |
| mou0002    | mouse         | Control group           |
| mou0003    | mouse         |                         |

#+name: participants
| participant_id | institution_id | study_protocol_id | sex | birth_year | notes                      |
|----------------+----------------+-------------------+-----+------------+----------------------------|
| par0001        | mayo           |         21-004567 | f   |       1978 | Consented for biospecimens |
| par0002        | washu          |         202012345 | m   |       1965 |                            |
| par0003        | jhh            |       NA_00098765 | f   |       1992 | Lost to follow-up          |

#+name: mice
| mouse_id | strain   | sex | birth_date | notes                      |
|----------+----------+-----+------------+----------------------------|
| mou0001  | NOD-SCID | f   | 2024-03-15 | Engrafted with patient PDX |
| mou0002  | C57BL/6  | m   | 2024-02-20 | Wild-type control          |
| mou0003  | NOD-SCID | f   | 2024-03-22 |                            |

#+name: samples
| sample_id | subject_id | collection_date | sample_type | sample_volume_ml | notes               |
|-----------+------------+-----------------+-------------+------------------+---------------------|
| sam0001   | par0001    |      2024-06-15 | blood       |              8.5 | Baseline collection |
| sam0002   | par0001    |      2024-09-20 | blood       |              8.0 | 3-month follow-up   |
| sam0003   | par0002    |      2024-05-10 | tumor       |                  | Surgical resection  |
| sam0004   | par0002    |      2024-05-10 | blood       |              9.2 | Same-day blood draw |
| sam0005   | mou0001    |      2024-06-01 | tumor       |                  | PDX tumor harvest   |
| sam0006   | mou0001    |      2024-06-01 | blood       |              0.2 | Terminal bleed      |
| sam0007   | mou0002    |      2024-05-25 | blood       |             0.15 | Serial sampling     |

#+name: libraries
| library_id | sample_id | isolation_method | adapter_type | library_type | input_ul | input_pg_ml | notes                  |
|------------+-----------+------------------+--------------+--------------+----------+-------------+------------------------|
| lib0001    | sam0001   | truseq           | illumina     | paired_end   |      100 |        2.34 | Standard prep          |
| lib0002    | sam0002   | truseq           | illumina     | paired_end   |      100 |        1.89 |                        |
| lib0003    | sam0003   | truseq           | illumina     | paired_end   |       50 |       15.67 | High quality tumor DNA |
| lib0004    | sam0004   | emseq_v2         | xgen         | paired_end   |      100 |        3.21 | Methylation profiling  |
| lib0005    | sam0005   | truseq           | illumina     | paired_end   |       25 |       45.80 |                        |
| lib0006    | sam0006   | truseq           | illumina     | single_end   |       10 |        0.56 | Low input cfDNA        |
| lib0007    | sam0007   | truseq           | illumina     | paired_end   |       10 |        0.42 |                        |


#+name: runs
| run_id  | alt_run_id | run_institute | sequencer    |   run_date | flowcell_id | notes                      |
|---------+------------+---------------+--------------+------------+-------------+----------------------------|
| run0001 | HWTG7DSXY  | mayo          | novaseq_6000 | 2024-07-01 | HWTG7DSXY   | Full flowcell run          |
| run0002 | HKVN3BBXY  | washu         | hiseq_4000   | 2024-07-15 | HKVN3BBXY   | Shared with other projects |
| run0003 |            | mayo          | nextseq_2000 | 2024-08-10 |             | Small pilot run            |

#+name: fastqs
| r1_basename                     | library_id | run_id  | multiplexing   | lane_number | r1_md5                           | r2_md5                           | notes              |
|---------------------------------+------------+---------+----------------+-------------+----------------------------------+----------------------------------+--------------------|
| lib0001_S1_L001_R1_001.fastq.gz | lib0001    | run0001 | single_library |           1 | 5d41402abc4b2a76b9719d911017c592 | 7d793037a0760186574b0282f2f435e7 |                    |
| lib0002_S2_L001_R1_001.fastq.gz | lib0002    | run0001 | single_library |           1 | 8b1a9953c4611296a827abf8c47804d7 | 1679091c5a880faf6fb5e6087eb1b2dc |                    |
| lib0003_S1_L002_R1_001.fastq.gz | lib0003    | run0002 | single_library |           2 | e4d909c290d0fb1ca068ffaddf22cbd0 | 4b43b0aee35624cd95b910189b3dc231 | Lane split         |
| lib0003_S1_L003_R1_001.fastq.gz | lib0003    | run0002 | single_library |           3 | d0be2dc421be4fcd0172e5afceea3970 | 6512bd43d9caa6e02c990b0a82652dca |                    |
| lib0004_S3_L001_R1_001.fastq.gz | lib0004    | run0001 | single_library |           1 | c20ad4d76fe97759aa27a0c99bff6710 | c51ce410c124a10e0db5e4b97fc2af39 | EM-seq library     |
| lib0005_S1_L001_R1_001.fastq.gz | lib0005    | run0003 | single_library |           1 | aab3238922bcc25a6f606eb525ffdc56 | 9bf31c7ff062936a96d3c8bd1f8f2ff3 |                    |
| lib0006_S2_L001_R1_001.fastq.gz | lib0006    | run0003 | single_library |           1 | d645920e395fedad7bbbed0eca3fe2e0 |                                  | Single-end library |

#+begin_src python
import re
import pandas as pd
from pathlib import Path

def extract_org_table(org_file, table_name):
    """Extract a named org table and return as DataFrame"""
    with open(org_file, 'r') as f:
        content = f.read()

    # Debug: check if NAME exists
    if f'#+name: {table_name}' not in content:
        print(f"DEBUG: Could not find '#+name: {table_name}' in file")
        # Try to show what NAME tags exist
        names = re.findall(r'#\+name:\s*(\w+)', content)
        print(f"DEBUG: Found these NAME tags: {names}")
        raise ValueError(f"Table {table_name} not found")

    # More flexible pattern - allow for various whitespace
    pattern = rf'#\+name:\s*{table_name}\s*\n\s*#\+begin_src\s+org\s*\n(.*?)\n\s*#\+end_src'
    match = re.search(pattern, content, re.DOTALL)

    if not match:
        print(f"DEBUG: Found NAME tag but couldn't match the full pattern")
        raise ValueError(f"Table {table_name} pattern didn't match")

    table_text = match.group(1)

    # Parse org table
    lines = [line.strip() for line in table_text.split('\n') if line.strip()]
    # Remove separator lines (those with just | and -)
    lines = [line for line in lines if not re.match(r'^\|[\s\-\+]+\|$', line)]

    # Split by | and clean
    data = []
    for line in lines:
        cols = [col.strip() for col in line.split('|')[1:-1]]  # Skip first/last empty
        data.append(cols)

    # First row is header
    df = pd.DataFrame(data[1:], columns=data[0])

    # Replace empty strings with None
    df = df.replace('', None)

    return df

# Extract all tables
org_file = 'biotools.org'
table_names = ['subjects', 'participants', 'mice', 'samples', 'libraries', 'runs', 'fastqs']

# Save as TSVs
for table_name in table_names:
    df = extract_org_table(org_file, table_name)
    df.to_csv(f'{table_name}.tsv', sep='\t', index=False, na_rep='')
    print(f"Extracted {table_name}: {len(df)} rows")

# Build Excel from TSVs
with pd.ExcelWriter('example-metadata.xlsx', engine='openpyxl') as writer:
    for table_name in table_names:
        df = pd.read_csv(f'{table_name}.tsv', sep='\t', keep_default_na=False)
        df.to_excel(writer, sheet_name=table_name, index=False)

print("\nCreated example-metadata.xlsx")
#+end_src

*** Logical data representation, Common Data Model schema
:PROPERTIES:
:ID:       a276df0c-a606-4337-8f0f-7f711e9ceb4c
:header-args:yaml: :tangle ./examples/example-metadata-schema.yaml
:END:
[[file:example-metadata-schema.yaml]]
**** Preamble
#+begin_src yaml
# Documentation
# Good Practices for Bioinformatics Metadata Schema with Frictionless
#
# Components:
#   - Excel as the user interface: non-programmers enter data, schema validates it
#   - Hierarchical data model: organize by biological and technical relationships
#   - Self-documenting: schemas generate data dictionaries programmatically
#
# Schema Structure:
#   - Version control by repo-level versioning
#   - Define shared elements once using YAML anchors
#   - Use three-letter prefixes + 4 digits for all primary keys (sub0001, par0001, mou0001, etc.)
#
# Field Definition Principles:
#   - Every field should include: name, title, description, example, type, constraints
#   - Always include pattern constraints on primary keys to catch typos
#   - Foreign key fields should be minimal: type, pattern, required only
#   - Use enums over booleans for domain-specific concepts
#   - Document enum values with enumDescriptions for data dictionary generation
#   - Standardize units in field names and descriptions

# Shared definitions

resources:
#+end_src
**** Subjects
#+begin_src yaml
# Subjects
# Subjects table serves as the parent linking table for all research organisms
  # It contains only minimal common fields - organism-specific details live in child tables (participants, mice)
  - name: subjects
    path: metadata.xlsx  # Environment variable for flexible path handling across projects
    control:
      type: excel
      sheet: subjects  # Excel sheet name must match resource name
    schema:
      missingValues: &mv ["", "unknown", "UNK", "unk", "n/a", "NA", "GET", "None"]
      fields:
        # PRIMARY KEY FIELD
        # Always define first, includes pattern constraint to catch formatting errors
        - name: subject_id
          title: Subject Identifier
          description: Unique value identifying a specific research subject organism. Format is three letters followed by 4 digits. Values match primary keys from participants or mice tables.
          example: sub0001
          type: string
          format: default
          constraints:
            required: true  # Must be present in every row
            unique: true    # No duplicate values allowed
            pattern: '^[a-z]{3}\d{4}$'  # Three lowercase letters + 4 digits

        # DISCRIMINATOR FIELD
        # Determines which child table contains organism-specific details
        # enumDescriptions enables programmatic data dictionary generation
        - name: organism_type
          title: Organism Type
          description: Subject's organism type, determines which subtype table contains additional details
          example: mouse
          type: string
          constraints:
            required: true
            enum: [human, mouse]  # Restrict to known categories only
          enumDescriptions:  # Custom property for documentation - ignored by validator
            human: Human research participant (details in participants table)
            mouse: Mouse subject (details in mice table)

        # OPTIONAL FIELD
        # No required constraint means field can be blank (matches missingValues)
        - name: notes
          description: Free-text notes about this subject
          type: string
          constraints:
            required: false  # Explicit even though it's default behavior

    primaryKey: subject_id  # Declares subject_id as the primary key for foreign key relationships
#+end_src

**** Participants
#+begin_src yaml
# Participants
# Participants table contains human-specific metadata for research subjects
  # Primary key also serves as foreign key to subjects table
  # Only includes data applicable to human participants (institution, demographics, etc.)
  - name: participants
    title: Human Study Participants
    description: Human research participants enrolled under institutional protocols, with demographic and enrollment metadata
    path: metadata.xlsx
    control:
      type: excel
      sheet: participants
    schema:
      missingValues: *mv # References the shared anchor defined at top level
      fields:
        # PRIMARY KEY - also serves as foreign key to subjects table
        # Three-letter prefix convention: 'par' + 4 digits
        - name: participant_id
          title: Participant Identifier
          description: Unique identifier of a unique study participant. Format is 'par' followed by 4 digits. Links directly to subject_id in subjects table.
          example: par0001
          type: string
          constraints:
            required: true
            unique: true
            pattern: '^par\d{4}$'

        # ADMINISTRATIVE FIELDS
        # Institution and protocol tracking for multi-site studies
        - name: institution_id
          title: Enrolling Institution
          description: Identifier for institution where patient was consented for research
          example: jhh
          type: string
          constraints:
            required: true
            enum: [nci, jhh, washu, mayo]
          enumDescriptions:
            nci: National Cancer Institute
            jhh: Johns Hopkins Hospital
            washu: Washington University
            mayo: Mayo Clinic

        - name: study_protocol_id
          title: Study Protocol
          description: Identifier for institution research protocol which participant was consented and enrolled
          example: 99-CC-0168
          type: string
          constraints:
            required: false

        # DEMOGRAPHIC FIELDS
        - name: sex
          title: Participant Sex
          description: Participant's sex
          example: m
          type: string
          constraints:
            required: true
            enum: [m, f]
          enumDescriptions:
            m: Male
            f: Female

        - name: birth_year
          title: Birth Year
          description: Year of participant's birth in YYYY format
          example: 1981
          type: year
          constraints:
            required: false
            minimum: 1900  # Reasonable lower bound
            maximum: 2025  # Flags future dates or data entry errors

        # OPTIONAL NOTES FIELD
        # Allows free-text metadata that doesn't fit structured fields
        - name: notes
          title: Notes
          description: Free-text notes about this participant
          type: string
          constraints:
            required: false

    primaryKey: participant_id
    foreignKeys:
      - fields: participant_id
        reference:
          resource: subjects
          fields: subject_id
#+end_src
**** Mice
#+begin_src yaml
# Mice
# Mice table contains mouse-specific metadata for research subjects
  # Primary key also serves as foreign key to subjects table
  # Includes strain, genotype, and housing information
  - name: mice
    title: Mouse Research Subjects
    description: Mouse subjects used in research
    path: metadata.xlsx
    control:
      type: excel
      sheet: mice
    schema:
      missingValues: *mv
      fields:
        # PRIMARY KEY - also serves as foreign key to subjects table
        # Three-letter prefix: 'mou' + 4 digits
        - name: mouse_id
          title: Mouse Identifier
          description: Unique identifier for mouse subject. Format is 'mou' followed by 4 digits. Links directly to subject_id in subjects table.
          example: mou0001
          type: string
          constraints:
            required: true
            unique: true
            pattern: '^mou\d{4}$'

        # MOUSE-SPECIFIC FIELDS
        - name: strain
          title: Mouse Strain
          description: Genetic background strain of the mouse
          example: C57BL/6
          type: string
          constraints:
            required: true
            maxLength: 50

        - name: sex
          title: Mouse Sex
          description: Biological sex of the mouse
          example: m
          type: string
          constraints:
            required: true
            enum: [m, f]
          enumDescriptions:
            m: Male
            f: Female

        - name: birth_date
          title: Birth Date
          description: Date of birth in ISO8601 format (YYYY-MM-DD)
          example: 2024-01-15
          type: date
          constraints:
            required: false
            minimum: "2020-01-01"
            maximum: "2026-12-31"

        # OPTIONAL NOTES
        - name: notes
          title: Notes
          description: Free-text notes about this mouse
          type: string
          constraints:
            required: false
            maxLength: 500

    primaryKey: mouse_id
    foreignKeys:
      - fields: mouse_id
        reference:
          resource: subjects
          fields: subject_id
#+end_src

**** Samples
#+begin_src yaml
# Samples
# Samples table links biological specimens to subjects
  # Contains collection metadata and sample characteristics
  # One subject can have multiple samples over time
  - name: samples
    title: Biological Samples
    description: Biological specimens collected from research subjects, including collection metadata and sample characteristics
    path: metadata.xlsx
    control:
      type: excel
      sheet: samples
    schema:
      missingValues: *mv
      fields:
        # PRIMARY KEY
        # Three-letter prefix: 'sam' + 4 digits
        - name: sample_id
          title: Sample Identifier
          description: Unique value identifying any specific sample. Format is 'sam' followed by 4 digits.
          example: sam0001
          type: string
          constraints:
            required: true
            unique: true
            pattern: '^sam\d{4}$'

        # FOREIGN KEY to subjects table
        - name: subject_id
          description: Links to subject in subjects table
          type: string
          constraints:
            required: true

        # COLLECTION METADATA
        - name: collection_date
          title: Sample Collection Date
          description: Date when sample was obtained from organism in ISO8601 format (YYYY-MM-DD)
          example: 2024-01-02
          type: date
          constraints:
            required: true
            minimum: "2020-01-01"  # Project start date
            maximum: "2026-12-31"  # Flags future dates

        # SAMPLE CHARACTERISTICS
        - name: sample_type
          title: Sample Type
          description: Type of sample collected
          example: blood
          type: string
          constraints:
            required: true
            enum: [blood, tumor, cell_line]
          enumDescriptions:
            blood: Sample generated from a blood draw
            tumor: Solid tissue sample from a biopsy or resection
            cell_line: Cultured cell line collection

        # NUMERIC FIELDS demonstrating range constraints
        - name: sample_volume_ml
          title: Sample Volume
          description: Volume of sample collected in milliliters
          example: 5.0
          type: number
          constraints:
            required: false
            minimum: 0
            minimum: 0
            maximum: 1000  # Flag unrealistic values

        # OPTIONAL NOTES
        - name: notes
          title: Notes
          description: Free-text notes about this sample
          type: string
          constraints:
            required: false

    primaryKey: sample_id
    foreignKeys:
      - fields: subject_id
        reference:
          resource: subjects
          fields: subject_id
#+end_src
**** Libraries
#+begin_src yaml
# Libraries
# Libraries table contains sequencing library preparation metadata
  # Links samples to sequencing data through library construction details
  # Includes prep methods, input quantities, and library characteristics
  - name: libraries
    title: Sequencing Libraries
    description: Sequencing libraries prepared from biological samples, including prep methods and input quantities
    path: metadata.xlsx
    control:
      type: excel
      sheet: libraries
    schema:
      missingValues: *mv
      fields:
        # PRIMARY KEY
        # Three-letter prefix: 'lib' + 4 digits
        - name: library_id
          title: Library Identifier
          description: Unique identifier for any specific sequencing library. Format is 'lib' followed by 4 digits.
          example: lib0001
          type: string
          constraints:
            required: true
            unique: true
            pattern: '^lib\d{4}$'

        # FOREIGN KEY to samples table
        - name: sample_id
          description: Links to sample in samples table
          type: string
          constraints:
            required: true
            pattern: '^sam\d{4}$'

        # LIBRARY PREP METHODS
        - name: isolation_method
          title: Nucleic Acid Isolation Method
          description: Method used for isolation of nucleic acid input to sequencing library
          example: truseq
          type: string
          constraints:
            required: true
            enum: [truseq, emseq_v1, emseq_v2]
          enumDescriptions:
            truseq: TruSeq standard library prep
            emseq_v1: EM-seq enzymatic methylation sequencing version 1
            emseq_v2: EM-seq enzymatic methylation sequencing version 2

        - name: adapter_type
          title: Adapter Type
          description: Type or strategy for sequencing adapters of library
          example: illumina
          type: string
          constraints:
            required: true
            enum: [illumina, xgen]
          enumDescriptions:
            illumina: Illumina standard adapters
            xgen: IDT xGen adapters

        - name: library_type
          title: Library Type
          description: Whether library was sequenced as paired-end or single-end
          example: paired_end
          type: string
          constraints:
            required: true
            enum: [paired_end, single_end]
          enumDescriptions:
            paired_end: Paired-end sequencing library
            single_end: Single-end sequencing library

        # INPUT QUANTITIES with numeric validation
        - name: input_ul
          title: Input Volume
          description: Library input volume in microliters
          example: 100
          type: number
          constraints:
            required: false
            minimum: 0
            maximum: 1000

        - name: input_pg_ml
          title: Input Concentration
          description: Library input concentration in picograms per milliliter
          example: 0.34
          type: number
          constraints:
            required: false
            minimum: 0
            maximum: 10000  # Flag unrealistic concentrations

        # OPTIONAL NOTES
        - name: notes
          title: Notes
          description: Free-text notes about this library
          type: string
          constraints:
            required: false
            maxLength: 500

    primaryKey: library_id
    foreignKeys:
      - fields: sample_id
        reference:
          resource: samples
          fields: sample_id
#+end_src
**** Sequencing runs
#+begin_src yaml
# Sequencing runs
# Sequencing runs table tracks individual sequencing runs
  # Multiple libraries can be multiplexed on a single run
  # Links to fastqs table which contains per-library FASTQ files from each run
  - name: runs
    title: Sequencing Runs
    description: Individual sequencing runs performed on sequencing instruments, including run metadata and instrument details
    path: metadata.xlsx
    control:
      type: excel
      sheet: runs
    schema:
      missingValues: *mv
      fields:
        # PRIMARY KEY
        # Three-letter prefix: 'run' + 4 digits
        - name: run_id
          title: Run Identifier
          description: Unique identifier for a specific sequencing run. Format is 'run' followed by 4 digits.
          example: run0001
          type: string
          constraints:
            required: true
            unique: true
            pattern: '^run\d{4}$'

        # ALTERNATIVE IDENTIFIERS
        # External or vendor-provided run IDs
        - name: alt_run_id
          title: Alternative Run ID
          description: External or vendor-provided identifier for this run (e.g., flowcell ID, instrument run ID)
          example: HWTG7DSXY
          type: string
          constraints:
            required: false
            maxLength: 100

        # RUN METADATA
        - name: run_institute
          title: Sequencing Institute
          description: Institution or facility where sequencing was performed
          example: mayo
          type: string
          constraints:
            required: true
            enum: [mayo, washu, broad, nci, external]
          enumDescriptions:
            mayo: Mayo Clinic
            washu: Washington University
            broad: Broad Institute
            nci: National Cancer Institute
            external: External sequencing facility

        - name: sequencer
          title: Sequencing Instrument
          description: Model of sequencing instrument used
          example: novaseq_6000
          type: string
          constraints:
            required: false
            enum: [novaseq_6000, hiseq_4000, nextseq_2000, miseq, other]
          enumDescriptions:
            novaseq_6000: Illumina NovaSeq 6000
            hiseq_4000: Illumina HiSeq 4000
            nextseq_2000: Illumina NextSeq 2000
            miseq: Illumina MiSeq
            other: Other sequencing platform

        - name: run_date
          title: Run Date
          description: Date when sequencing run was initiated in ISO8601 format (YYYY-MM-DD)
          example: 2024-06-15
          type: date
          constraints:
            required: false
            minimum: "2020-01-01"
            maximum: "2026-12-31"

        - name: flowcell_id
          title: Flowcell ID
          description: Identifier for the flowcell used in this run
          example: HWTG7DSXY
          type: string
          constraints:
            required: false
            maxLength: 50

        # OPTIONAL NOTES
        - name: notes
          title: Notes
          description: Free-text notes about this sequencing run
          type: string
          constraints:
            required: false
            maxLength: 500

    primaryKey: run_id
#+end_src

**** FASTQs
#+begin_src yaml
# FASTQs
# FASTQs table represents individual sequencing data files
  # Links libraries to their sequencing runs and resulting data files
  # Uses R1 basename as primary key; R2 can be derived by substitution for paired-end
  - name: fastqs
    title: FASTQ Files
    description: Individual FASTQ sequencing data files with checksums and run linkage
    path: metadata.xlsx
    control:
      type: excel
      sheet: fastqs
    schema:
      missingValues: *mv
      fields:
        # PRIMARY KEY
        # Using R1 basename since R2 can be derived by string substitution
        - name: r1_basename
          title: Read 1 Basename
          description: File basename of the FASTQ read 1 file (without directory path)
          example: sample001_L001_R1_001.fastq.gz
          type: string
          constraints:
            required: true
            unique: true
            maxLength: 255

        # FOREIGN KEYS
        - name: library_id
          description: Links to library in libraries table
          type: string
          constraints:
            required: true
            pattern: '^lib\d{4}$'

        - name: run_id
          description: Links to run in runs table
          type: string
          constraints:
            required: true
            pattern: '^run\d{4}$'

        # FASTQ CHARACTERISTICS
        - name: multiplexing
          title: Multiplexing Status
          description: Whether FASTQ contains reads from multiple libraries (multiplexed) or a single library
          example: single_library
          type: string
          constraints:
            required: true
            enum: [multiplexed, single_library]
          enumDescriptions:
            multiplexed: FASTQ contains reads from multiple indexed libraries
            single_library: FASTQ contains reads from a single library only

        - name: lane_number
          title: Lane Number
          description: Sequencing lane number if library was split across multiple lanes
          example: 1
          type: integer
          constraints:
            required: false
            minimum: 1
            maximum: 8  # NovaSeq 6000 has max 2 or 4 lanes depending on flowcell; HiSeq can have 8

        # DATA INTEGRITY CHECKSUMS
        # MD5 hashes for verifying file integrity
        - name: r1_md5
          title: Read 1 MD5 Checksum
          description: MD5 checksum of R1 FASTQ file for data integrity verification
          example: 5d41402abc4b2a76b9719d911017c592
          type: string
          constraints:
            required: true
            pattern: '^[a-f0-9]{32}$'  # MD5 is exactly 32 hexadecimal characters

        - name: r2_md5
          title: Read 2 MD5 Checksum
          description: MD5 checksum of R2 FASTQ file (paired-end libraries only)
          example: 5d41402abc4b2a76b9719d911017c592
          type: string
          constraints:
            required: false  # Only required for paired-end
            pattern: '^[a-f0-9]{32}$'

        # OPTIONAL NOTES
        - name: notes
          title: Notes
          description: Free-text notes about this FASTQ file
          type: string
          constraints:
            required: false
            maxLength: 500

    primaryKey: r1_basename
    foreignKeys:
      - fields: library_id
        reference:
          resource: libraries
          fields: library_id
      - fields: run_id
        reference:
          resource: runs
          fields: run_id
#+end_src

*** Documentation: Good Practices for Bioinformatics Metadata Schema with Frictionless

**** Overview
- Excel as user interface: non-programmers enter data, schema validates it
- Hierarchical data model: organize by biological and technical relationships
- Self-documenting: schemas generate data dictionaries programmatically
- Version control by repo-level versioning

**** Elements
***** Immutable Reference Files
- Possible PHI
- Provenance tracking

***** Mutable "Sample Sheet"
- Format: xlsx or series of tsvs
- No PHI
- Source of truth for metadata
- Validation input

**** PHI Policy
No PHI (Protected Health Information) should be stored in sample sheets or metadata files managed by this schema.

**** Schema Structure

***** Shared Definitions
Use YAML anchors for repeated definitions:
#+begin_src yaml
missingValues: &mv ["", "unknown", "UNK", "unk", "n/a", "NA", "GET", "None"]
resources:
  - name: samples
    schema:
      missingValues: *mv
#+end_src

***** Basic Resource Structure
#+begin_src yaml
resources:
  - name: subjects
    path: ${PROJECT_METADATA_XLSX}
    control:
      type: excel
      sheet: subjects
    schema:
      missingValues: *mv
      fields:
        - name: subject_id
          # field definitions
      primaryKey: subject_id
      foreignKeys:
        - fields: parent_id
          reference:
            resource: parents
            fields: parent_id
#+end_src

**** Field Definition Principles

***** Required Components
Every field should include:
- name: Machine-readable identifier
- title: Human-readable label
- description: Clear explanation including format requirements and units
- example: Representative value
- type: Data type
- constraints: Validation rules

Example:
#+begin_src yaml
- name: sample_id
  title: Sample Identifier
  description: Unique value identifying any specific sample. Format is 'sam' followed by 4 digits.
  example: sam0001
  type: string
  constraints:
    required: true
    unique: true
    pattern: '^sam\d{4}$'
#+end_src

***** Primary Key Conventions
- Use three-letter prefix + zero-padded four-digit numbers
- Enables lexicographic sorting
- Format: ~^[a-z]{3}\d{4}$~
- Examples: ~par0001~, ~sam0001~, ~lib0001~, ~run0001~
- Always include pattern constraint to catch typos

***** Foreign Key Conventions
Foreign key fields should be minimal:
#+begin_src yaml
- name: subject_id
  description: Links to subject in subjects table
  type: string
  constraints:
    required: true
    pattern: '^[a-z]{3}\d{4}$'
#+end_src

- Include pattern constraint to validate format before checking referential integrity
- Detailed metadata lives in parent table only - avoid redundancy

***** Field Ordering
1. Primary key first
2. Foreign keys second
3. Required fields
4. Optional fields
5. Group related fields together

**** Data Type Decisions

***** Prefer Enums Over Booleans
Use enums for domain-specific concepts that require explanation:
#+begin_src yaml
- name: multiplexing
  title: Multiplexing Status
  description: Whether FASTQ contains reads from multiple libraries or a single library
  type: string
  constraints:
    required: true
    enum: [multiplexed, single_library]
  enumDescriptions:
    multiplexed: FASTQ contains reads from multiple indexed libraries
    single_library: FASTQ contains reads from a single library only
#+end_src

Booleans acceptable only when semantics are universally obvious.

***** Document Enum Values
Use custom ~enumDescriptions~ property for programmatic data dictionary generation:
#+begin_src yaml
- name: sample_type
  constraints:
    enum: [blood, tumor, cell_line]
  enumDescriptions:
    blood: Whole blood or blood component sample
    tumor: Solid tumor tissue biopsy
    cell_line: Cultured cell line sample
#+end_src

***** Standardize Units in Field Names
Include units in field name and description:
#+begin_src yaml
- name: concentration_pg_ml
  title: Input Concentration
  description: Library input concentration in picograms per milliliter
  type: number
  example: 0.34
#+end_src

**** Table Design Principles

***** Hierarchical Relationships
Organize tables by biological and technical hierarchy:
#+begin_example
subjects → samples → libraries → fastqs
#+end_example

Use foreign keys to enforce referential integrity.

***** When to Split Tables
Split into separate tables when entities have:
- Many divergent fields (>5 unique per subtype)
- Fundamentally different semantics
- Example: human participants vs mouse subjects

***** When to Keep Together
Keep entities in one table when:
- Few optional fields (2-3)
- Structural similarity between subtypes
- Add discriminator field for subtype and leave subtype-specific fields optional

**** Schema Evolution

***** Constraint Defaults
Frictionless defaults:
- ~required: false~ (field is optional)
- ~unique: false~ (duplicates allowed)
- No enum restrictions

Only declare constraints when restricting behavior.

***** Adding Enum Values
Never use "other" catch-all categories or allow arbitrary values - this defeats validation.
When new category needed, update schema and increment version.

** Open and controlled access data sources
- For cfDNA
  - https://generegulation.org/cfDNA/
- [cite:@peneder2021] has healthy cfDNA WGS data
** Bioinformatics style guide
:PROPERTIES:
:ID:       8ddb3ced-a572-43cd-82d9-69fe449fe320
:END:
- See [[id:593672e1-82b2-44e0-aa00-d28825860706][Computer programming style Guide]]
  - Prefer Ensembl identifiers as a final reference
** Biotools conda yaml
:PROPERTIES:
:ID:       cf13d347-1d0e-4858-a016-0a8a8af22609
:header-args:yaml: :tangle ./config/biotools-conda-env.yaml
:END:
- [[file:biotools_env.yaml]]
#+begin_src yaml
name: biotools
channels:
  - conda-forge
  - bioconda

dependencies:
  - bamtools
  - bedops
  - bedtools
  - bowtie2
  - deeptools
  - fastp
  - fastqc
  - mosdepth
  - multiqc
  - picard
  - pybedtools
  - pysam
  - sambamba
  - samtools
  - sra-tools
  - gffread
  - ucsc-gtftogenepred
  - ucsc-genepredtobed
#+end_src

- this was too big- removed: bioconductor-orthology.eg.db, also associated genomeinfodbdata was breaking srever installs

#+begin_src bash
source ${HOME}/miniconda3/bin/activate base

mamba env update --name biotools --file ~/repos/basecamp/basecamp_env.yaml
mamba env update --name biotools --file ~/repos/biotools/resources/conda/biotools_env.yaml

#conda list --name biotools > ~/repos/biotools/resources/full_conda_env.txt
#conda list --name cardiac -e > ~/repos/biotools/resources/machine_read_full_conda_env.txt

#conda activate biotools

#prefetch
#+end_src
** Graph theory methods in bioinformatics
#+begin_src R
# Load igraph
library(igraph)

# Define the graph (using the graph from the previous example)
nodes <- data.frame(
  name = c("Cancer", "Diabetes", "BRCA1", "TP53", "Metformin", "Aspirin"),
  type = c("Disease", "Disease", "Gene", "Gene", "Drug", "Drug")
)
edges <- data.frame(
  from = c("Cancer", "Diabetes", "BRCA1", "TP53", "Metformin", "Aspirin"),
  to = c("BRCA1", "TP53", "Cancer", "Diabetes", "Diabetes", "Cancer"),
  relationship = c("associated_with", "associated_with", "associated_with", "associated_with", "treats", "treats")
)
g <- graph_from_data_frame(d=edges, vertices=nodes, directed=FALSE)

# 1. Centrality Scores
# Calculate degree centrality as a basic importance measure
degree_centrality <- degree(g, mode="all")

# Filter for genes
genes <- V(g)[V(g)$type == "Gene"]
gene_degrees <- degree_centrality[genes]

# 2. Random Walk from Disease
# Perform random walk to get probabilities of reaching each gene from a disease
random_walk_probs <- page_rank(g)$vector

# Filter probabilities for genes only
gene_probs <- random_walk_probs[genes]

# 3. Shortest Path Proximity to Disease
# Calculate shortest paths from each disease to genes
distances <- distances(g, v = V(g)[V(g)$type == "Disease"], to = genes)

# Rank genes based on the centrality, random walk, and distance scores
ranked_genes <- data.frame(
  Gene = names(gene_degrees),
  Degree_Centrality = gene_degrees,
  Random_Walk_Probability = gene_probs,
  Avg_Shortest_Distance = rowMeans(distances, na.rm = TRUE)
)

# Sort genes by random walk probability or degree centrality for ranking
ranked_genes <- ranked_genes[order(-ranked_genes$Random_Walk_Probability, -ranked_genes$Degree_Centrality), ]

# Display ranked genes
print(ranked_genes)

#+end_src
** References, databases, standards, file types, and data sets
:PROPERTIES:
:ID:       FCBA0863-010A-448C-A33C-941D2AA45AD5
:END:
- https://gatk.broadinstitute.org/hc/en-us/articles/360035890811-Resource-bundle
- https://www.biostars.org/p/181014/
- https://www.genomicinformationcommons.org/
- https://ftp.ncbi.nlm.nih.gov/genomes/archive/old_genbank/Eukaryotes/vertebrates_mammals/Mus_musculus/GRCm38.p3/seqs_for_alignment_pipelines/
- https://www.ncbi.nlm.nih.gov/grc/help/faq/#format-reference-data-for-read-alignment
- https://gatk.broadinstitute.org/hc/en-us/articles/360035890951-Human-genome-reference-builds-GRCh38-or-hg38-b37-hg19
- https://www.illumina.com/science/genomics-research/articles/dragen-demystifying-reference-genomes.html
- methylation https://www.nature.com/articles/s41586-022-05580-6
- Cytobands- # https://www.biostars.org/p/383786/
- GENIE
  - https://www.synapse.org/#!Synapse:syn7222066/wiki/410922
  - https://aacrjournals.org/cancerdiscovery/article/12/9/2044/708766/AACR-Project-GENIE-100-000-Cases-and-BeyondGENIE
- https://www.biostars.org/p/383786/
- https://biodbnet-abcc.ncifcrf.gov/
- https://snpedia.com/index.php/SNPedia
- https://academic.oup.com/nar/article/43/D1/D1117/2439489
- Uniprot
  - https://www.uniprot.org/help/query-fields
*** MSigDB
:PROPERTIES:
:ID:       c79bfe84-0f15-474e-8a22-1f210605ed5a
:END:
- [[id:edf39ef6-df91-40c2-a71a-c612d60b5582][msigdbr]]
- [[https://www.gsea-msigdb.org/gsea/msigdb/collections.jsp][MSigDB]] [[https://data.broadinstitute.org/gsea-msigdb/msigdb/][data]]
- http://software.broadinstitute.org/gsea/msigdb/collections.jsp
*** Chromosome sizes
:PROPERTIES:
:ID:       8a50f360-6043-4e19-9620-61f3b957b28a
:END:
  - http://hgdownload.cse.ucsc.edu/goldenpath/mm10/bigZips/mm10.chrom.sizes
*** Genome reference builds and associated sequences
:PROPERTIES:
:ID:       e9e201b5-4a94-4861-8de8-803676c3a37f
:END:
https://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/
- UCSC is chr, ensembl is NOT
- https://gatk.broadinstitute.org/hc/en-us/articles/360035890951-Human-genome-reference-builds-GRCh38-or-hg38-b37-hg19
- https://www.ncbi.nlm.nih.gov/tools/vecscreen/univec/
*** By substrate
:PROPERTIES:
:ID:       ffe7a0f8-5e6d-45ff-adec-efbba7c44783
:END:
**** RNA
:PROPERTIES:
:ID:       59c43aa9-cfa1-4e03-b5fb-25c74f626352
:END:
cite:consortium2020
*** Adapter sequences
:PROPERTIES:
:ID:       cf2ea58e-8751-4d90-ab08-a63445925c89
:END:
- http://www.science.smith.edu/cmbs/wp-content/uploads/sites/36/2020/01/illumina-adapter-sequences-1000000002694-11.pdf
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5759201/
- https://support.illumina.com/downloads/illumina-adapter-sequences-document-1000000002694.html
- https://support.illumina.com/bulletins/2016/12/what-sequences-do-i-use-for-adapter-trimming.html
*** [[id:c0c0ee28-2e41-41a7-9a3b-ae195117a93e][LINK TO common bioinformatics file manipulation]]
:PROPERTIES:
:ID:       fc44f2e8-c32f-4169-ba9c-5032a35327a6
:END:
*** [[id:767e5e30-8490-4cda-8018-8b0bd91c4ef3][LINK TO Code associated with sequence reference builds]]
:PROPERTIES:
:ID:       a7a6c48c-f2a5-478e-858d-c99ebd9be027
:END:
*** By organism
:PROPERTIES:
:CREATED:  [2020-10-26 Mon 12:18]
:ID:       33638cdf-113c-4248-aff4-b0d8ea7cbc09
:END:
**** Rat
:PROPERTIES:
:ID:       f4ff99c8-9149-4183-89ff-56a09e68943b
:END:
- Genome assemblies
  - https://www.ncbi.nlm.nih.gov/assembly/organism/10116/latest/
- https://useast.ensembl.org/Rattus_norvegicus/Info/Index
- most recent assembly is Rnor_6.0
  - https://rgd.mcw.edu/rgdweb/report/genomeInformation/genomeInformation.html?species=Rat&mapKey=360&details=true
- https://rgd.mcw.edu/
**** human
:PROPERTIES:
:ID:       8a910eca-5f96-4a74-ad3e-efc6eb748b7c
:END:
- http://browser.1000genomes.org/index.html
**** mouse
:PROPERTIES:
:ID:       23fc30cd-7e45-4333-8740-1d8ec0755dab
:END:
- https://github.com/czbiohub/tabula-muris
- [[http://www.informatics.jax.org/vocab/gene_ontology][jax mouse gene ontology browser]]
- cite:lai2016
- https://www.biorxiv.org/content/10.1101/082511v1#disqus_thread
*** by data type
:PROPERTIES:
:ID:       5f2913ae-1f4a-44d5-90e2-9ee045c37b78
:END:
- extracellular RNA
  - https://exrna.org/resources/data/
- protein - http://www.proteinatlas.org/about
- integrated
  - https://www.nature.com/articles/s41586-019-1629-x
- [[id:333ebad6-9ed4-4d5b-a50e-f9fe9a8c3a92][gene expression]]
- [[id:629e512e-60ac-4283-bc0e-028b8cad3dcc][sequence variation]]
- miRNA
  - http://www.mirbase.org/cgi-bin/sentences.pl?acc=MI0001445
*** reference data
:PROPERTIES:
:ID:       4dc2f252-12fe-409e-bef0-aab2d765de7a
:END:
- homology
  - http://bioinf.wehi.edu.au/MSigDB/
  - cite:lai2016
    - https://bioconductor.org/packages/release/data/experiment/vignettes/gskb/inst/doc/gskb.pdf
    - http://ge-lab.org/gskb/
  - http://www.informatics.jax.org/homology.shtml
- gene sets and pathways
  - cite:liberzon2015
  - cite:lai2016
  - KEGG- note mostly orthology mapping for non-human organisms
  - http://pathguide.org/
  - cite:chowdhury2015
  - https://www.bioconductor.org/packages/devel/data/experiment/vignettes/gskb/inst/doc/gskb.pdf
  - - https://www.bioconductor.org/packages/release/bioc/vignettes/ReactomePA/inst/doc/ReactomePA.html
  - MSigDB
  - https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4707969/
  - [[https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/MSigDB_v7.0_Release_Notes#Changes_to_MSigDB_Gene_Symbol_Mapping_Procedures][orthology mapping]]
- https://github.com/genome/gms/wiki/HCC1395-WGS-Exome-RNA-Seq-Data
- [[https://github.com/genome-in-a-bottle][Genome-in-a-bottle]]
  - https://github.com/genome-in-a-bottle
- http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/genes/
- http://www.mirbase.org/
- annotaiton
  - http://daid.abcc.ncifcrf.gov/
- alignment
  - terminology
    - abinitio is predicted genes
  - organizations
    - Ensembl
  - [[https://support.illumina.com/sequencing/sequencing_software/igenome.html][illumina iGenomes refrence sequence and annotation]]
  - [[https://software.broadinstitute.org/gatk/documentation/article?id=11010][gatk:  Human genome reference builds - GRCh38/hg38 - b37 - hg19]]
  - https://www.ncbi.nlm.nih.gov/grc/help/faq/
  - https://www.ncbi.nlm.nih.gov/grc/help/definitions/
  - https://www.ccdatalab.org/blog/2019/3/29/gene-expression-repos-explained
  - https://useast.ensembl.org/info/data/ftp/index.html
  - Genome Reference Consortium
    - https://www.slideshare.net/ShaojunXie/hg19-grch37-vs-hg38-grch38
  - Ensembl
    - [[https://useast.ensembl.org/info/data/ftp/index.html][Ensembl reference FTP]]
    - https://useast.ensembl.org/info/genome/variation/
*** individual subject / sample level data
:PROPERTIES:
:ID:       55d196dd-c99f-4ce8-b8e6-290b778e15b3
:END:
- [[https://www.ebi.ac.uk/ena][European Nucleotide Archive]]
- https://www.ncbi.nlm.nih.gov/geo/
- [[http://www.ebi.ac.uk/gwas/][The NHGRI-EBI Catalog of published genome-wide association studies]]
- https://www.ebi.ac.uk/gxa/experiments/E-MTAB-513/Results
- SRA (sequence read archive)
  - https://edwards.sdsu.edu/research/fastq-dump/
- dbGaP
  - https://www.ncbi.nlm.nih.gov/books/NBK99225/#DArequest.could_you_give_a_demo_about_th
- [[https://www.ccdatalab.org/blog/2019/3/29/gene-expression-repos-explained][gene expression repos explained]]
- [[https://www.encodeproject.org/][ENCODE]]
  - http://www.reddit.com/r/askscience/comments/znlk6/askscience_special_ama_we_are_the_encyclopedia_of/

- cite:beck2015
- [[https://www.reddit.com/r/bioinformatics/comments/601fzr/where_can_i_access_free_sequencing_data/][Where can I access free sequencing data]]
- [[https://www.aacr.org/professionals/research/aacr-project-genie/][GENIE]]
**** GDC: Genomic Data Commons
:PROPERTIES:
:ID:       99eace6a-6b4e-4acf-9381-1b48a59a4b61
:END:
- https://gdc.cancer.gov/about-data/data-types-and-file-formats
- https://github.com/NCI-GDC/gdc-workflow-overview
- https://gdc.cancer.gov/about-data/data-standards
- https://docs.gdc.cancer.gov/Data/Data_Model/GDC_Data_Model/
- https://gdc.cancer.gov/about-data/data-dictionary
- [[https://gdc.cancer.gov/][NCI Genomic Data Commons]]
  - [[https://docs.gdc.cancer.gov/][GDC documentation]]
  - [[https://gdc.cancer.gov/about-data/data-harmonization-and-generation/genomic-data-harmonization/genomic-data-alignment/rna-seq-pipeline][GDC RNA-seq pipeline]]
  - [[https://cbiit.nci.nih.gov/ncip/nci-cancer-genomics-cloud-pilots/nci-cloud-initiative][GDC cloud pilots]]
  - - https://gdc.cancer.gov/developers
  - https://docs.gdc.cancer.gov/
  - - https://gdc.cancer.gov/about-data/data-harmonization-and-generation/genomic-data-harmonization/genomic-data-alignment/rna-seq-pipeline
  - https://cbiit.nci.nih.gov/ncip/nci-cancer-genomics-cloud-pilots/nci-cloud-initiative
- http://www.cbioportal.org/tutorials
*** sequence variation
:PROPERTIES:
:ID:       629e512e-60ac-4283-bc0e-028b8cad3dcc
:END:
- [[http://firebrowse.org/?cohort=ACC&download_dialog=true][firehose]]
- http://browser.1000genomes.org/index.html
- Variance
  - gnomAD
    - - https://mail.google.com/mail/u/0/#inbox/FMfcgxwBWKXrqjHPFNdbSqJRRRdhzdGf
    - https://macarthurlab.org/2017/02/27/the-genome-aggregation-database-gnomad/
    - (Subsumes ExAC)
  - ClinVar
    - [[https://www.ncbi.nlm.nih.gov/projects/clinvar/ClinVarDataDictionary.pdf][ClinVar Data Dictionary]]
  - phenotype association
    - https://genematcher.org/?tab=submissionsTab
    - [[https://www.ncbi.nlm.nih.gov/gap][dbGaP: database of Genotypes and Phenotypes]]
  - cBioPortal
    - http://www.cbioportal.org/tutorials
    - http://www.cbioportal.org/rmatlab
  - [[https://www.ncbi.nlm.nih.gov/projects/SNP/index.html][dbSNP]]
  - [[http://exac.broadinstitute.org/][ExAC Exome Aggregation Consortium]]
- polymorphism
  - [[http://www.internationalgenome.org/data#download][IGSR at 1000 Genomes]]
- [[https://civic.genome.wustl.edu/#/home][CIViC]]
  - cite:griffith2017civic
*** gene expression
:PROPERTIES:
:ID:       333ebad6-9ed4-4d5b-a50e-f9fe9a8c3a92
:END:
https://www.nature.com/articles/s41598-020-72664-6
- https://github.com/czbiohub/tabula-muris
- [[http://firebrowse.org/?cohort=ACC&download_dialog=true][firehose]]
- [[https://gtexportal.org/home/datasets][GTEx]]
  - [[https://biospecimens.cancer.gov/resources/sops/][GTEx SOPs]]
  - GTEx currently uses the
    - GRCh37/Hg19 genome
    - GENCODE v19 annotation
      - The GENCODE annotation should be patched to use Ensembl chromosome names: zcat gencode.v19.annotation.gtf.gz | sed 's/chrM/chrMT/;s/chr//' > gencode.v19.annotation.patched_contigs.gtf
  - sample ID
    - such as GTEX-14753-1626-SM-5NQ9L?
    - GTEX-YYYYY GTEx donor ID
    - 2nd number mostly refers to the tissue site, BUT we do not recommend using it for tissue site designation.
    - 3rd number is the RNA or DNA aliquot ID used for sequencing.
  - Unstranded
  - GTEx
    - [[https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs000424.v7.p2][at dbGAP]]
*** public data, data mapping
:PROPERTIES:
:CREATED:  [2020-07-02 Thu 13:18]
:ID:       7b386a21-a6b8-49d1-ad4b-f5976bf30666
:END:
:LOGBOOK:
CLOCK: [2020-07-02 Thu 13:19]--[2020-07-02 Thu 13:29] =>  0:10
:END:
- https://www.r-bloggers.com/converting-mouse-to-human-gene-names-with-biomart-package/
- geo submission
  - https://www.ncbi.nlm.nih.gov/geo/info/seq.html
  - [[http://yeolab.github.io/onboarding/geo.html][see for useful ftp commands]]
  - [[https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE138253][example from Rentschler lab]]
*** Sequence Databases and Data Sets
:PROPERTIES:
:ID:       C137CB28-0517-4A98-8FB4-6D312DDBC325
:END:
- https://tabula-muris.ds.czbiohub.org/
- [[http://www.mitomap.org/MITOMAP][MITOMAP human mitochondrial genome]]
- https://portal.gdc.cancer.gov/
- [[https://www.ebi.ac.uk/ega/datasets/EGAD00001000078][EBI Data Browser]]
- [[http://www.internationalgenome.org/sites/1000genomes.org/files/documents/1000genomes_browser_quickstart.pdf][100s genomes browser]]
- [[https://genome.ucsc.edu/training/vids/index.html#vid08][ucsc training videos]]
- [[http://useast.ensembl.org/info/website/tutorials/sequence.html][ensembl sequence tutorials]]
- General Feature Format (GFF) / GTF Annotation Files
  - [[http://genome.ucsc.edu/cgi-bin/hgTables?hgsid=494995959_n1VrbO9xpH51JE8qLga6fCvOyV2R&clade=mammal&org=Mouse&db=mm9&hgta_group=genes&hgta_track=refGene&hgta_table=0&hgta_regionType=genome&position=chr12%3A57795963-57815592&hgta_outputType=primaryTable&hgta_outFileName=][make your own]]
  - a tab-separated value file
  - see for standard: http://mblab.wustl.edu/GTF22.html

**** Stored on neuro server at G:/reference
:PROPERTIES:
:ID:       F08101C9-F675-4A35-B9A8-D0159FD74AFF
:END:

- mouse
  - gencode fa.gz
- human
  - hg38.fa and

**** Genomes
:PROPERTIES:
:ID:       277AAE94-CFE5-400E-B5B9-291677A513D0
:END:
- https://gatk.broadinstitute.org/hc/en-us/articles/360035890951-Human-genome-reference-builds-GRCh38-or-hg38-b37-hg19#:~:text=The%20latest%20build%20of%20the,the%20repertoire%20of%20ALT%20contigs.
- [[https://www.biostars.org/p/4405/][reasons to avoid soft-masked genomes for alignment]]
- [[http://hgdownload.cse.ucsc.edu/downloads.html][UCSC goldenPath bigZips]]
- [[http://hgdownload.cse.ucsc.edu/goldenPath/mm10/bigZips/][Mouse mm10]]
- [[http://hgdownload.cse.ucsc.edu/goldenPath/mm9/bigZips/][Mouse mm9]]]]
***** Custom Genomes
:PROPERTIES:
:ID:       F5506BF8-8A6E-4949-9F5E-15B21511E87E
:END:

- No hits for "custom" in cite:star_2.5_dobin or cite:dobin2015mapping



https://www.biostars.org/p/111012/
http://mblab.wustl.edu/GTF2.html
http://useast.ensembl.org/info/website/upload/gff.html#fields
https://www.biostars.org/p/182230/
https://wiki.galaxyproject.org/Learn/CustomGenomes
http://wiki.bits.vib.be/index.php/Create_a_valid_gtf_file_for_tophat
https://support.bioconductor.org/p/66379/

****** Generating a Custom Genome
:PROPERTIES:
:ID:       11F1FF38-7F23-4B81-AEA3-AA760DC62C9F
:END:

******* Trial w/ EWSR1-FLLI1
:PROPERTIES:
:ID:       D293BED1-C843-476E-891B-E8FEFB4917F3
:END:

- Looking for help
  - no info
    - cite:beadling16_multip_amplic_approac_detec_gene
  - bad ideas
    - don't align to transcriptome- this doesn't save any time
    - don't try to make a gtf from a fa- the info isn't there
- Sequence sources
  - Genome- Downloaded GRCh37.85rm fasta from [[http://ftp.ensembl.org/pub/grch37/release-85/fasta/homo_sapiens/dna/][here]]
  - Fusions
    - from ensembl
      - [[http://useast.ensembl.org/Homo_sapiens/Transcript/Exons?db=core;g=ENSG00000182944;r=22:29268009-29300522;t=ENST00000332050][EWSR1 Exon 7]]
        - coord- 29,286,923	29,287,134	2	1	212
        - seq- CTATTCCTCTACACAGCCGACTAGTTATGATCAGAGCAGTTACTCTCAGCAGAACACCTATGGGCAACCGAGCAGCTATGGACAGCAGAGTAGCTATGGTCAACAAAGCAGCTATGGGCAGCAGCCTCCCACTAGTTACCCACCCCAAACTGGATCCTACAGCCAAGCTCCAAGTCAATATAGCCAACAGAGCAGCAGCTACGGGCAGCAGA
      - FLI1 exon - _complicated by multiple splice variants_
    - failed
      - not from UCSC (yet), it will output the whole gene sequence
      - ?from bed files?
      - EWSR1-FLI1 fusion sequence- COSMIC-Gene-Analysis-Fusions-by prevalance : http://cancer.sanger.ac.uk/cosmic/fusion/summary?id=166
- Thought about splitting this to make a little genome to play with, but splits just get me way too many files, a lot with NNNNN only
  - [[Split text file by percentage  the file from 533,942,310 lines to 10,000 lines- 53394 files
- Adding sequences to a fasta][Added fusion sequence programmatically

***** Human genome builds
:PROPERTIES:
:ID:       D0BD8791-0AE3-472E-A346-C0DD0D79AFD9
:END:

- [[http://hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/][Human hg38]]
- [[http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/][Human hg19]]
- [[http://useast.ensembl.org/info/website/tutorials/grch37.html][for converting GRCh37 to GRCh38]]
- https://www.biostars.org/p/113100/
  - The actual sequences you'll get from NCBI/UCSC/Ensembl will be identical, but their annotations will be different and (importantly) updated at different frequencies. NCBI's annotation is the "refseq" dataset (the "refGene" track in UCSC), which is essentially a subset of the UCSC and Ensembl annotations. UCSC's annotations are kind of a mess.
****** hg19
:PROPERTIES:
:ID:       5a7cdb22-c982-4daa-b0ef-799f7347a683
:END:
:LOGBOOK:
CLOCK: [2020-10-05 Mon 13:24]--[2020-10-05 Mon 13:31] =>  0:07
:END:
- hg19 copy-number accessible whitelist
  - subset to autosomes
  - subset against duke
****** Ensembl GRCh37 fastas
:PROPERTIES:
:ID:       B6066026-81E3-49F3-9A0E-C5E610CB86AB
:END:

[[ftp://ftp.ensembl.org/pub/grch37/current/fasta/homo_sapiens/dna/README][Readme]]

hard masked- low complexity regions by RepeatMasker replaced with N's
soft masked- nucleotide replaced w/ lower case
https://www.biostars.org/p/122305/
[[https://groups.google.com/forum/#!topic/rna-star/2wdHXaPv_vU][Dobin suggests hard masking?]]

***** by Institute
:PROPERTIES:
:ID:       48D2EFA9-39A0-4D5F-8AFA-4726E9488D60
:END:

    - genome reference consortium
      - [[http://www.slideshare.net/GenomeRef][genome reference consortium presentations]]
      - [[http://www.ncbi.nlm.nih.gov/projects/genome/assembly/grc/human/][human genome overview]]

        GRC distributes the reference genome in two versions: one as contigs and the other as assembled chromosomes. The latter is in the "assembled_chromosome" directory. I do not know who are using the contigs, but nearly everyone I know use assembled chromosomes only.

        GRCh37/hg19 and GRCh38 are genome builds rather than annotations, which describe where features are in a given genome build. The actual sequences you'll get from NCBI/UCSC/Ensembl will be identical, but their annotations will be different and (importantly) updated at different frequencies. NCBI's annotation is the "refseq" dataset (the "refGene" track in UCSC), which is essentially a subset of the UCSC and Ensembl annotations. UCSC's annotations are kind of a mess. You'll find genes with the same ID on multiple strand and multiple chromosomes, which makes them a bit useless. Ensembl's annotations typically contain more features than UCSC (so a bit more noise), but they're otherwise much better put together (e.g., you'll never find a gene ID on different strand or different chromosomes) and their IDs are typically easier to map to other things (e.g., gene names, GO and pathway memberships). Ensembl also updates its annotation fairly often and versions everything nicely, so it's quite convenient to report what version you used in a paper (reproducibility is always a good thing). Given the choice, use the Ensembl annotation.

        BTW, don't forget that the various sources can use different names for chromosomes (e.g., chr1 in UCSC is just 1 in Ensembl), so don't mix and match them.

***** 37=hg19 sort of
:PROPERTIES:
:ID:       604441C8-6BCE-426F-9DE9-5D960F75C3D3
:END:

https://www.biostars.org/p/123767/
I believe the genomic content for the two is identical, except for the mitochondrial contig.

The contig names are also different. GRCh37 names them `chr1`, `chr2`,,`chr3`, etc, while hg19 just has `1`, `2`, `3`.

Thus you can use the same GTF file for both (excluding mitochondrial, of course) if you do a simple replace operation for the contig names.

https://wiki.dnanexus.com/Scientific-Notes/human-genome

***** [[http://www.ncbi.nlm.nih.gov/projects/genome/assembly/grc/mouse/][GRC GR/scratch/jeszyman/f/scratch/jeszyman/fishseq/set1/S14-43147_2_sequence.fastq ishseq/set1/S14-43147_2_sequence.fastq Cm38]]
:PROPERTIES:
:ID:       A57F0012-6870-4F79-92A3-C580DB1D33AD
:END:

***** [[http://useast.ensembl.org/info/data/ftp/index.html?redirect=no][Ensembl]]
:PROPERTIES:
:ID:       D18360E5-0B07-4AB6-92F6-D4B717A2E159
:END:

******
:PROPERTIES:
:ID:       B94A8093-3229-41A6-92A6-104D03128BAE
:END:

*******
:PROPERTIES:
:ID:       D47888B2-1210-4C9D-B30C-81672143987A
:END:

*******
:PROPERTIES:
:ID:       68A22065-D788-4653-9BBC-2B5F67AD218A
:END:

*******
:PROPERTIES:
:ID:       687708C8-78BF-4EB9-8C48-F5456E9CF63D
:END:

*******
:PROPERTIES:
:ID:       B0449C36-57B8-4A2A-AE44-67C96C51706D
:END:

*** Clinical Fusion Protein Databases
:PROPERTIES:
:ID:       51EC0C78-7164-43CA-97B1-1FF2205B46A7
:END:

chimer-
cite:Kim01012010

cite:wang2015fusioncancer

cite:korla2015fare

see Wellcome Trust db and Chimerdb 2.0- cite:scolnick2015efficient

*** Other Databases and Data Sets
:PROPERTIES:
:ID:       396F7A49-ACB4-4F81-8C73-ACC907207BB8
:END:
- https://www.oncokb.org/api-access
- DGIdb
  - - https://pubmed.ncbi.nlm.nih.gov/33237278/
- mouse
  - [[http://www.informatics.jax.org/][Jackson Lab mouse genome informatics]]
  - [[http://web.stanford.edu/group/barres_lab/brain_rnaseq.html][mouse cerebral cortex RNA Seq database]]
  - mouse Ensembl genome files
- any
  - for datasets
  - GEO and SRA
  - [[http://www.ebi.ac.uk/arrayexpress/about.html][ArrayExpress]]
*** Bioinformatics File Formats
:PROPERTIES:
:ID:       5e2c4e39-99bc-4cc8-86a6-c39bea5ac2d8
:END:
- https://genome.ucsc.edu/FAQ/FAQformat.html#format4
- [[https://genome.ucsc.edu/FAQ/FAQformat.html#format1][Nucleic acid data formats]]
- https://help.basespace.illumina.com/articles/descriptive/fastq-files/
- alignment formats
  - [[https://software.broadinstitute.org/gatk/documentation/article?id=11014][GATK explaination of alignment formats]]
  - https://samtools.github.io/hts-specs/CRAMv3.pdf
- https://support.illumina.com/content/dam/illumina-support/help/BaseSpaceHelp_v2/Content/Vault/Informatics/Sequencing_Analysis/BS/swSEQ_mBS_FASTQFiles.htm
- bcl file format?
- mutation annotation format
  - maf format viewer https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/maftools.html
- gff / gtf
  - [[http://www.gencodegenes.org/gencodeformat.html][Gencode gtf fields]]
  - [[https://www.ensembl.org/info/genome/genebuild/genome_annotation.html#Names][Ensembl annotation]]
    - note that chr.gtf and gtf are same https://www.biostars.org/p/217700/
  - [[https://useast.ensembl.org/info/website/upload/gff.html][Ensembl GFF/GTF format]]
- [[https://genome.ucsc.edu/goldenpath/help/bigWig.html][bigWig format]]
- Variant call format (VCF)
  - http://samtools.github.io/hts-specs/VCFv4.3.pdf
  - http://www.internationalgenome.org/wiki/Analysis/Variant%20Call%20Format/VCF%20(Variant%20Call%20Format)%20version%204.0/encoding-structural-variants
  - [[http://samtools.github.io/hts-specs/VCFv4.3.pdf][Current documentation]]
  - [[http://www.internationalgenome.org/wiki/Analysis/Variant%20Call%20Format/vcf-variant-call-format-version-40/][VCF page at IGSR]]
- [[https://www.biostars.org/p/84686/][Obi on 1 vs 0 based coordinates]]
- cite:li2009
**** Sequence file formats
:PROPERTIES:
:ID:       4a86acd3-db60-4a63-979e-43e34070e7c7
:END:

- fasta
  - ("genomic" fasta .fna == .fa)
***** fastq
:PROPERTIES:
:ID:       59bc8f81-cf57-4e56-a5ff-3b0ff4095a91
:END:
- https://en.wikipedia.org/wiki/FASTQ_format
- [[https://www.biostars.org/p/198143/][get sequencer type from fastq header]]
- https://github.com/10XGenomics/supernova/blob/master/tenkit/lib/python/tenkit/illumina_instrument.py#L12-L45
- https://support.illumina.com/help/BaseSpace_OLH_009008/Content/Source/Informatics/BS/FileFormat_FASTQ-files_swBS.htm

**** .bed
:PROPERTIES:
:ID:       6DB65B82-D88C-43EA-9D2B-169D9184C9D5
:END:
**** SAM
:PROPERTIES:
:ID:       844ed5fc-6c3f-45d5-817a-01fb06a60095
:END:
https://www.biostars.org/p/356811/
**** CIGAR- a subformat in SAM w/ three operations
:PROPERTIES:
:ID:       A664A1C3-9130-400D-BE32-D7D58CF80537
:END:

Original CIGAR
match/mismatch
insertion
deletion
Extended CIGAR
N for skipped bases on the reference- how is this different than an insertion?
S for soft clipping
H for hard clipping
P for padding


read in IGV
parameters
reads up to 128 Mbp
tab delimited
per-alignment fields
mandatory

**** Sequence alignment/Map format specification (.sam/.bam)
:PROPERTIES:
:ID:       44889954-63D8-4416-9F28-0691ECF99A9B
:END:
- [[https://genome.sph.umich.edu/wiki/SAM][nice visualization of fields]]
- cite:samspec2017
  - 1
    - 1.3 The header section
      - read groups
        -
- See [[Samtools]]
- sam- fastq with alignment column
  - BAM- companion to SAM in compressed binary
    - .bai is a companion file which contains the index
      - index acts like an external table of contents, and allows programs to jump directly to specific parts of the bam file without reading through all of the sequences. Without the corresponding bam file, your bai file is useless, since it doesn't actually contain any sequence data.
- read groups
  - https://gatkforums.broadinstitute.org/gatk/discussion/6472/read-groups
  - effectively treated as a separate run of the NGS instrument in tools like base quality score recalibration -- all reads within a read group are assumed to come from the same instrument run and to therefore share the same error model
  - GATK tools treat all read groups with the same SM value as containing sequencing data for the same sample
  - https://gatkforums.broadinstitute.org/gatk/discussion/6472/read-groups

*** Bioinformatics consortia, data portals and commons
:PROPERTIES:
:ID:       0e7d0c19-22cc-4502-a3c2-4be5b537f375
:END:
- https://ega-archive.org/access/request-data/how-to-request-data/
- [[https://portal.gdc.cancer.gov/][Genomic data commons]]
- [[https://datascience.cancer.gov/data-commons][NCI Cancer Research Data Commons]]
- [[https://www.cancer.gov/research/infrastructure/bioinformatics/cancer-research-data-ecosystem-infographic][NCI Cancer Research Data Ecosystem]]
- GENIE - https://aacrjournals.org/cancerdiscovery/article/7/8/818/6485/AACR-Project-GENIE-Powering-Precision-Medicine
- https://www.science.org/doi/full/10.1126/scisignal.2004088
- https://www.nature.com/articles/s41588-021-00791-5#Sec2
- [[cite:&langmead2018]]
- [[cite:&grossman2019]]
- [[cite:&bernasconi2020]]
- [[cite:&grossman2018]]
**** Variant databases
:PROPERTIES:
:ID:       86883c33-5647-4da3-9203-ac16e7e2cc97
:END:
https://www.oncokb.org/
https://civicdb.org/welcome
** Scripts
:PROPERTIES:
:ID:       b9c397b3-3b6d-4737-8463-30be2eacaa21
:END:
*** R
:PROPERTIES:
:ID:       cf713cca-7356-4082-899c-0c343dab176e
:END:
**** [[file:~/repos/basecamp/basecamp.org::*R scripts][R scripts in basecamp]]
:PROPERTIES:
:ID:       060640e9-ebaa-4fac-9558-c57a000e8e9c
:END:
*** Bash
:PROPERTIES:
:ID:       d18892b5-b2eb-49d3-874c-d7741b0277b6
:END:
**** Check run conditions for integration testing
:PROPERTIES:
:ID:       f975f7d1-a54e-4695-9132-996a810d5961
:END:

#+begin_src bash
#!/usr/bin/env bash

repo=$1
mntpt=$2
sif_dir=$3

# Check for parameters, return usage if empty
if [ $# -ne 3 ];
then
    printf "\n usage: repo_startup.sh <REPO PATH> <RIS MOUNT PT> <SINGULARITY CONTAINER DIR>
    \n Repo development helper script to check run conditions for integration testing
    \n "
else

    # Check mount point
    if grep -qs $mntpt /proc/mounts; then
        echo "RIS storage mounted."
    else
        echo "RIS storage NOT mounted, exiting."
        exit 1
    fi

    # Check singularity container
    if [ -r $sif_dir/atac.sif ]; then
        echo "Local SIF file present"
    else
        echo "No local SIF file found"
        exit 1
    fi

    # Check singularity container up-to-date
    if [ /mnt/ris/jschwarz/cardiac-radiobiology/atac.sif -nt $sif_dir/atac.sif ]; then
        echo "Local SIF is out of date. Updating ..."
        cp /mnt/ris/jschwarz/cardiac-radiobiology/atac.sif $sif_dir/atac.sif
    else
        echo "Local SIF file is up to date"
    fi

    cur_branch=$(git branch | head -n 1)
    echo "Current branch is $cur_branch"
fi
#+end_src

**** Dry run
:PROPERTIES:
:ID:       c6c494f0-5dbe-4cc4-bf99-8bcd7b12de24
:END:

#+begin_src bash :tangle ./tools/shell/smk_dry_run.sh
#  Note: This code block transcluded from code blocks in the Emacs Org-mode
#  file at https://github.com/jeszyman/biotools/blob/master/biotools.org.
#  Changes made directly to this region will be overwritten by transclusion from
#  the source blocks in that file.

# Check for parameters and return usage
if [ "$#" -ne 2 ];
then
    printf "\n usage: smk_dry_run.sh <SMK CONFIG YAML> <SMK FILE>
    \n Script for snakemake dry run.
    \n Will not test singularity container is working
    \n "
else
    # Necessary to run conda snakemake command in shell script
    eval "$(command conda 'shell.bash' 'hook' 2> /dev/null)"
    #
    conda activate snakemake
    #
    snakemake \
        --configfile $1 \
        --cores 1 \
        --dry-run \
        --forceall \
        --printshellcmds \
        --use-singularity \
        --snakefile $2
fi
#+end_src

**** Draw rulegraph
:PROPERTIES:
:ID:       78a99954-1d5d-4e09-87a4-6690f28f4519
:CUSTOM_ID: 78a99954-1d5d-4e09-87a4-6690f28f4519
:END:

#+begin_src bash :tangle ./tools/shell/smk_draw.sh
#  Note: This code block transcluded from code blocks in the Emacs Org-mode
#  file at https://github.com/jeszyman/biotools/blob/master/biotools.org.
#  Changes made directly to this region will be overwritten by transclusion from
#  the source blocks in that file.

# Check for parameters and return usage
if [ "$#" -ne 3 ];
then
    printf "\n usage: smk_dry_run.sh config_file smk_file pdf_loc
    \n Draws the rulegraph for a snakemake file at pdf_loc
    \n "
else
    # Necessary to run conda snakemake command in shell script
    eval "$(command conda 'shell.bash' 'hook' 2> /dev/null)"
    #
    png=$(echo $3 | sed 's/.pdf/.png/g')
    conda activate snakemake
    #
    snakemake \
        --configfile $1 \
        --cores 1 \
        --rulegraph \
        --snakefile $2 | dot -Tpdf > $3
    #
    snakemake \
        --configfile $1 \
        --cores 1 \
        --rulegraph \
        --snakefile $2 | dot -Tpng > $png
fi
#+end_src

**** [#D] Normal run
:PROPERTIES:
:effort:   00:30
:ID:       3adf72d3-aa35-4a3d-8eba-0df075c52e26
:CUSTOM_ID: 3adf72d3-aa35-4a3d-8eba-0df075c52e26
:END:

- [ ] needs a cores option w/ default
#+begin_src bash :tangle ./tools/shell/smk_run.sh
#  Note: This code block transcluded from code blocks in the Emacs Org-mode
#  file at https://github.com/jeszyman/biotools/blob/master/biotools.org.
#  Changes made directly to this region will be overwritten by transclusion from
#  the source blocks in that file.

# Check for parameters, return usage if empty
if [ "$#" -ne 2 ];
then
    printf "\n usage: smk_forced_run.sh <SMK CONFIG YAML> <SMK FILE>
    \n Script to complete an normal run of a snakefile
    \n Assumes
    - Singularity container specified in config
    - a mount point at /mnt
    \n "
else
    # Necessary to run conda snakemake command in shell script
    eval "$(command conda 'shell.bash' 'hook' 2> /dev/null)"
    #
    conda activate snakemake
    #
    snakemake \
        --configfile $1 --cores 4 \
        --use-singularity \
        --printshellcmds \
        --singularity-args "--bind ${HOME}:${HOME} --bind /mnt:/mnt" \
        --rerun-incomplete \
        --resources mem_mb=6000 \
        --snakefile $2 \
        --verbose
fi
#+end_src

**** Forced run
:PROPERTIES:
:ID:       c2a25d2f-05bb-4eda-920f-e2d9fa768de6
:CUSTOM_ID: c2a25d2f-05bb-4eda-920f-e2d9fa768de6
:END:

#+begin_src bash :tangle ./tools/shell/smk_forced_run.sh
#  Note: This code block transcluded from code blocks in the Emacs Org-mode
#  file at https://github.com/jeszyman/biotools/blob/master/biotools.org.
#  Changes made directly to this region will be overwritten by transclusion from
#  the source blocks in that file.

# Check for parameters and return usage
if [ "$#" -ne 2 ];
then
    printf "\n usage: smk_forced_run.sh config_file smk_file
    \n Script to complete forced run of snakefile.
    \n Assumes
    - Singularity container specified in config
    - a mount point at /mnt
    \n "
else
    # Necessary to run conda snakemake command in shell script
    eval "$(command conda 'shell.bash' 'hook' 2> /dev/null)"
    #
    conda activate snakemake
    #
    snakemake \
        --configfile $1 --cores 4 \
        --use-singularity \
        --singularity-args "--bind ${HOME}:${HOME} --bind /mnt:/mnt" \
        --forceall \
        --printshellcmds \
        --rerun-incomplete \
        --snakefile $2 \
        --verbose
fi
#+end_src

**** Development
:PROPERTIES:
:header-args: :tangle no
:ID:       cc13119d-3103-4164-9277-34a2b515fb46
:END:

- https://unix.stackexchange.com/questions/10646/repeat-a-unix-command-every-x-seconds-forever
- ?
  #+begin_src bash
#!/bin/bash
#
#############################################################################
###              BIOINFORMATICS PROJECT COMMON SETUP SCRIPT               ###
#############################################################################
#
###############
### SCRIPTS ###
###############
#
# Interactive docker initialization
docker_interactive() {
  repo="USER INPUT"
  read -p "repo name: " repo
  case $HOSTNAME in
      (radonc-cancerbio) docker run -it \
                                -v /media/:/media/ \
                                -v /home/:/home/ \
                          -u $(id -u ${USER}) \
                          jeszyman/$repo \
                          /bin/bash;;
      (jeszyman-*) docker run -it \
                          -v /home/:/home/ \
                          -u $(id -u ${USER}) \
                          jeszyman/$repo \
                          /bin/bash;;
      (acl*) docker run -it \
                    -v /drive3/:/drive3/ \
                    -v /duo4/:/duo4/ \
                    -v /home/:/home/ \
                    -u $(id -u ${USER}) \
                    jeszyman/$repo \
                    /bin/bash;;
      (ACL*) docker run -it \
                    -v /home/:/home/ \
                    -v /duo4/:/duo4/ \
                    -u $(id -u ${USER}):$(id -g ${USER}) \
                    -h=${HOSTNAME} \
                    jeszyman/$repo \
                    /bin/bash;;
      (virtual-workstation*.gsc.wustl.edu) bsub -Is -q docker-interactive -a 'docker(jeszyman/'"$repo"')' /bin/bash;;
  esac
}
#
#
echo "Biotools setup completed successfully"
#
############################################################################
#
#############
### IDEAS ###
#############
# # identifies server in docker containers
# server_ask() {
#     echo -n "Choose your server: "
#     read SERVER
#     SERVER="${SERVER:=chaudhuri-roche}"
# }
# # check if inside docker
# if [ -f /.dockerenv ];then
#     dockercontainer=yes
#     echo "Your are in a docker container"
# else
#     dockercontainer=no
#     echo "Not in docker"
#     # setup NON-docker variables
#     shopt -s nocasematch
#     case $HOSTNAME in
#         (radonc-cancerbio) server_home="/home/jeszyman" ;;
#         (jeszyman-*) server_home="/home/jeszyman" ;;
#         (acl*) server_home="/home/jszymanski" ;;
#         (virtual-workstation*.gsc.wustl.edu) server_home="/gscuser/szymanski" ;;
#         (blade*.gsc.wustl.edu) server_home="/gscuser/szymanski" ;;
#     esac
#     projectdir=$server_home"/repos/$project"
#     localdata="$server_home/data/$project/"
#     unset $SERVER
# fi
# #
# case $dockercontainer in
#     (yes) server_ask ;;
#     (no) ;;
# esac
# #
# case $SERVER in
#     (chaudhuri-roche) projectdir=/drive3/users/jszymanski/repos/$project
#                       localdata=/drive3/users/jszymanski/data/$project;;
#     (NA) ;;
# esac
#
#IDEAS
### DEPENDENCIES ###
#declare -a software=(
#"rclone"
# #DOES NOT RETURN ON MGI                     "docker"
# #"git"
# "bash"
# )
# for i in "${software[@]}"; do
# if command -v $i >/dev/null 2>&1 ; then
#     echo "$i installed"
# else
#     echo "$i not found, exiting"
#     exit 1
# fi
# done

#+end_src
- example [[id:8263e3b1-3ba4-4c4f-8d39-9dd9bb06e2bb][publish to box]]
  #+begin_src bash
#!/usr/bin/env bash
git pull &&
    git add -A &&
    git commit -m "minor changes" &&
    git push

git branch
git branch stable4.1
git checkout stable4.1
git merge master
git push origin stable4.1
git checkout master
#+end_src

***** Dev
:PROPERTIES:
:ID:       d4dc3eed-f410-4570-9df7-db423ac6ce12
:END:

#+begin_src bash
#!/bin/bash
#########1#########2#########3#########4#########5#########6#########7#########8

####################################
###   Choose and Run Snakefile   ###
####################################

# Setup
#set -euxov pipefail

source config/${HOSTNAME}.sh
echo "The following `*.smk` archives were found; select one:"

# set the prompt used by select, replacing "#?"
PS3="Use number to select an option"

select filename in ./workflow/*.smk

do
    if [[ "$filename" == "" ]]
    then
        echo "'$REPLY' is not a valid number"
        continue
    fi
    echo $filename
    select run_option in dry_run normal force_final force_all
    do
        echo selected $run_option
        case $run_option in
            dry_run)
                source activate snakemake
                snakemake \
                    --configfile config/${HOSTNAME}.yaml \
                    --cores $threads \
                    --directory ${repo} \
                    --dry-run \
                    --rerun-incomplete \
                    --singularity-args "--bind $mntpt:$mntpt" \
                    --use-singularity \
                    --snakefile $filename
                ;;
            normal)
                source activate snakemake
                select nohup_option in no yes
                do
                    case $nohup_option in
                        no)
                            snakemake \
                                --configfile config/${HOSTNAME}.yaml \
                                --cores $threads \
                                --directory ${repo} \
                                --singularity-args "--bind $mntpt:$mntpt" \
                                --use-singularity \
                                --snakefile $filename
                            ;;
                        yes)
                            nohup snakemake \
                                  --configfile config/${HOSTNAME}.yaml \
                                  --cores $threads \
                                  --directory ${repo} \
                                  --singularity-args "--bind $mntpt:$mntpt" \
                                  --use-singularity \
                                  --snakefile $filename
                            ;;
                    esac
                done
                ;;
            force_final)
                source activate snakemake
                select nohup_option in no yes
                do
                    case $nohup_option in
                        no)
                            snakemake \
                                --configfile config/${HOSTNAME}.yaml \
                                --cores $threads \
                                --directory ${repo} \
                                --force \
                                --singularity-args "--bind $mntpt:$mntpt" \
                                --use-singularity \
                                --snakefile $filename
                            ;;
                        yes)
                            nohup snakemake \
                                  --configfile config/${HOSTNAME}.yaml \
                                  --cores $threads \
                                  --directory ${repo} \
                                  --force \
                                  --singularity-args "--bind $mntpt:$mntpt" \
                                  --use-singularity \
                                  --snakefile $filename
                            ;;
                    esac
                done
                ;;
            force_all)
                source activate snakemake
                select nohup_option in no yes
                do
                    case $nohup_option in
                        no)

                snakemake \
                    --configfile config/${HOSTNAME}.yaml \
                    --cores $threads \
                    --directory ${repo} \
                    -F \
                    --singularity-args "--bind $mntpt:$mntpt" \
                    --use-singularity \
                    --snakefile $filename
                                            ;;
                        yes)
                nohup snakemake \
                    --configfile config/${HOSTNAME}.yaml \
                    --cores $threads \
                    --directory ${repo} \
                    -F \
                    --singularity-args "--bind $mntpt:$mntpt" \
                    --use-singularity \
                    --snakefile $filename
                            ;;
                    esac
                done
                ;;
        esac
        break
    done
    break
done
#+end_src

**** Examples
:PROPERTIES:
:ID:       21f84b20-5cfc-4ef8-bdeb-c03169f298c9
:END:

- https://github.com/jeszyman/exrna
- https://github.com/jeszyman/cfdna-wgs
- https://github.com/jeszyman/cappseq
- https://github.com/jeszyman/cfdna-frag
- https://github.com/jeszyman/atac-seq

**** [[https://snakemake.readthedocs.io/en/stable/index.html][Documentation]]
:PROPERTIES:
:ID:       d95ad5b8-392b-4c03-b974-6a5a436cee05
:END:

- https://snakemake-wrappers.readthedocs.io/en/stable/wrappers.html
- [[Snakemake Tutorial][Snakemake Tutorial]]

**** General reference
:PROPERTIES:
:ID:       33a35d45-c88f-4734-9fb7-f382fa6d00a4
:END:

- https://github.com/aomlomics/tourmaline
- https://carpentries-incubator.github.io/snakemake-novice-bioinformatics/
- https://swcarpentry.github.io/r-novice-inflammation/05-cmdline/index.html
- https://carpentries-incubator.github.io/snakemake-novice-bioinformatics/
- #+PROPERTY: header-args:bash :tangle-mode (identity #o777)
- ideas
  `(make-string (+ 2 (org-current-level)) ?*)` Run commands
  ,#+begin_src bash
  conda activate snakemake

  snakemake \
    --cores $threads \
    --printshellcmds \
    --snakefile workflow/$1
  ,#+end_src
- Standards and best practice
  - https://snakemake.readthedocs.io/en/stable/snakefiles/best_practices.html#snakefiles-best-practices
- Wildcards
  - https://edwards.flinders.edu.au/wildcards-in-snakemake/
- https://endrebak.gitbooks.io/the-snakemake-book/content/
- https://academic.oup.com/bioinformatics/article/28/19/2520/290322
- https://www.biostars.org/p/9469533/
- https://stackoverflow.com/questions/64949149/is-it-possible-to-add-a-conditional-statement-in-snakemakes-rule-all
- https://stackoverflow.com/questions/54400171/how-to-use-list-in-snakemake-tabular-configuration-for-describing-of-sequencing
- https://github.com/ngs-docs/2020-ggg-201b-rnaseq/blob/latest/rnaseq-workflow.Rmd
- https://angus.readthedocs.io/en/2019/snakemake_for_automation.html
- https://pages.charlesreid1.com/how-do-i-snakemake/converting/
- http://ivory.idyll.org/blog/2020-snakemake-hacks-collections-files.html
- http://origin.research.jetbrains.org/files/material/5ec245b4e907c.pdf
- https://f1000research.com/articles/10-33/v2
- [ ] https://lachlandeer.github.io/snakemake-econ-r-tutorial/config-files.html
- https://github.com/snakemake-workflows/rna-seq-star-deseq2/blob/master/workflow/rules/diffexp.smk
- https://github.com/csoneson/ARMOR
- https://github.com/slowkow/snakefiles/blob/master/kallisto/Snakefile
- https://lachlandeer.github.io/snakemake-econ-r-tutorial/initial-steps-with-snakemake.html
- for repos, git ignore the singularity build
- https://github.com/EnvGen/snakemake-workflows

***** Tutorials and guides
:PROPERTIES:
:ID:       edddb253-b466-42c4-86a2-ab36900a42e0
:END:

- https://reproducibility.sschmeier.com/index.html
- a tutorial
  #+begin_src bash
source ~/repos/biotools/src/functions.sh
docker_interactive
biotools

#
mkdir -p /tmp/snakemake-tutorial
cd /tmp/snakemake-tutorial
#
wget https://github.com/snakemake/snakemake-tutorial-data/archive/v5.24.1.tar.gz
#
tar --wildcards -xf v5.24.1.tar.gz --strip 1 "*/data" "*/environment.yaml"
ls

#
snakemake --help

snakemake -np mapped_reads/A.bam
#+end_src
- another tutorial
  #+begin_src bash
sudo apt-get install singularity-container

cd ~/snakemake-tutorial/

conda activate snakemake-tutorial


snakemake -p --cores 2 sorted_reads/{A,B}.bam
#    --dry-run \

snakemake --dag calls/all.vcf | dot -Tsvg > dag.svg

expand("sorted_reads/{sample}.bam", sample=SAMPLES)

snakemake -p --cores 2 plots/quals.svg

snakemake --cores 2 -p --dag | dot -Tsvg > dag.svg

snakemake --cores 20 --forceall --summary

snakemake --cores 20 --forceall

conda install pygraphviz

snakemake --report report.html

open report.html

snakemake --cores 20 --forceall
#+end_src
- https://snakemake.readthedocs.io/en/stable/executor_tutorial/google_lifesciences.html

**** Examples
:PROPERTIES:
:ID:       058c8ef3-7ef2-4317-b7b5-eab95079ad18
:END:

- https://github.com/vari-bbc/rnaseq_workflow/blob/master/Snakefile
- https://github.com/ohsu-cedar-comp-hub/cfRNA-seq-pipeline-Ngo-manuscript-2019
- https://github.com/yztxwd/rna-seq-standard-pipeline/tree/c19a9e27216b86d3dbfdaed7228aeff59f869383
- https://github.com/porchard/ATACseq-Snakemake/blob/master/src/Snakefile
- https://github.com/zhxiaokang/RASflow
- https://github.com/EthanHolleman
- https://www.biostars.org/p/406385/
- https://github.com/chrishah/samtools-docker/blob/master/Dockerfile
- https://github.com/lachlandeer/snakemake-econ-r

**** Config
:PROPERTIES:
:ID:       325173d3-c05b-448b-9602-4585793aab69
:END:


:PROPERTIES:
:ID:       5120c9dd-8e0b-4b2c-8c77-a89f271a48e4
:END:

#+name: bioinfo.config.common.sh
#+begin_src bash :tangle no
# -*- mode: snippet -*-
# key: bioinfo.config.common.sh
# expand-env: ((yas-indent-line 'fixed))
# --
,#+name: bash_common_config
,#+begin_src bash :noweb yes :tangle ./config/common.sh
#!/bin/bash
#########1#########2#########3#########4#########5#########6#########7#########8
#

# Check git file hook is read-able
if [ -r "${repo}/.git/hooks/precommit" ]; then
   echo "Git size check is read-able"
else
    echo
    "Git size check is not read-able"
    exit 1
fi

# Check mount point
if grep -qs $mntpt /proc/mounts; then
    echo "RIS storage mounted."
else
    echo "RIS storage NOT mounted, exiting."
    exit 1
fi

# Check singularity container
if [ -r $sif_dir/atac.sif ]; then
    echo "Local SIF file present"
else
    echo "No local SIF file found"
fi
    fi
}
#+end_src

**** Bioinformatic shell functions
:PROPERTIES:
:header-args: :tangle ./lib/bioinformatics_function.sh :tangle-mode (identity #o555) :mkdirp yes :noweb yes :comments org
:ID:       2e51c010-1e25-4fc3-acc5-aefd490164be
:END:
** BioanalyzeR                                                     :cookbook:
https://jwfoley.com/bioanalyzeR.html#importing-data
https://github.com/jwfoley/bioanalyzeR
#+begin_src R
library(bioanalyzeR)

list.files(paste0(find.package("bioanalyzeR"), "/extdata"), recursive = TRUE)

dna1000 <- read.electrophoresis(system.file(
    "extdata",
    "bioanalyzer",
    "Demo DNA 1000 Series II.xml.gz",
    package = "bioanalyzeR"
))

class(dna1000)

names(dna1000)

dna1000$assay.info
dna1000$samples
head(dna1000$peaks)
head(subset(dna1000$data, ! is.na(length)))

dna1000.ladder1 <- subset(dna1000, sample.name == "Ladder 1")

d1000 <- read.electrophoresis(system.file(
    "extdata",
    "tapestation",
    "D1000-Tubes-16-D1000.xml.gz",
    package = "bioanalyzeR"
))

qplot.electrophoresis(d1000, title = "TapeStation D1000")

# Remove ROI and peak calls
qplot.electrophoresis(
  d1000,
  show.peaks = "none",
  region.alpha = 0,
  title = "TapeStation D1000 with no peaks"
)

# Add flourescent markers
qplot.electrophoresis(
    d1000,
    x = "relative.distance",
    y = "fluorescence",
    include.markers = TRUE,
    show.peaks = "markers",
    title = "TapeStation D1000 with marker peaks"
)

# As geom_live vs geom_area
eukrna <- read.electrophoresis(system.file(
    "extdata",
    "tapestation",
    "Eukaryotic RNA-Tubes-16-RNA.xml.gz",
    package = "bioanalyzeR"
))

qplot.electrophoresis(
    eukrna,
    y = "concentration",
    xlim = c(100, NA),
    title = "TapeStation Eukaryotic RNA with geom_line"
)

qplot.electrophoresis(
    eukrna,
    y = "concentration",
    xlim = c(100, NA),
    geom = "area",
    title = "TapeStation Eukaryotic RNA with geom_area"
)

#########1#########2#########3#########4#########5#########6#########7#########8

head(subset(test$data, ! is.na(length)))
dna1000$regions

qplot.electrophoresis(
  test,
  y = "fluorescence",
  xlim = c(50,7000),
  ylim = c(0,100),
  geom = "area",
  show.peaks = "none",
  region.alpha = 0,
  title = "TapeStation Eukaryotic RNA with geom_line"
)

# SPRI peaks!!!
qplot.electrophoresis(
  test,
  #y = "fluorescence",
  y = "concentration",
  #xlim = c(50,1000),
  #ylim = c(0,6),
  #geom = "area",
  show.peaks = "none",
  region.alpha = 0,
  #scales = "free_y",
  scales = "free_y",
  #log = "x",
  #log = "xy",
  #ylim = c(1,10),
  #normalize = "total",
  normalize = "window",
  #xlim = c(90,1000),
  #ylim = c(-0.01,NA),
  ylim = c(0.002,NA),
  xlim = c(50,500),
  title = "TapeStation Eukaryotic RNA with geom_line"
)

# SPRI peaks!!!
qplot.electrophoresis(
  test,
  #y = "fluorescence",
  y = "concentration",
  #xlim = c(50,1000),
  #ylim = c(0,6),
  #geom = "area",
  show.peaks = "none",
  region.alpha = 0,
  #scales = "free_y",
  scales = "free_y",
  #log = "x",
  #log = "xy",
  #ylim = c(1,10),
  #normalize = "total",
  normalize = "window",
  #xlim = c(90,1000),
  #ylim = c(-0.01,NA),
  ylim = c(0.002,NA),
  xlim = c(50,500),
  facets = NULL,
  title = "TapeStation Eukaryotic RNA with geom_line"
)

# SPRI peaks!!!
qplot.electrophoresis(
  subset(test, endsWith(as.character(sample.name), "SPRI")),
  y = "fluorescence",
  #y = "concentration",
  #xlim = c(50,1000),
  #ylim = c(0,6),
  #geom = "area",
  show.peaks = "none",
  region.alpha = 0,
  #scales = "free_y",
  scales = "free_y",
  #log = "x",
  #log = "xy",
  #ylim = c(1,10),
  #normalize = "total",
  normalize = "window",
  #xlim = c(90,1000),
  #ylim = c(-0.01,NA),
  #ylim = c(0.002,NA),
  xlim = c(50,500),
  facets = NULL,
  title = "TapeStation Eukaryotic RNA with geom_line"
)
#+end_src
** Good practice
https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003285
** Local YAS
:PROPERTIES:
:ID:       d60dc63d-66d6-4792-b55f-e39a616679ad
:END:
*** r.bioc                                                              :yas:
:PROPERTIES:
:ID:       99141c49-76e3-4dec-9296-28a12bc1ada6
:END:
#+begin_src bash :tangle no
# -*- mode: snippet -*-
# key: r.bioc
# expand-env: ((yas-indent-line 'none))
# --
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
#+end_src
*** UPDATE_ON_USE bioinfo.setup
CLOSED: [2021-12-09 Thu 12:38]
:PROPERTIES:
:ID:       dbd3c67c-e33b-42d8-800d-705292d3c372
:CUSTOM_ID: dbd3c67c-e33b-42d8-800d-705292d3c372
:END:

#+begin_src bash :tangle no
# -*- mode: snippet -*-
# key: bioinfo.setup
# expand-env: ((yas-indent-line 'none))
# --
`(concat "*" (make-string (org-current-level) ?*))` Setup
`(concat "**" (make-string (org-current-level) ?*))` Bash
`(concat "***" (make-string (org-current-level) ?*))` TODO Configurations
- Local (by $HOSTNAME)
- Common
  ,#+begin_src bash :tangle ./config/common.sh
,#+end_src
`(concat "***" (make-string (org-current-level) ?*))` TODO Preambles
- Command line
  ,#+name: bash_preamble_cmd
  ,#+begin_src bash
if [[ -f ./config/\${HOSTNAME}.sh ]];
then source ./config/\${HOSTNAME}.sh
else
    echo "No config file found for \${HOSTNAME}"
    exit 1
fi
,#+end_src
- Snakemake
`(concat "**" (make-string (org-current-level) ?*))` TODO Box and rclone
`(concat "**" (make-string (org-current-level) ?*))` TODO Docker and singularity
`(concat "***" (make-string (org-current-level) ?*))` Processes
1. Write
   ,#+begin_src bash :tangle ./config/DOCKER_IMAGE_NAME_Dockerfile
,#+end_src
2. Build
3. Make singularity container from docker container
`(concat "**" (make-string (org-current-level) ?*))` TODO Emacs and Org-mode
- [ ] Run minimal YAS
  bioinfo.setup
  bioinfo.inputs
  bioinfo.data
  locvars
- [ ] Add
  - to main reference section
    - Bioinformatics project [[6acdcddf-d693-40f2-a3ae-9703bad56043][module headline]] and [[tag:{bioinfo}][instances]]
  - to Local variables
    ,#+TODO: WAITING(w@) TODO(t) INPROCESS(p) | CLOSEOUT DONE(d!) DELEGATED(@) CANCELED(@)
    ,#+property: header-args:R    :session *PROJECT_NAME*
`(concat "**" (make-string (org-current-level) ?*))` TODO Local data directory and WashU RIS Storage processes
- Mount
- Create directory structure
  ,#+begin_src bash
  <<bash_preamble>>
  ,#+end_src
`(concat "**" (make-string (org-current-level) ?*))` R
`(concat "***" (make-string (org-current-level) ?*))` TODO Configurations
`(concat "***" (make-string (org-current-level) ?*))` TODO Preambles
`(concat "**" (make-string (org-current-level) ?*))` TODO Repository, git, and github
- [ ] ensure [[file:.git/hooks/pre-commit]]
- [ ] Create repository structure
  ,#+begin_src bash
mkdir -p "\${repo}/config"
mkdir -p "\${repo}/resources"
mkdir -p "\${repo}/results"
mkdir -p "\${repo}/src"
mkdir -p "\${repo}/workflow/scripts"
,#+end_src
`(concat "***" (make-string (org-current-level) ?*))` README
`(concat "**" (make-string (org-current-level) ?*))` Snakemake
`(concat "***" (make-string (org-current-level) ?*))` TODO Configurations
`(concat "***" (make-string (org-current-level) ?*))` TODO Run commands
#+end_src

*** bioinfo.launch.docker
:PROPERTIES:
:ID:       d2b47716-387f-4209-a751-1e3108d70106
:END:

#+name: bioinfo.launch.docker
#+begin_src bash :tangle no
  # -*- mode: snippet -*-
  # key: bioinfo.launch.docker
  # expand-env: ((yas-indent-line 'fixed))
  # --
  ,#+begin_src bash
  #!/bin/bash
  #########1#########2#########3#########4#########5#########6#########7#########8
  #

  # Notes: This block build from bioinfo.launch.docker at
  #  ce85a21e-466f-43d0-ad13-3cd21497bfc3

  # Function to launch an interactive docker session

  ,#+end_src
#+end_src

*** bioinfo.setup.bash
:PROPERTIES:
:ID:       847d4a6c-83e6-4ca1-9ea4-2daf6def6c3c
:END:

#+name: bioinfo.setup.bash
#+begin_src bash :tangle no
  # -*- mode: snippet -*-
  # key: bioinfo.setup.bash
  # expand-env: ((yas-indent-line 'fixed))
  # --
  `(make-string (1+ (org-current-level)) ?*)` Bash
  Potential YAS to run:
  bioinfo.config.host.sh
  bioinfo.config.main.sh
  ris.mount
  $0
#+end_src

*** bioinfo.config.main.R
:PROPERTIES:
:ID:       c7edbb0d-e0bc-432a-b482-71b16bd40aaa
:END:

#+name: bioinfo.config.main.R
#+begin_src bash :tangle no
  # -*- mode: snippet -*-
  # key: bioinfo.config.main.R
  # expand-env: ((yas-indent-line 'fixed))
  # --
  ,#+begin_src R :noweb yes :tangle ./config/main.R
  #!/usr/bin/env Rscript
  #########1#########2#########3#########4#########5#########6#########7#########8
  #
  # Repository-local, relative variables
  $0

  # Pull in from other repositories
  ##
  ## Basecamp
  <<./basecamp/basecamp.org:basecamp_r_setup_wrapper()>>

  ##
  ## Biotools
  <<./biotools/biotools.org:biotools_r_setup_wrapper()>>

  ,#+end_src
#+end_src

*** bioinfo.config.local.R
:PROPERTIES:
:ID:       27114eb7-5931-489c-a105-ed7375074678
:END:

#+name: bioinfo.config.local.R
#+begin_src bash :tangle no
  # -*- mode: snippet -*-
  # key: bioinfo.config.local.R
  # expand-env: ((yas-indent-line 'fixed))
  # --
  ,#+begin_src R :noweb yes :tangle ./config/${1:HOSTNAME}.R
  #!/usr/bin/env Rscript
  #########1#########2#########3#########4#########5#########6#########7#########8
  #
  # Repository-local, host-absolute variables
  data_dir = file.path("${2:DATA_DIR}")
  source("./config/main.R")
  $0
  ,#+end_src
#+end_src

*** bioinfo.bash.script
:PROPERTIES:
:ID:       769639f9-c804-4bac-afb7-5167ce3a10b5
:END:

#+name: bioinfo.bash.script
#+begin_src bash :tangle no
  # -*- mode: snippet -*-
  # key: bioinfo.bash.script
  # expand-env: ((yas-indent-line 'fixed))
  # --
  #!/bin/bash
  #########1#########2#########3#########4#########5#########6#########7#########8
  #
  ### ${1:SCRIPT NAME} ###
  #
  # Notes:
  ## This script assumes your your bash sessin is running within the repository docker container (see ./)
  ## This script calls relative varibles and assumes you have sourced an appriopriate configuration file (see ./config)
#+end_src

*** bioinfo.inputs
:PROPERTIES:
:ID:       d6bb61c9-8b10-4460-b987-0a6c678d2ddb
:CUSTOM_ID: d6bb61c9-8b10-4460-b987-0a6c678d2ddb
:END:

#+begin_src bash :tangle no
# -*- mode: snippet -*-
# key: bioinfo.inputs
# expand-env: ((yas-indent-line 'none))
# --
`(make-string (1+ (org-current-level)) ?*)` Inputs
,#+name: input_table
|basename|dirname|get_class|model_class|origin
`(concat "**" (make-string (org-current-level) ?*))` Manually created input tables
- (names must end in _input)
-
#+end_src
** Processes
:PROPERTIES:
:ID:       a7a7cba3-9e47-48dc-9603-a2e4f1e27234
:END:
- repository structure
  - examples
    - - https://github.com/WayScience/NF1_SchwannCell_data_analysis
- infer fastq details from header https://chatgpt.com/c/a41b1403-c420-453a-9257-183e47749e7c
  - https://github.com/nickp60/fcid/blob/main/fcid/run.py
    #+begin_src python
  import gzip

  def infer_sequencer_from_fastq(fastq_file):
      with gzip.open(fastq_file, 'rt') as f:
          for line in f:
              if line.startswith('@'):
                  header = line.strip()
                  if header.split(':')[0].startswith('@'):
                      sequencer = "Illumina"
                  else:
                      sequencer = "Unknown"
                  print(f"Header: {header}")
                  print(f"Inferred Sequencer: {sequencer}")
                  break

  fastq_file = '/mnt/data/projects/pnst/fastqs/13_JS0028CD111918_R1.fastq.gz'

  infer_sequencer_from_fastq(fastq_file)

  import gzip

  def infer_sequencer_from_fastq(fastq_file):
      with gzip.open(fastq_file, 'rt') as f:
          for line in f:
              if line.startswith('@'):
                  header = line.strip()
                  parts = header.split(':')
                  instrument = parts[0].replace('@', '')

                  if instrument:
                      sequencer = "Illumina"
                  else:
                      sequencer = "Unknown"

                  print(f"Header: {header}")
                  print(f"Inferred Sequencer: {sequencer}")
                  print(f"Instrument: {instrument}")
                  break


  infer_sequencer_from_fastq(fastq_file)
  #+end_src
*** Methylation
- Rationale- cfMeDIP-seq only measures HYPERmethylation (via IP), see [cite:@nassiri2020]

https://pmc.ncbi.nlm.nih.gov/articles/PMC6162482/
**** Methylome deconvolution
https://www-nature-com.mclibrary.idm.oclc.org/articles/s41467-024-48466-z
*** Spatial methods
:PROPERTIES:
:ID:       bac12c9a-6f8a-4d1b-b8a2-041632c814f6
:END:
https://mail.google.com/mail/u/0/#inbox/FMfcgzGxTFWDgPhqMLGHBDfJrdBMrWXq
[[id:4de39606-9232-4cfc-b444-f4a27e577862][Spatial ATAC-seq]]


#+begin_src yaml :tangle ./config/spatial-conda-env.yaml
name: spatial
channels:
  - conda-forge
  - bioconda

dependencies:
  - r-data.table
  - r-seurat
#+end_src

- CosMx "cosmic" SMI spatial single cell
- Xenium 10x panel
*** Fluorometry
:PROPERTIES:
:ID:       fd71d66e-238c-4726-b399-17341a615242
:END:
- https://assets.thermofisher.com/TFS-Assets/BID/Technical-Notes/qubit-1x-dsdna-assays-simplified-workflow-tech-note.pdf
- https://assets.thermofisher.com/TFS-Assets/LSG/manuals/MAN0017455_Qubit_1X_dsDNA_HS_Assay_Kit_UG.pdf
*** Solid-phase reversible immobilization (SPRI)
:PROPERTIES:
:ID:       bb4c99e3-2827-4a2c-918a-5d15d9950cf9
:END:
- https://research.fredhutch.org/content/dam/stripe/hahn/methods/mol_biol/SPRIselect%20User%20Guide.pdf

**** Right-sided bead selection
*** Spectrophotometry
:PROPERTIES:
:ID:       4f8dc8f6-8ec9-44c8-9a86-a633e182037f
:END:
- https://www.agilent.com/cs/library/usermanuals/public/2100_Bioanalyzer_Expert_USR.pdf
- [[id:ea6092a7-8c57-4063-a5b5-64e88652c818][bioanalyzeR]]

*** Workflow languages
:PROPERTIES:
:ID:       2377b4bf-117a-429d-94ed-4ee880510b9b
:END:
https://snakemake.github.io/snakemake-workflow-catalog/
https://www.google.com/search?q=convert+snakemake+to+nextflow&oq=convert+snakemake+to+nextflow&aqs=chrome..69i57j33i160l2.20088j0j7&client=ms-android-hmd-rvo3&sourceid=chrome-mobile&ie=UTF-8
https://www.reddit.com/r/bioinformatics/comments/15gut08/its_almost_2024_what_languageframework_are_you/
*** Biomarkers
:PROPERTIES:
:ID:       a1d20885-09fa-4aa8-8c03-06d92201b6b6
:END:
https://www.nature.com/articles/s41467-023-40012-7
**** Visualizations
:PROPERTIES:
:ID:       c0359d9c-246a-41fb-a9b4-05ea5cb546ab
:END:
- [[file:~/repos/biotools/biotools.org::*Bioinformatics visualizations][Bioinformatics visualizations]]
https://www.nature.com/articles/s41467-023-38407-7
*** Bioinformatics visualization
:PROPERTIES:
:ID:       DB8463CB-97CB-49E6-8EDD-A5ECA2F140BF
:END:
:LOGBOOK:
CLOCK: [2021-06-05 Sat 09:36]--[2021-06-05 Sat 09:39] =>  0:03
:END:
**** Unfiled
:PROPERTIES:
:ID:       367a6455-91d0-48c9-9b26-e5bc94b77316
:END:
https://www.nature.com/articles/s43018-023-00572-5
https://www.reddit.com/r/bioinformatics/comments/tgzeya/t_sne_graphs_for_data_visualization/
- ideogram /karyotye https://bioinformatics.stackexchange.com/questions/3600/how-to-make-chromosome-color-maps-for-bed-ranges
- GEDI SOMs https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1007034#sec002
- https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.252
- https://genviz.org/module-03-genvisr/0003/02/01/waterfall_GenVisR/
- upset
    - https://www.nature.com/articles/nmeth.3033
    - https://github.com/hms-dbmi/UpSetR
- https://cran.r-project.org/web/packages/chromoMap/vignettes/chromoMap.html#Data-based_annotation_plots
- https://sites.google.com/view/williamgilks/computational-analysis-of-whole-genome-sequencing-data/flow-chart-in-latex
- https://www.photopea.com/
- General reference
  - http://genviz.org/
- By content
  - pathvisio https://www.pathvisio.org/documentation/tutorials/tutorial-1/
  - svviz [[http://svviz.readthedocs.io/en/latest/install.html][documentation]]
  - https://genome.sph.umich.edu/wiki/LocusZoom_Standalone
  - http://miso.readthedocs.io/en/fastmiso/sashimi.html
  - https://www.fusioncharts.com/resources/chart-primers/radar-chart
  - https://github.com/Adrienrougny/sbgntikz/
- [[id:1DA3ABC0-79B0-4CED-B926-22B37840379D][LINK TO Data Visualization]]
  - Examples
    - https://cmdcolin.github.io/awesome-genome-visualization/
  - https://bioinfogp.cnb.csic.es/tools/venny/
- Experimental design [[./biotools.org_20220817_135339.png]]

https://www.sciencedirect.com/science/article/pii/S1074761320305045?via%3Dihub
- tikz sbgn diagrams: https://github.com/Adrienrougny/sbgntikz/
- https://www.reddit.com/r/bioinformatics/comments/chnt75/guidelines_for_workflow_visualization/
https://www.reddit.com/r/bioinformatics/comments/tgzeya/t_sne_graphs_for_data_visualization/
- ideogram /karyotye https://bioinformatics.stackexchange.com/questions/3600/how-to-make-chromosome-color-maps-for-bed-ranges
- GEDI SOMs https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1007034#sec002
- https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cpz1.252
- https://genviz.org/module-03-genvisr/0003/02/01/waterfall_GenVisR/
- upset
    - https://www.nature.com/articles/nmeth.3033
    - https://github.com/hms-dbmi/UpSetR
- https://cran.r-project.org/web/packages/chromoMap/vignettes/chromoMap.html#Data-based_annotation_plots
- https://sites.google.com/view/williamgilks/computational-analysis-of-whole-genome-sequencing-data/flow-chart-in-latex
- https://www.photopea.com/
- General reference
  - http://genviz.org/
- By content
  - pathvisio https://www.pathvisio.org/documentation/tutorials/tutorial-1/
  - svviz [[http://svviz.readthedocs.io/en/latest/install.html][documentation]]
  - https://genome.sph.umich.edu/wiki/LocusZoom_Standalone
  - http://miso.readthedocs.io/en/fastmiso/sashimi.html
  - https://www.fusioncharts.com/resources/chart-primers/radar-chart
  - https://github.com/Adrienrougny/sbgntikz/
- [[id:1DA3ABC0-79B0-4CED-B926-22B37840379D][LINK TO Data Visualization]]
  - Examples
    - https://cmdcolin.github.io/awesome-genome-visualization/
  - https://bioinfogp.cnb.csic.es/tools/venny/


**** Heatmaps
:PROPERTIES:
:ID:       a259c668-737b-4ca3-9994-a9ce8afa01db
:END:
- https://academic.oup.com/bioinformatics/article/32/18/2847/1743594?login=true
- https://slowkow.com/notes/pheatmap-tutorial/#quantile-breaks
- https://jokergoo.github.io/2020/05/06/translate-from-pheatmap-to-complexheatmap/
- https://slowkow.com/notes/pheatmap-tutorial/
- heatmaps
  - https://www.biostars.org/p/287512/
  - https://support.bioconductor.org/p/93424/
- https://jokergoo.github.io/2020/05/06/translate-from-pheatmap-to-complexheatmap/
- cite:lucas2020 fig3c
**** <<<Integrated Genomics Viewer>>> (<<<IGV>>>)
:PROPERTIES:
:ID:       917062AC-32E8-41F5-A511-84AA7B1504B0
:END:

- cite:robinson2017
https://www.france-bioinformatique.fr/sites/default/files/EBA/V3-2014/Elodie_Giraud_visualisation-IGV_TP_EBA-2014-10.pdf
[[http://software.broadinstitute.org/software/igv/UserGuide][User Guide]]

*** [[id:0f1f4aa4-c755-42ff-8f81-8a32c14293a0][Cell-free DNA (cfDNA) and circulating-tumor DNA (ctDNA)]]
*** Bioinformatics pipelines and project management and code
:PROPERTIES:
:ID:       eaa783cb-9d06-4763-9a28-b5cfe6c99825
:END:
- https://book.the-turing-way.org/project-design/pd-overview/pd-overview-planning
- https://www.reddit.com/r/bioinformatics/comments/1c88uoe/git_hooks_in_bioinformatics/
- cite:griffith2015
- https://www.reddit.com/r/bioinformatics/comments/1apn4f4/what_are_some_criteria_for_my_code_to_have_in_a/

- https://osf.io/4pd9n/
- https://www.reddit.com/r/bioinformatics/comments/12cb99z/what_are_some_good_examples_of_wellengineered/
- https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1000424
- http://byronjsmith.com/make-bml/
*** Chromatin profiling
:PROPERTIES:
:ID:       0bec21d1-cc38-4965-8bdf-fddbc803fffb
:END:
- https://bioconductor.org/packages/release/BiocViews.html#___ChIPSeq
*** Common bioinformatics file manipulation
:PROPERTIES:
:ID:       c0c0ee28-2e41-41a7-9a3b-ae195117a93e
:END:
coordinate sorted bams are typically smaller (i.e. more compressible) than name sorted
- https://bioinf.shenwei.me/seqkit/usage/#pair
- https://www.google.com/search?q=annotate+bed+file+with+gene+names
- https://biodbnet-abcc.ncifcrf.gov/db/db2db.php
- [[https://www.biostars.org/p/68283/][count total length of regions in bed file]]
- https://gatkforums.broadinstitute.org/gatk/discussion/6484/how-to-generate-an-unmapped-bam-from-fastq-or-aligned-bam
- https://www.biostars.org/p/247903/
- https://gatkforums.broadinstitute.org/gatk/discussion/2909/how-to-fix-a-badly-formatted-bam
- [[https://github.com/lh3/seqtk][seqtk]]
- https://gist.github.com/davfre/8596159
**** Subsetting and splitting
:PROPERTIES:
:ID:       383f3800-49b5-4752-a04f-9f3a4b8f266c
:END:
- Fastas
  - https://www.biostars.org/p/13270/
  - Fastqs
    - [[Question: Selecting Random Pairs From Fastq?]]
    - [[https://www.biostars.org/p/6544/][look at all the ways to split a fastq file!]]
- Bams
  - https://bioinformatics.stackexchange.com/questions/402/how-can-i-downsample-a-bam-file-while-keeping-both-reads-in-pairs
  - https://www.google.com/search?q=subset+bam+file
  - samtools view -bo subset.bam -s 123.4 alignments.bam chr1 chr2
  function SubSample {
  #+begin_src bash :tangle ./toosl/shell/subsample_bam.sh
function SubSample {
## Calculate the sampling factor based on the intended number of reads:
FACTOR=$(samtools idxstats $1 | cut -f3 | awk -v COUNT=$2 'BEGIN {total=0} {total += $1} END {print COUNT/total}')

if [[ $FACTOR > 1 ]]
  then
  echo '[ERROR]: Requested number of reads exceeds total read count in' $1 '-- exiting' && exit 1
fi

sambamba view -s $FACTOR -f bam -l 5 $1

}
#+end_src
**** Database downloads
:PROPERTIES:
:ID:       ea8da9fe-de63-454c-b78b-e2cf3ef4fae5
:END:
- https://www.google.com/search?q=download+genbank+fasta
*** DNA variants
:PROPERTIES:
:ID:       59c34386-54eb-4e6c-9f53-5f8317ef62ef
:END:
- https://gatk.broadinstitute.org/hc/en-us/articles/360035890431-The-logic-of-joint-calling-for-germline-short-variants

https://pubmed.ncbi.nlm.nih.gov/35311178/
**** DNA variants
:PROPERTIES:
:ID:       6ebfdc75-52f8-42e9-9f61-d66461453d16
:END:
https://pubmed.ncbi.nlm.nih.gov/35311178/
**** variant calling
:PROPERTIES:
:ID:       e55ec87d-6ef1-47d4-ae16-e051e92114bd
:END:
>>>>>>> bb11343ab3ff683a4ece1c261661becfbc0b872d
:PROPERTIES:
:CREATED:  [2020-06-22 Mon 12:27]
:ID:       a5b408eb-77e2-4634-a5bb-950cefaafe18
:END:
- [[id:57E81A44-3233-479B-8264-2CD5F1904A60][Sequence variation and variant calling]]
***** fusions
:PROPERTIES:
:ID:       0ea6c74e-bcf8-44c2-b4c3-e725d930d4a3
:END:
  - cite:melsted2017
****** Gene Fusion Detection
:PROPERTIES:
:ID:       492e0fad-ced4-407b-8913-80f3a0ac1202
:END:
:PROPERTIES:
:ID:       778C7C81-34E7-4BAE-94F9-5C33318BFDA5
>>>>>>> e60be068dcbc8c18477fc28e00ee3b742dcf0110
:END:
- [[https://github.com/jeszyman/rna-fusion][repository]]
- [ ] index script
- [ ] align script
- reference
  - https://www.nextflow.io/example4.html
  - gsnap example- - http://www.cureffi.org/2013/11/18/an-mrna-seq-pipeline-using-gsnap-samtools-cufflinks-and-bedtools/
  - https://github.com/genepattern/docker-tophat/blob/master/Dockerfile
  - https://github.com/broadinstitute/gtex-pipeline/blob/master/rnaseq/Dockerfile


********* NEXT INTEGRATE RNA aligners
:PROPERTIES:
:CREATED:  [2019-02-25 Mon 13:16]
:ID:       951F10BC-E844-45C5-8CB4-4FA8756D9F85
:END:

- are combined rna-seq alignment methods just sum of runs?
- cite:zhang2016a
- [-] install
  - [ ] cite:wu2016 in cite:mathe2016
  - [X] hisat2
  - [X] star
  - [X] tophat - but prefer don't use- "TopHat has entered a low maintenance, low support stage as it is now largely superseded by HISAT2" https://ccb.jhu.edu/software/tophat/index.shtml
- [-] create indexes
  - [-] star
  - [ ] hisat2 https://ccb.jhu.edu/software/hisat2/manual.shtml see hista2-build
  -

******** NEXT HCC1395 straight align and integrate and compare to published
:PROPERTIES:
:CREATED:  [2019-03-13 Wed 10:11]
:ID:       58F7BED2-DED1-4911-9E8C-104E12126A73
:END:
:LOGBOOK:
CLOCK: [2019-03-14 Thu 07:49]--[2019-03-14 Thu 08:45] =>  0:56
CLOCK: [2019-03-13 Wed 18:18]--[2019-03-13 Wed 19:54] =>  1:36
CLOCK: [2019-03-13 Wed 11:30]--[2019-03-13 Wed 12:00] =>  0:30
CLOCK: [2019-03-13 Wed 11:00]--[2019-03-13 Wed 11:01] =>  0:01
CLOCK: [2019-03-13 Wed 10:12]--[2019-03-13 Wed 10:47] =>  0:35
:END:
- log
  - from bam to fastq
    - by sample
      - tumor
        - ./sambamba-0.6.8-linux-static sort -n -o /gscmnt/gc2555/spencer/jeff/data/HCC1395-anmesort.bam /gscmnt/gc2555/spencer/jeff/data/gerald_C1TD1ACXX_8_ACAGTG.bam
        - samtools fastq -1 /gscmnt/gc2555/spencer/jeff/data/HCC1395_1.fastq -2 /gscmnt/gc2555/spencer/jeff/data/HCC1395_2.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395-anmesort.bam
      - moved all this to ~data/HCC1395/
      - normal
        - (integrate image, 64gb) sambamba sort -n -o /gscmnt/gc2555/spencer/jeff/data/HCC1395/normal-namesort.bam /gscmnt/gc2555/spencer/jeff/data/HCC1395/gerald_C2DBEACXX_3.bam
        - samtools fastq -1 /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_1.fastq -2 /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_2.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/normal.namesort.bam
        -
  - alignment
    - bsub -Is -q docker-interactive -R "select[ncpus >=4 && mem>64000] span[hosts=1] rusage[mem=64000]" -a 'docker(jeszyman/startest)' /bin/bash
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395_2.fastq --outSAMunmapped Within
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_2.fastq --outSAMunmapped Within
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-all_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-all_2.fastq --outSAMunmapped Within
  - integrate
    - bsub -q research-hpc -R "select[ncpus >=4 && mem>64000] span[hosts=1] rusage[mem=64000]" -a 'docker(jeszyman/integrate)' /bin/bash
    - prep each star output:
      -
      - sambamba view -S -o Aligned.out.bam Aligned.out.sam
      - sambamba sort Aligned.out.bam
      - sambamba index Aligned.out.sorted.bam
    - Integrate fusion /gscmnt/gc2555/spencer/jeff/data/reference/Homo_sapiens.GRCh38.dna.primary_assembly.fa /gscmnt/gc2555/spencer/jeff/data/reference/annot-hg38-refeseq.txt /gscmnt/gc2555/spencer/jeff/data/reference/Integrate/bwts /gscmnt/gc2555/spencer/jeff/dev/starhcc/Aligned.out.sorted.bam /gscmnt/gc2555/spencer/jeff/dev/starhcc/Aligned.out.sorted.bam
      -

***** Broad Calling variants in RNAseq
:PROPERTIES:
:ID:       DA64BC88-8BD6-40DF-9D80-5596BFA4D643
:END:

https://software.broadinstitute.org/gatk/documentation/article?id=3891
***** RNA-fusion                                                    :biopipe:
:PROPERTIES:
:CREATED:  [2019-06-25 Tue 09:05]
:ID:       96634f32-b19a-4390-8e50-e942abd35f90
:END:
:LOGBOOK:
CLOCK: [2019-07-09 Tue 09:19]--[2019-07-09 Tue 09:25] =>  0:06
CLOCK: [2019-07-02 Tue 08:20]--[2019-07-02 Tue 09:45] =>  1:25
CLOCK: [2019-06-27 Thu 08:50]--[2019-06-27 Thu 09:31] =>  0:41
CLOCK: [2019-06-27 Thu 08:17]--[2019-06-27 Thu 08:31] =>  0:14
CLOCK: [2019-06-26 Wed 13:35]--[2019-06-26 Wed 13:59] =>  0:24
:END:
- [[https://github.com/jeszyman/rna-fusion][repository]]
- [ ] index script
- [ ] align script
- reference
  - https://www.nextflow.io/example4.html
  - gsnap example- - http://www.cureffi.org/2013/11/18/an-mrna-seq-pipeline-using-gsnap-samtools-cufflinks-and-bedtools/
  - https://github.com/genepattern/docker-tophat/blob/master/Dockerfile
  - https://github.com/broadinstitute/gtex-pipeline/blob/master/rnaseq/Dockerfile

********* NEXT INTEGRATE RNA aligners
:PROPERTIES:
:CREATED:  [2019-02-25 Mon 13:16]
:ID:       951F10BC-E844-45C5-8CB4-4FA8756D9F85
:END:

- are combined rna-seq alignment methods just sum of runs?
- cite:zhang2016a
- [-] install
  - [ ] cite:wu2016 in cite:mathe2016
  - [X] hisat2
  - [X] star
  - [X] tophat - but prefer don't use- "TopHat has entered a low maintenance, low support stage as it is now largely superseded by HISAT2" https://ccb.jhu.edu/software/tophat/index.shtml
- [-] create indexes
  - [-] star
  - [ ] hisat2 https://ccb.jhu.edu/software/hisat2/manual.shtml see hista2-build
  -

******** NEXT HCC1395 straight align and integrate and compare to published
:PROPERTIES:
:CREATED:  [2019-03-13 Wed 10:11]
:ID:       58F7BED2-DED1-4911-9E8C-104E12126A73
:END:
:LOGBOOK:
CLOCK: [2019-03-14 Thu 07:49]--[2019-03-14 Thu 08:45] =>  0:56
CLOCK: [2019-03-13 Wed 18:18]--[2019-03-13 Wed 19:54] =>  1:36
CLOCK: [2019-03-13 Wed 11:30]--[2019-03-13 Wed 12:00] =>  0:30
CLOCK: [2019-03-13 Wed 11:00]--[2019-03-13 Wed 11:01] =>  0:01
CLOCK: [2019-03-13 Wed 10:12]--[2019-03-13 Wed 10:47] =>  0:35
:END:
- log
  - from bam to fastq
    - by sample
      - tumor
        - ./sambamba-0.6.8-linux-static sort -n -o /gscmnt/gc2555/spencer/jeff/data/HCC1395-anmesort.bam /gscmnt/gc2555/spencer/jeff/data/gerald_C1TD1ACXX_8_ACAGTG.bam
        - samtools fastq -1 /gscmnt/gc2555/spencer/jeff/data/HCC1395_1.fastq -2 /gscmnt/gc2555/spencer/jeff/data/HCC1395_2.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395-anmesort.bam
      - moved all this to ~data/HCC1395/
      - normal
        - (integrate image, 64gb) sambamba sort -n -o /gscmnt/gc2555/spencer/jeff/data/HCC1395/normal-namesort.bam /gscmnt/gc2555/spencer/jeff/data/HCC1395/gerald_C2DBEACXX_3.bam
        - samtools fastq -1 /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_1.fastq -2 /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_2.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/normal.namesort.bam
        -
  - alignment
    - bsub -Is -q docker-interactive -R "select[ncpus >=4 && mem>64000] span[hosts=1] rusage[mem=64000]" -a 'docker(jeszyman/startest)' /bin/bash
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395_2.fastq --outSAMunmapped Within
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_2.fastq --outSAMunmapped Within
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-all_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-all_2.fastq --outSAMunmapped Within
  - integrate
    - bsub -q research-hpc -R "select[ncpus >=4 && mem>64000] span[hosts=1] rusage[mem=64000]" -a 'docker(jeszyman/integrate)' /bin/bash
    - prep each star output:
      -
      - sambamba view -S -o Aligned.out.bam Aligned.out.sam
      - sambamba sort Aligned.out.bam
      - sambamba index Aligned.out.sorted.bam
    - Integrate fusion /gscmnt/gc2555/spencer/jeff/data/reference/Homo_sapiens.GRCh38.dna.primary_assembly.fa /gscmnt/gc2555/spencer/jeff/data/reference/annot-hg38-refeseq.txt /gscmnt/gc2555/spencer/jeff/data/reference/Integrate/bwts /gscmnt/gc2555/spencer/jeff/dev/starhcc/Aligned.out.sorted.bam /gscmnt/gc2555/spencer/jeff/dev/starhcc/Aligned.out.sorted.bam
      -

*** Epigenetics
:PROPERTIES:
:CREATED:  [2019-10-30 Wed 10:52]
:ID:       079e398f-e3b0-49c4-92da-9b4f6a73684c
:END:
- [[id:32afbe10-0469-4969-8b8e-1ee14b4101d2][Science of cardiac epigenetics]]
- cite:smith2017
- https://www.nature.com/articles/nature14248?error=cookies_not_supported&code=72ccf3be-3226-467c-b6a1-53bbfe374e27#Sec12
- https://www.illumina.com/destination/epigenetics-webinar-series.html

- [[id:8ca221b7-b51a-4382-9844-5d8ba7193ff6][Chromatin accessibility]]
- epigenetics
    - ATAC-seq for chromatin accessiblity
    - ChIP-seq
    - differential peak analysis-
      - epigen-specific tools DiffBind, MAnorm
      - uses RNA-seq tools for differential expression
    - peak-calling: identifying enriched signal from ATAC-seq and ChIP-seq, see cite:liu2019a ref 40
      - MACS/MACS2
      - measures of signal-to-noise by ENCODE
        - FRiP fraction of reads in peaks
        - cross-correlation profiles
    - methylation profiling
      - BSmooth
      - Merman
      - single cell
        - Minifi
      - bisulfite- unmethylated cytosines converted to uralcil, uracil converted to thyamine during amp- ratio T to C
      - methylcap-seq
      - differential peak
        - DiffBind
        - MAnorm
        - DBChIP
        - DAStk
      - Minfi
      - BSmooth
      - methylKit
      - mehtySig
      - metilene
**** ChIP-seq
:PROPERTIES:
:ID:       4c8cbcad-4523-4883-b041-a8eb548f01ac
:END:
https://www.reddit.com/r/bioinformatics/comments/1oi1u7e/help_needed_to_recreate_a_figure/

https://rockefelleruniversity.github.io/RU_ChIPseq/
https://github.com/crazyhottommy/ChIP-seq-analysis/blob/master/part2_Preparing-ChIP-seq-count-table.md
https://www.bioconductor.org/help/course-materials/2016/CSAMA/lab-5-chipseq/Epigenetics.html
http://www.guertinlab.org/vignettes/
- https://github.com/crazyhottommy/ChIP-seq-analysis
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5429005/
- https://nbisweden.github.io/workshop-archive/workshop-ChIP-seq/2018-11-07/
https://github.com/crazyhottommy/ChIP-seq-analysis
**** [[id:22e31d06-f5df-427e-bd70-3a2ccd3f47ec][ATAC-seq]]
:PROPERTIES:
:ID:       adc0ec08-2d05-4d18-a451-65554efc74bb
:END:
**** Methylation sequencing                                         :biopipe:
:PROPERTIES:
:CREATED:  [2019-05-29 Wed 14:46]
:ID:       b8db46d3-8329-4fef-82b1-4d99c2c9312b
:END:
- https://www.illumina.com/science/sequencing-method-explorer/kits-and-arrays/medip-seq-dip-seq.html
- cite:shen2018
- cite:giacopelli2021prostate
- cite:liu2020
- https://www.nature.com/articles/s41591-020-0933-1
- https://www.nature.com/articles/nm.4045
- [[id:6ad7cfcb-1e8b-4d72-b18a-40f80a00f242][nih liq biopsy]] see [2021-01-26 Tue]
- "All the cell line datasets generated during and/or analysed during the current study are available in the GEO repository under accession code GSE79838. The
- cfMeDIP-seq NGS data for patient samples that support the findings of this study are available upon request from the corresponding author (D.D.C) to comply with
- to add
  - R
    - MethylKit
    - DESeq2
    - caret
    - minfi
    - Rtsne
  - SAMtools
  - Bowtie
  - MEDIPS
  - BWA
  - GATK IndelRealigner
  - MuTect
  - TrimGalore
  - Bismark6
  - Bowtie
  -
- from cite:shen2018
  - "The generated SAM files from hg19 alignment were converted to BAM format, ensuring the removal of duplicate reads, and the reads were then sorted and indexed using SAMtools21 before subsequent analysis with the R package MEDIPS22. The CpG enrichment score, as a quality control measure for the immunoprecipitation reaction, was calculated as part of the MEDIPS package."
  - Shell scripts were used to process MeDIP sequencing data to produce RPKM estimates for downstream analysis. Custom R scripts with a collection of R/Bioconductor packages were used to analyse the resulting dataset. The code used for analysis is available in the form of R markdowns deposited onto Zenodo as detailed in Supplementary Table 13.
  -
  | Description                                                                                    | Zenodo DOI for Data    | Zenodo DOI for Code    |
  | <25>                                                                                           | <25>                   | <25>                   |
  | IHEC Figure                                                                                    | 10.5281/zenodo.1205714 |                        |
  | Simulations                                                                                    | 10.5281/zenodo.1205730 | 10.5281/zenodo.1205728 |
  | Extended Data Fig. 6 violin plots                                                              | 10.5281/zenodo.1205744 | 10.5281/zenodo.1205735 |
  | Bed file of genomic windows that contain CpGs                                                  | 10.5281/zenodo.1205752 |                        |
  | TCGA and COSMIC tSNEs                                                                          | 10.5281/zenodo.1205754 |                        |
  | Machine learning                                                                               |                        | 10.5281/zenodo.1242697 |
  | Markdown with ensemble of non-machine learning scripts including Extended Data Fig. 6 heatmaps |                        | 10.5281/zenodo.1205756 |
  | Stand alone scripts called by non-machine learning markdown                                    |                        | 10.5281/zenodo.1205746 |
-
- Open source code/packages used for data analysis: R, SAMtools (v. 1.3.1), Bowtie (v. 0.12.9), MEDIPS (v. 1.22.0), BWA (v. 0.7.1220),
- Genome Analysis ToolKit (GATK) IndelRealigner, MuTect (v.1.1.5) , Trim Galore! (v. 0.4.4), Bismark (v. 0.10.1), Bowtie2 (v. 2.0.5),
- MethylKit (v 0.99.2), DESeq2 (v. 1.4.5), caret R package, minfi bioconductor package, Rtsne

***** Bisulfite sequencing
:PROPERTIES:
:ID:       8ffda4e0-8a03-4fa3-aa0d-56c2e6a1dca4
:END:
  - methylation protects/blocks cytosine conversion to uracil
  - PCR amp can produce forward/reverse with and without bisulfite block
  - BSMAP, Bismark, BWA-meth, biscuit
  - VCF > bedgraph > bigwig > IGV
  - metilene segments methylation
  - visualization
    - heatmap
    - canyon plot- methylation proportion vs distance from target locus

**** protein-DNA interactions
:PROPERTIES:
:CREATED:  [2021-01-18 Mon 09:45]
:ID:       b612a1b1-2c01-49c3-a20c-5a890fa1a6e5
:END:
- cut and run - https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6302505/
  - cite:bakhoum2021
**** transcription factor enrichment
:PROPERTIES:
:ID:       809e1a39-2a8e-46ec-863c-d7b03511fcfb
:END:
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4009616/
- https://science.sciencemag.org/content/352/6288/aad3018
- motif-based- high false pos
- benchtop with ChIP-seq
**** Chromatin accessibility profiling
:PROPERTIES:
:ID:       ae0363f3-379e-4521-9184-cbc0d46501cd
:END:
- cite:minnoye2021
- [[id:8ca221b7-b51a-4382-9844-5d8ba7193ff6][Chromatin accessibility biology]]
- [[id:22e31d06-f5df-427e-bd70-3a2ccd3f47ec][ATAC-seq]]
- [[id:17f978bc-f2f2-497d-a8f1-b1d47927380f][Differential chromatin accessibility]]
- chromhhm track annotation
  - https://genome.ucsc.edu/cgi-bin/hgTrackUi?db=mm10&g=encode3RenChromHmm
  - http://enhancer.sdsc.edu/enhancer_export/ENCODE/chromHMM/pooled/
***** Region or locus-based enrichment analysis
:PROPERTIES:
:ID:       12393aa3-d318-4ba6-8183-6e3a175d3ba4
:END:
- GREAT http://bejerano.stanford.edu/great/public/html/index.php
- Lola
  - https://academic.oup.com/bioinformatics/article/32/4/587/1743969
  - https://bioconductor.org/packages/release/bioc/vignettes/LOLA/inst/doc/usingLOLACore.html
***** Chromatin accessibility profiling methods
:PROPERTIES:
:ID:       f600cd95-723e-4893-8b3f-0634d8905920
:END:
- cite:minnoye2021
- [[id:22e31d06-f5df-427e-bd70-3a2ccd3f47ec][ATAC-seq]]
- [[id:8ca221b7-b51a-4382-9844-5d8ba7193ff6][Chromatin accessibility]]
****** Chromatin accessibility profiling methods
:PROPERTIES:
:ID:       832d2728-0e62-470d-b075-e7cfc6141dd6
:END:

https://www.nature.com/articles/s41588-018-0091-2
************* Chemical- NextBio, see Webster,15ref Kupershmidt,10
:PROPERTIES:
:ID:       f9f486c9-cd9b-401a-a3c0-523a5d09d92b
:END:
  - extracellular
    - https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5426982/
  - stranded
    - https://www.ecseq.com/support/ngs/how-do-strand-specific-sequencing-protocols-work
  - ffpe
    - cite:kashofer2013
    - FFPE Pre-analytic variability
      - cite:ahlfen2007rnaqual
        - storage conditions
        - cold ischemia time
        - fixation
          - type
          - time
        - sample thickness
      - biospecimens.cancer.gov/researchnetwork
      - cite:unlockingQiagen
      - https://www.ncbi.nlm.nih.gov/pubmed/25357115
      - By effect
        - Yield
          - - prolonged fix reduces yield- Bresters D, Schipper ME, Reesink HW, Boeser-Nunnink BD, Cuypers HT. The duration of fixation influences the yield of HCV cDNA-PCR products from formalin-fixed, paraffin- embedded liver tissue. J Virol Methods 1994;48:267–72.
          - cite:webster2015mining longer fixation times decrease RNA yields from paraffin-embedded tissues (herein 3 weeks in formalin resulted in half the RNA yield/sec- tion compared with 18 h) and increase RNA input needed during library preparation (see methods). This latter effect is likely due to ‘non-functional’ RNA (eg, adducts or damaged bases) that could be potentially mitigated by treatments like PreCR or other enzymatic and chemical methods.
        - At microarray expression
          - cite:kashofer2013quality
      - "Formalin fixation introduced major changes into microarray gene expression data and led to marked gene-to-gene variations in delta-ct values of qRT-PCR. We found that qRT-PCR efficiency and gene-to- gene variations were mainly attributed to differences in the efficiency of cDNA synthesis as the most sensitive step. These differences could not be reliably detected by quality assessment of total RNA isolated from formalin-fixed tissues by electrophoresis or spectrophotometry. "
      - At sequencing
    - cite:graw2015
    - Past expression tech
      - goals were biomarker discovery and patient stratification
      - cite:Zhao_2014 manifests its superiority in terms of the dynamic range, sampling depth, and has independence from pre-existing sequence information [1,2].
      - cite:webster2015mining When compared with conventional DNA microarrays, RNA-seq enriches for many additional fragments as it is not restricted to predefined probes and has (in principle) no limitations to dynamic range (Li et al., 2014b; SEQC/MAQC-III Consortium, 2014).
      - - https://www.ncbi.nlm.nih.gov/pubmed/14695316
      - - [[https://www.ncbi.nlm.nih.gov/pubmed/15509548][DASL]]
      - https://www.ncbi.nlm.nih.gov/pubmed/21347257
    - FFPE microarray and RT-PCR was useful
      - AlloMap is a non-invasive gene expression-based blood test that is used to manage the clinical care of heart transplant recipients, providing a quantified score for the risk of rejection based on the measurement of expression of 20 genes, a subset of which are related to immune system activation and signalling15,16.
      - - cite:penland2007rna
      - - - https://www.ncbi.nlm.nih.gov/pubmed/11568892/
      - Mittempergher, L., de Ronde, J.J., Nieuwland, M., Kerkhoven, R.M., Simon, I., Th Rutgers, E.J., Wessels, L.F., Van't Veer, L.J., 2011. Gene expression profiles from formalin fixed paraffin embedded breast cancer tissue are largely comparable to fresh fro- zen matched tissue. PLoS One 6, e17163.
    - But this expression tech is inferior
      - In other work14, systematic evalu- ation of RNA-seq-based and microarray-based classifiers found that RNA-seq outperformed arrays in characteriz- ing the transcriptome of cancer and performed similarly to arrays in clinical endpoint prediction.
      - does not depend on genome annotation, or on predesigned species-specific or tran- script-specific probes, for transcript measurement.
      - microarray limited application to clinic- lthough powerful, microarray-based assays can have limitations in some environments, such as those related to laboratory-to-laboratory variation in sample preparation that can affect reproducibility. Moreover, for some applications, microarray signal-to-noise ratios can affect the limit of detection. Interestingly, a number of additional cancer multi-gene profile tests are clinically available, such as OncoTypeDX (Genome Health)135 for breast cancer recurrence risk and Prolaris (Myriad)136 for prostate cancer aggressiveness. These tests are based on qRT-PCR technologies, rather than microarrays, largely owing to the belief that qRT-PCR is more reliable, reproducible, sensitive and accurate.
      - " qRT-PCR is generally deemed the ‘gold standard’ method for measuring transcript levels, particularly in the clinical space; however, there are a number of limitations, including the fact that although it is a high sample throughput technology, relatively few markers or measurements can be made in a single assay. "
      - rnaseq superior for
        - snvs
        - indels
        - isoforms
        - splice vars
        - chimerics
          - fusions
      - semiquan
      - no SNV discovery
      - no fusion
      - "RNA-seq provides much more detailed information on specific transcript expression patterns in clinico-genetic neuroblastoma subgroups than microarrays. " cite:zhang2015comparison
  - small RNA sequencing
    - sample processing
      - circulating miRNA stability
        - serum cite:gautam2016
        - plasma  cite:glinge2017
    - library preparation
      - with low input, use same kit for reproducibility cite:yeri2018
      - cite:dard-dascot2018
    - https://rnajournal.cshlp.org/content/18/6/1279.long
    - qc
      - https://www.agilent.com/en/product/automated-electrophoresis/bioanalyzer-systems/bioanalyzer-rna-kits-reagents/bioanalyzer-small-rna-analysis-228257#howitworks
  - single cell
    - https://www.biorxiv.org/content/biorxiv/early/2019/02/05/541433.full.pdf
    - examples
      - - see fig 3 & methods https://genome.cshlp.org/content/27/2/208.full.pdf
    - https://www.nature.com/articles/s41587-020-0553-9
    - 10x
      - applications - https://pages.10xgenomics.com/nur-gen-research-area-literature.html?src=email&utm_medium=email&lss=nurture&utm_source=nurture&cnm=es-nurture-ra_g-general&utm_campaign=es-nurture-ra_g-general&utm_content=&utm_term=&useroffertype=marketing-literature&userresearcharea=ra_g&userregion=&userrecipient=customer&mktouserid=1265915&cid=&usercampaignid=
    - https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0212031
    - http://www.nature.com/nbt/journal/v34/n2/full/nbt.3445.html
  - Clinical applications of RNA-seq
    - cite:byron2016translating
    - cite:Kalari_2014
    - cite:Van_Keuren_Jensen_2014
  - deconvolution
    - tools
      - ISOpure
        - https://link.springer.com/article/10.1186/s12859-015-0597-x#Sec1
    - cite:newman2015
  - time course
    - cite:spies2017
    - https://support.bioconductor.org/p/65676/#66860
    - https://www.biostars.org/p/138988/
    - https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#group-specific-condition-effects-individuals-nested-within-groups
    - https://hbctraining.github.io/DGE_workshop/lessons/08_DGE_LRT.html
    - http://seqanswers.com/forums/showthread.php?t=64039
    - https://www.sciencedirect.com/science/article/pii/S2001037015000392
- [[*cell enumeration through bulk RNA-seq][cell enumeration through bulk RNA-seq]]
- https://www.rna-seqblog.com/optimization-of-mirna-seq-data-preprocessing/
- [[id:e4351ef3-6d41-4121-a2cc-c63d89f997ac][pathway analysis]]
- [[id:2bbeb644-af54-4f07-80ad-3584e1e21b04][single-cell RNA sequencing (scRNA-seq)]]
- [[id:57E81A44-3233-479B-8264-2CD5F1904A60][Sequence variation and variant calling]]


- [[*omics integration][omics integration]]
************* Allele-specific Expression
:PROPERTIES:
:ID:       96C367A3-FEEB-4F6F-975A-A08A172FD277
:END:


************* RNA-fusion                                            :biopipe:
:PROPERTIES:
:CREATED:  [2019-06-25 Tue 09:05]
:ID:       96634f32-b19a-4390-8e50-e942abd35f90
:END:
:LOGBOOK:
CLOCK: [2019-07-09 Tue 09:19]--[2019-07-09 Tue 09:25] =>  0:06
CLOCK: [2019-07-02 Tue 08:20]--[2019-07-02 Tue 09:45] =>  1:25
CLOCK: [2019-06-27 Thu 08:50]--[2019-06-27 Thu 09:31] =>  0:41
CLOCK: [2019-06-27 Thu 08:17]--[2019-06-27 Thu 08:31] =>  0:14
CLOCK: [2019-06-26 Wed 13:35]--[2019-06-26 Wed 13:59] =>  0:24

http://101.datascience.community/tag/octave/
http://www.cbioportal.org/cgds_r.jsp
https://precision.fda.gov/
http://www.russpoldrack.org/?m=1
https://www.biostars.org/u/3737/
https://bioinformatics.ca/workshops/2014/informatics-rna-sequence-analysis-bc-2014
[[https://www.bioconductor.org/help/course-materials/][Bioconductor courses and conferences]]
[[https://www.ebi.ac.uk/training/online/course/embo-practical-course-analysis-high-throughput-seq/introduction-r-and-bioconductor][EMBO introduction to R and Biocinductor]]
[[https://www.edx.org/course/introduction-bioconductor-annotation-harvardx-ph525-5x][edX Intro to bioconductor]]
[[https://www.edx.org/course/high-dimensional-data-analysis-harvardx-ph525-4x][edX high-dimensional data analysis]]
[[https://www.coursera.org/learn/bioconductor][coursera bioconductor for genomic data science]]
http://bcb.dfci.harvard.edu/~aedin/courses/Bioconductor/

https://www.bioconductor.org/packages/devel/bioc/vignettes/SummarizedExperiment/inst/doc/SummarizedExperiment.html

************ Gene Set Enrichment
:PROPERTIES:
:ID:       87734999-3139-4343-A323-925416811B12
:END:
https://www.pathwaycommons.org/guide/primers/data_analysis/gsea/#:~:text=The%20GSEA%20enrichment%20score%20(S,sets%20one%20at%20a%20time.
- https://www.reddit.com/r/bioinformatics/comments/66374x/gsea_vs_go_enrichment/

************* [[http://www.bioconductor.org/packages/release/bioc/html/gage.html][GAGE]] (generally applicable gene-set enrichment for pathway analysis)
:PROPERTIES:
:ID:       441F7686-9969-4F8D-8092-C4429377214C
:END:

[[file:~/Box%20Sync/comp_bio/gsea_template/][Folder]]
[[file:~/Box%20Sync/comp_bio/gsea_template/gage.pdf][Manual]]
[[file:~/Box%20Sync/comp_bio/gsea_template/gsea_template.R][Rscript]]

************** RNA-Seq Workflow Example
:PROPERTIES:
:ID:       B687F931-3A5E-4CD0-B2B7-30DF026E0AB9
:END:

[[file:~/Box%20Sync/comp_bio/gsea_template/][Folder]]
[[file:~/Box%20Sync/comp_bio/gsea_template/RNA-seqWorkflow.pdf][pdf]]


************** RNA-Seq Workflow Example
:PROPERTIES:
:ID:       B687F931-3A5E-4CD0-B2B7-30DF026E0AB9
:END:

[[file:~/Box%20Sync/comp_bio/gsea_template/][Folder]]
[[file:~/Box%20Sync/comp_bio/gsea_template/RNA-seqWorkflow.pdf][pdf]]

************* Commercial
:PROPERTIES:
:ID:       417416B5-0169-41CA-8FCE-4D6E440C7E3A
:END:

http://www.ingenuity.com/
[[http://genome.ucsc.edu/cgi-bin/hgTables?command=start][create your own GTF]]
[[http://bedops.readthedocs.io/en/latest/index.html][BEDOPS]]
https://www.datacamp.com/

************ Genotype-Phenotype Associations
:PROPERTIES:
:ID:       69F82D91-6DE6-4332-AD0A-7ADF25263858
:END:

https://www.nature.com/articles/s41467-019-11591-1
- cite:stuart2019
[[id:992de4dc-775e-41f0-a70a-e38c99b87265][Single cell methylation sequencing]]
https://www.reddit.com/r/bioinformatics/comments/uy9g1j/where_to_start_with_scrnaseq_data/
https://www.embopress.org/doi/full/10.15252/msb.20188746
- cite:storrs2022
- https://bioengineeringcommunity.nature.com/posts/dialogue-maps-multicellular-programs-in-tissue-from-single-cell-or-spatial-transcriptomics-data
https://www.nature.com/articles/nmeth.4612
https://satijalab.org/signac/articles/peak_calling.html
https://www.nature.com/articles/s41467-021-21583-9#Sec2
https://mobile.twitter.com/nomad421/status/1522554692202598403?s=20&t=UObG4oqigCp6gJIIgmyhPA
- https://www.sciencedirect.com/science/article/pii/S1097276516301861?via%3Dihub
***** ATAC-seq
:PROPERTIES:
:ID:       22e31d06-f5df-427e-bd70-3a2ccd3f47ec
:END:
****** [[id:6ca433ff-59ed-4f60-889f-c43e1f945064][Part of Cis-regulatory elements]]
:PROPERTIES:
:ID:       6f47e67b-fd75-44e2-909c-44936ea4f226
:END:
****** [[id:4de39606-9232-4cfc-b444-f4a27e577862][Spatial ATAC-seq]]
:PROPERTIES:
:ID:       0b97438b-d187-474f-b28e-a2598107a74a
:END:
****** Method-establishing papers
:PROPERTIES:
:ID:       63465d15-73fe-455a-b19e-4de8efd7b563
:END:
- cite:buenrostro2015
- cite:corces2017
****** Method guides, tutorials, and good practice
:PROPERTIES:
:ID:       ac3e4bfa-e8f2-4de5-b546-6e22af3bbad9
:END:
- https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/cphg.101
- https://fonseca.lab.mcgill.ca/resources/20220810_ATAC_Analysis_Demo/guide.html
- https://rockefelleruniversity.github.io/RU_ATAC_Workshop.html
- https://github.com/maxplanck-ie/snakepipes/tree/master/snakePipes/workflows/ATAC-seq
- cite:reske20s20
  - https://github.com/reskejak/ATAC-seq
- https://github.com/crazyhottommy/pyflow-ATACseq/blob/master/Snakefile
- https://www.sciencedirect.com/science/article/pii/S2666166720302768
- http://www.guertinlab.org/vignettes/
- https://github.com/epigen-UCSD/atac_seq_pipeline/blob/master/pipeline.md
- https://www.hdsu.org/chipatac2020/04_CHIP_Alignment.html
- https://informatics.fas.harvard.edu/atac-seq-guidelines.html
- pipeline graphic https://epigeneticsandchromatin.biomedcentral.com/articles/10.1186/s13072-020-00342-y/figures/4
- cite:yan2020atac
- cite:corces2017
- [[https://informatics.fas.harvard.edu/atac-seq-guidelines.html][Harvard FAS]]
- [[https://www.scopus.com/results/results.uri?cc=10&sort=cp-f&src=s&nlo=&nlr=&nls=&sid=e3c13d36864e217e2edcf12df7a64b0a&sot=b&sdt=b&sl=59&s=%28TITLE-ABS-KEY%28atac-seq%29+AND+TITLE-ABS-KEY%28bioinformatics%29%29&ss=cp-f&ps=r-f&editSaveSearch=&origin=resultslist&zone=resultslist][scopus atac-seq bioinformatics (42)]]
- https://snakepipes.readthedocs.io/en/latest/content/workflows/ATAC-seq.html
- https://bcbio-nextgen.readthedocs.io/en/latest/contents/atac.html
- https://rockefelleruniversity.github.io/RU_ATAC_Workshop.html
- https://www.illumina.com/techniques/popular-applications/epigenetics/atac-seq-chromatin-accessibility.html
- http://biocworkshops2019.bioconductor.org.s3-website-us-east-1.amazonaws.com/page/ATACseqQCWorkshop__ATACseqQC_workshop/
- cite:minnoye2021
- https://www.encodeproject.org/atac-seq/
- https://yiweiniu.github.io/blog/2019/03/ATAC-seq-data-analysis-from-FASTQ-to-peaks/
- https://rockefelleruniversity.github.io/RU_ATACseq/
- cite:sun2019atac
- https://training.galaxyproject.org/training-material/topics/epigenetics/tutorials/atac-seq/tutorial.html
- https://nf-co.re/atacseq/1.1.0/output
- https://yiweiniu.github.io/blog/2019/03/ATAC-seq-data-analysis-from-FASTQ-to-peaks/
- https://github.com/nf-core/atacseq/blob/master/main.nf
- [[https://www.scopus.com/results/results.uri?sort=plf-f&src=s&sid=1b5013f3a0a4db522d602fa164281aa0&sot=a&sdt=a&cluster=scopubyr%2c%222021%22%2ct%2c%222020%22%2ct%2c%222019%22%2ct%2c%222018%22%2ct%2c%222017%22%2ct%2c%222016%22%2ct&sl=262&s=TITLE-ABS-KEY%28atac-seq%29+AND+NOT+TITLE-ABS-KEY%28chip%29+AND+NOT+DOI%2810.1016%2fj.cell.2017.12.014%29+AND+NOT+DOI%2810.1016%2fj.molmet.2016.01.002%29+AND+NOT+DOI%2810.1038%2fnature23283%29+AND+NOT+DOI%2810.1038%2fnature18606%29+AND+NOT+TITLE-ABS-KEY%28single-cell%29+AND+NOT+TITLE-ABS-KEY%28Hi-C%29&origin=searchadvanced&editSaveSearch=&txGid=38c8cceffee3c655f632c5736cf123cd][top atac-seq cites w/ good methods writeup]]
  - https://www.pnas.org/content/114/13/E2776
  - https://science.sciencemag.org/content/sci/suppl/2018/10/24/362.6413.eaav1898.DC1/aav1898_Corces_SM.pdf
  - https://ars.els-cdn.com/content/image/1-s2.0-S1074761316304393-mmc1.pdf
- https://link.springer.com/article/10.1186/s43556-020-00009-w
****** Bench DNA prep
:PROPERTIES:
:ID:       1763ea25-2549-42cb-8e82-1ae75f16e8cb
:END:
- cite:corces2017
- cite:buenrostro2015
- cite:buenrostro2015
- for tissue
  - cite:corces2017
****** [[id:fe58011b-ca46-4e45-9c4e-d4780fbfa115][Quality control]]
:PROPERTIES:
:ID:       bd5dd444-97a3-4d68-8ca6-ee280a1f40d4
:END:
****** Alignment parameters
:PROPERTIES:
:ID:       58427994-f886-406e-b6cc-714369d1f18d
:END:
  - https://www.nature.com/articles/ng.3844#Sec14https://www.sciencedirect.com/science/article/pii/S1074761316304393?via%3Dihub#mmc1
  - https://www.pnas.org/content/114/13/E2776
  - https://informatics.fas.harvard.edu/atac-seq-guidelines.html#alignments
  - https://ars.els-cdn.com/content/image/1-s2.0-S1074761316304393-mmc1.pdf
- Devon recommending filtering to 120 bp or lower  https://www.biostars.org/p/447927/
****** [[id:1c56c6ad-e0f8-47db-8d69-3782b7ed1e8b][Peak calling]]
:PROPERTIES:
:ID:       67b35a91-7cb9-4678-8535-051d9d1a4a54
:END:
****** Peak annotation
:PROPERTIES:
:ID:       e9969a6a-eb30-45e1-9d6d-1bb0127bc517
:END:
- [[id:a4cf29e3-7fa6-4ea2-a538-f59ec450cc7b][ChIPseeker]]
****** [[id:17f978bc-f2f2-497d-a8f1-b1d47927380f][Differential chromatin accessibility]]
:PROPERTIES:
:ID:       ff239bdd-fe86-4e82-bd16-e47e48c998ad
:END:
****** Data integration
:PROPERTIES:
:ID:       598d059a-8986-4dc4-a240-b24b12a499be
:END:
https://www.nature.com/articles/s41590-019-0312-6/figures/2
- Integration
  - atac-seq and mirna-seq https://www.sciencedirect.com/science/article/pii/S193459091730320X?via%3Dihub
  - ATAC-seq and miRNA-seq cite:abernathy2017
****** Footprinting
:PROPERTIES:
:ID:       29f42466-d0f0-457e-89d6-9bb0c4cd5bf9
:END:
- https://github.com/Zhang-lab/ATAC-seq_QC_analysis/blob/master/documents/ifr_documentation.md
- cite:bentsen2020
  - https://github.com/loosolab/TOBIAS
- cite:vierstra2020
#+begin_src R
source("./src/setup.R")
dataDIR = file.path("/mnt/ris/jschwarz/cardiac-radiobiology")
peaks = dir(file.path(dataDIR,"macs2"), pattern = "*narrowPeak", full.names = T)


if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("ChIPQC")
library(ChIPQC)

peaks_range = lapply(peaks, ChIPQC:::GetGRanges, simple = TRUE)

peaks_range = GRangesList(peaks_range)
peaks_range

names(peaks_range) = c("ir_m01.1",
                       "ct_f02.1",
                       "ct_f03.1",
                       "ir_m03.1",
                       "ct_m01.1",
                       "ir_f04.1",
                       "ir_f02.1")

seqlevelsStyle(peaks_range) = "UCSC"

peaks_range

peakCombo = groupByOverlaps(peaks_range)

class(peakCombo)

group = factor(c("ir","ct","ct","ir","ct","ir","ir"))
peaks_range$group = group








reduced = reduce(unlist(peaks_range))

reduced

consensusIDs <- paste0("consensus_", seq(1, length(reduced)))

mcols(reduced) <- do.call(cbind, lapply(peaks_range, function(x) (reduced %over% x) + 0))

reducedConsensus <- reduced
mcols(reducedConsensus) <- cbind(as.data.frame(mcols(reducedConsensus)), consensusIDs)
consensusIDs <- paste0("consensus_", seq(1, length(reducedConsensus)))
return(reducedConsensus)

reducedConsensus


names(reducedConsensus) = c("ir_m01.1",
                       "ct_f02.1",
                       "ct_f03.1",
                       "ir_m03.1",
                       "ct_m01.1",
                       "ir_f04.1",
                       "ir_f02.1")

group = factor(c("ir","ct","ct","ir","ct","ir","ir"))
reducedConsensus$group = group
reducedConsensus

if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("soGGi")

library(soGGi)

consensusToCount = soGGi:::runConsensusRegions(GRangesList(reducedConsensus), "none")


consensusToCount
#+end_src

#+begin_src R
source("./src/setup.R")
dataDIR = file.path("/mnt/ris/jschwarz/cardiac-radiobiology")
peaks = dir(file.path(dataDIR,"macs2"), pattern = "*narrowPeak", full.names = T)


if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("ChIPQC")
library(ChIPQC)

peaks_range = lapply(peaks, ChIPQC:::GetGRanges, simple = TRUE)

peaks_range = GRangesList(peaks_range)
peaks_range

names(peaks_range) = c("ir_m01.1",
                       "ct_f02.1",
                       "ct_f03.1",
                       "ir_m03.1",
                       "ct_m01.1",
                       "ir_f04.1",
                       "ir_f02.1")

seqlevelsStyle(peaks_range) = "UCSC"

peaks_range

peakCombo = groupByOverlaps(peaks_range)

class(peakCombo)

group = factor(c("ir","ct","ct","ir","ct","ir","ir"))
peaks_range$group = group








reduced = reduce(unlist(peaks_range))

reduced

consensusIDs <- paste0("consensus_", seq(1, length(reduced)))

mcols(reduced) <- do.call(cbind, lapply(peaks_range, function(x) (reduced %over% x) + 0))

reducedConsensus <- reduced
mcols(reducedConsensus) <- cbind(as.data.frame(mcols(reducedConsensus)), consensusIDs)
consensusIDs <- paste0("consensus_", seq(1, length(reducedConsensus)))
return(reducedConsensus)

reducedConsensus


names(reducedConsensus) = c("ir_m01.1",
                       "ct_f02.1",
                       "ct_f03.1",
                       "ir_m03.1",
                       "ct_m01.1",
                       "ir_f04.1",
                       "ir_f02.1")

group = factor(c("ir","ct","ct","ir","ct","ir","ir"))
reducedConsensus$group = group
reducedConsensus

if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("soGGi")

library(soGGi)

consensusToCount = soGGi:::runConsensusRegions(GRangesList(reducedConsensus), "none")


consensusToCount
#+end_src

****** Motifs
:PROPERTIES:
:ID:       87d51e34-9093-4d0d-b90f-14c620ecafb2
:END:
- [[./biotools.org_20220906_122531.png]]
- Motif analysis
  - cite:minnoye2021
  - homer
    - https://www.biostars.org/p/493498/
  - https://rockefelleruniversity.github.io/RU_ATACseq/
    - https://rockefelleruniversity.github.io/RU_ATACseq/presentations/singlepage/RU_ATAC_part3.html
  - cite:yan2020atac
  - https://ccg.epfl.ch/pwmtools/pwmscan.php
  - https://meme-suite.org/meme/
  - example of homer-jaspar method https://www.sciencedirect.com/science/article/pii/S1535610817302040?via%3Dihub
  - cite:sun2019atac
****** Identifying transcription factor binding sites
:PROPERTIES:
:ID:       f2e74bdb-b021-4413-99e9-90ade9a529d4
:END:
- https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1642-2
****** Tables
:PROPERTIES:
:ID:       6a5a2db5-04fc-4c92-a8d4-5d6e463313f4
:END:
- [[https://gdc.cancer.gov/about-data/publications/ATACseq-AWG][outputs example]]
****** [[id:12393aa3-d318-4ba6-8183-6e3a175d3ba4][Region or locus-based enrichment analysis]]
:PROPERTIES:
:ID:       95bc323e-0e25-4854-8c60-ab1270fb4d74
:END:
****** Visualizations / figures                                      :scifig:
:PROPERTIES:
:ID:       2525452c-c930-43e4-9547-a14a9d247e78
:END:
- highlight visualizations on ucsc or igv
  - dump beds and narrowpeaks directly into ucsc
    - https://genome.ucsc.edu/cgi-bin/hgCustom
    - https://groups.google.com/a/soe.ucsc.edu/g/genome/c/JzQtbjGbTnc
  - http://www.guertinlab.org/wp-content/uploads/2021/05/Genomic_ATAC-seq_analysis_190912.pdf
  - https://www.biostars.org/p/365263/
  - https://genome.ucsc.edu/goldenPath/help/bigWig.html
- tf or tf-group specific workup
  - motif position vs condition
    - file:resources/monroe2019fig4d.png
  - motif vs condition
    - [[file:resources/monroe2019fig4c.png]]
  - - TSS distance map- maybe easy in chipseeker?
- https://nf-co.re/atacseq/1.1.0/output
- atac vs expression signal
  - 2d heatmap [[file:resources/wang2018amdfig4e.png]]
- 3-state location-specific normalized counts
  - [[file:resources/wang2018amdfig2a.png]]
- Differential peak matrix
  - [[file:resources/wang2018amdfig2b.png]]
- global accessibility change
  - bar graph of counts of peak change cite:wang2018amd fig3d
  - line graph of signal intensity through time cite:wang2018 fig3e
  - cite:wang2018amd fig2d
    - [[file:resources/wang2018amdfig2d.png]]
- accessibility difference at gene
  - cite:wang2018amd fig2a
- peak heatmaps
  - cite:wang2018amd fig1c
- peak annotation across cohorts
  - [[./biotools.org_20220906_113352.png]] cite:merrill2022 fig1D
- annotation correlation to gene expression
  - [[./biotools.org_20220906_113853.png]] cite:merrill2022 fig2
- https://tobiasrausch.com/courses/atac/atac-seq-data-analysis.html#data-exploration
- peak to feature proportion  https://nf-co.re/atacseq/1.1.0/output
- fragment depth vs genome-wide feature
  - [[file:resources/monroe2019fig4f.png]]
- consensus peak upset plot  https://nf-co.re/atacseq/1.1.0/output
- global read distribution  https://nf-co.re/atacseq/1.1.0/output
- qc
  - deeptools fingerprint https://nf-co.re/atacseq/1.1.0/output https://deeptools.readthedocs.io/en/develop/content/tools/plotFingerprint.html
  - insert size density by sample https://nf-co.re/atacseq/1.1.0/output
  - complexity curve by sample https://nf-co.re/atacseq/1.1.0/output
- accessibility by chromosome https://nf-co.re/atacseq/1.1.0/output
- feature-aligned heatmaps
  - https://www.bioconductor.org/packages/devel/bioc/vignettes/ChIPpeakAnno/inst/doc/ChIPpeakAnno.html
- cite:wilson2019
- cite:wang2018amd
******* [[id:29821fa1-acfe-4a74-9c5d-a24adddf2969][Coordinate-based genomics visualization tracks]]
:PROPERTIES:
:ID:       fe02ecd1-9077-4887-996a-bc27f608fa3b
:END:
****** Part of [[id:ae0363f3-379e-4521-9184-cbc0d46501cd][Chromatin accessibility profiling]]
:PROPERTIES:
:ID:       617468ef-1a05-4437-96f0-dbe9c32c8229
:END:
****** General reference
:PROPERTIES:
:ID:       b88ed36f-7474-418e-acb0-1c112f0d6001
:END:
- https://github.com/Zhang-lab/ATACseq_benchmarking/blob/master/simulated_ATAC_tests_limma.R
- https://www.sciencedirect.com/science/article/pii/S2666166720302768
- https://bioinformatics-core-shared-training.github.io/cruk-autumn-school-2017/ChIP/Materials/Lectures/Lecture5_Peak%20Calling_SS.pdf
- Tn5 insertion
  - See for T5 shift visualization https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1642-2#Sec13
  - https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8557372/
- [[https://bioconductor.org/packages/release/BiocViews.html#___ATACSeq][ATAC-seq related bioconductor packages]]
- Reference maps
  - https://academic.oup.com/nar/article/49/D1/D55/5943839
- Alternative uses https://www.science.org/doi/10.1126/sciadv.aba2489
- https://www.illumina.com/science/sequencing-method-explorer/kits-and-arrays/atac-seq.html
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5170597/
******* Encode
:PROPERTIES:
:ID:       a6962b0b-02e6-4f1f-b3ee-534aaf47dd80
:END:
- Encode reference sequences - https://www.encodeproject.org/data-standards/reference-sequences/
- Encode ATAC-seq https://www.encodeproject.org/atac-seq/
  - v1 pipeline
    - as pdf https://www.encodeproject.org/documents/c008d7bd-5d60-4a23-a833-67c5dfab006a/@@download/attachment/ATACSeqPipeline.pdf
    - as google doc https://docs.google.com/document/d/1f0Cm4vRyDQDu0bMehHD7P7KOMxTOP-HiNoIvL1VcBt8/edit
  - https://github.com/ENCODE-DCC/atac-seq-pipeline
  - example qc report- https://storage.googleapis.com/encode-pipeline-test-samples/encode-atac-seq-pipeline/ENCSR889WQX/example_output/qc.html
- https://www.encodeproject.org/search/?type=Pipeline&accession=ENCPL787FUN&accession=ENCPL344QWT
- [[id:585e27b3-3c79-46d5-aeab-9430251d4318][ENCODE]]
******* [[id:8ca221b7-b51a-4382-9844-5d8ba7193ff6][Chromatin accessibility biology]]
:PROPERTIES:
:ID:       fc282da0-9739-4d91-94d9-8ca338740b4d
:END:

  - cite:buenrostro2013



**** Enhancers
:PROPERTIES:
:ID:       75cb1684-766f-469a-800d-823a8de67427
:END:
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4666684/
*** Sequence motif analysis
:PROPERTIES:
:ID:       85b93607-9338-47b6-82c3-6f59d7d319cf
:END:
https://meme-suite.org/meme/
*** [[id:2a6a5dac-151e-42e8-a80a-74f77ad0d4ca][Gene expression]] - see https://github.com/jeszyman/rna-seq
*** Immunoprofiling and immunophenotyping
:PROPERTIES:
:ID:       7bb87c84-6b06-44ef-9a1d-1bb9b9e57295
:END:
- https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0213684
- methods
  - [[id:2bbeb644-af54-4f07-80ad-3584e1e21b04][single-cell RNA sequencing (scRNA-seq)]]
- cite:saloura2019
- https://en.wikipedia.org/wiki/Immunological_Genome_Project#Gene-expression_compendium
**** Deconvolution, immunoprofiling/ immunophenotyping, cell type ennumeriation with rnaseq
:PROPERTIES:
:CREATED:  [2019-10-03 Thu 10:22]
:ID:       e07fee1b-d7fd-42ce-9639-ff803cfc9c8e
:END:
:LOGBOOK:
CLOCK: [2020-02-13 Thu 11:25]--[2020-02-13 Thu 11:33] =>  0:08
CLOCK: [2020-02-13 Thu 10:41]--[2020-02-13 Thu 11:05] =>  0:24
:END:
- https://www.nature.com/articles/s43018-022-00356-3#code-availability
- https://www.ncbi.nlm.nih.gov/pubmed/32036085
- https://genomebiology.biomedcentral.com/articles/10.1186/s13059-017-1257-4
- cite:newman2015
- for rna-seq data, see cite:newman2019 suppliment, do transcript TPM (salmon) and sum to gene
- The following metrics are provided for each mixture sample:
  - P-value: Statistical significance of the deconvolution result across all cell subsets; useful for filtering out results with a poor "goodness of fit." Increase the number of permutations (input page) to increase the number of significant digits.
  - Correlation: Pearson's correlation coefficient (R), generated from comparing the original mixture with the estimated mixture, the latter of which is calculated using imputed cell fractions and corresponding expression profiles from the signature genes file. Of note, the correlation is restricted to signature genes.
  - RMSE: Root mean squared error between the original mixture and the imputed mixture, restricted to genes in the signature gene file.
- in mouse
  - generating a reference from published data
    - single cell
    - array
      - cite:chen2017
        - https://github.com/wuaipinglab/ImmuCC/tree/master/tissue_immucc
  - using pre-compiled reference
    - cite:wang2017a
      - https://github.com/lintian0616/bica
    - convert to human and use lm22
- enrichment- ID at pathway or gene set
  - by ssGSEA
    - ESTIMATE
    - xCell
- cite:liu2019a
  - immune repetoire sequencing- see liu2019a ref83, table 4, ref88-92
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5996037/
- https://www.nature.com/articles/s43018-019-0022-x
- https://www.sciencedirect.com/science/article/pii/S2589004218301871
- https://www.nature.com/articles/nbt.3724
- cite:yalcin2012
- https://mixcr.readthedocs.io/en/master/index.html
- https://www.nature.com/articles/s41592-019-0529-1
- https://www.biostars.org/p/354696/
- cite:vonstechow2017
- cell type enumeration with RNA-seq
  - https://www.nature.com/articles/s41586-019-1773-3

***** immunoprofiling / immunophenotyping
:PROPERTIES:
:CREATED:  [2019-10-30 Wed 10:52]
:ID:       a143e3d0-35b3-4579-8831-9710791e0a6a
:END:
- cite:liu2019a
- cite:papalexi2018 - immune cell heterogeneity by scRNAseq

**** Cytometry
:PROPERTIES:
:ID:       b7b36cba-0d4d-41b0-ae5d-79b0f0f67d2e
:END:
***** Mass cytometry, cytometry by time of flight (CyTOF)
:PROPERTIES:
:ID:       881d23a0-c943-47ac-9bf5-ef965f8a80e3
:END:
- https://onlinelibrary.wiley.com/doi/10.1002/cyto.a.23621
- CATALYST
  - https://www.bioconductor.org/packages/release/bioc/html/CATALYST.html
  - https://www.bioconductor.org/packages/release/bioc/vignettes/CATALYST/inst/doc/differential.html
***** Cytometry
:PROPERTIES:
:ID:       6b6e2fa9-407f-48ec-99b4-c6afc742d135
:END:


- cite:Denny_2011
- cite:Kho_2011


**** Immune cell sequencing
:PROPERTIES:
:ID:       4b2bb8e8-9945-44f3-8181-73bc14e975ab
:END:
- cite:bentham2021

*** Plasma proteomics
- liquid biopsy somascan https://www.cell.com/cell/fulltext/S0092-8674(23)01033-4#secsectitle0090
*** Cell-free DNA (cfDNA) and circulating-tumor DNA (ctDNA)
:PROPERTIES:
:ID:       0f1f4aa4-c755-42ff-8f81-8a32c14293a0
:END:
- [cite:@tivey2024]
- https://mail.google.com/mail/u/0/#inbox/FMfcgzQbfxdHZssqkRxWNGzcMfWWDkdC?projector=1&messagePartId=0.1
- cfDNA CHIP-seq https://mail.google.com/mail/u/0/#inbox/FMfcgzQbfpLJzcxKvRQxgwBNtVqggNnG
- https://www.cell.com/cell-reports-methods/fulltext/S2667-2375%2825%2900119-5
- https://www-nature-com.mclibrary.idm.oclc.org/articles/s41568-025-00795-x?fromPaywallRec=false
- https://www-sciencedirect-com.mclibrary.idm.oclc.org/science/article/pii/S153561082200513X?via%3Dihub
- https://www-nature-com.mclibrary.idm.oclc.org/articles/s41587-021-00857-z
- cfDNA for CAR-T resitance https://www.nature.com/articles/s41467-025-56486-6 https://www.sciencedirect.com/science/article/pii/S1535610822005918
**** Tumor origin, tumor content, tumor fraction
- alternative TF strategies https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-023-05478-8
**** Circulating nucleosomes
- as circ nucleosomes https://pubmed.ncbi.nlm.nih.gov/37627320/

**** cfDNA and ctDNA-specific visualizations
:PROPERTIES:
:ID:       314e4183-bcb9-4029-86c8-fd4654219a6c
:END:
- [[file:resources/moding2020fig4b.png]] cite:moding2020 fig4b
- tumor fraction ratios [[./biotools.org_20220817_135512.png]]
- https://d0dd8a80-1a24-4cc5-a00a-3f42615181d7.filesusr.com/ugd/ad98ab_846561db683443d3af0664c558849464.pdf
**** General and miscellaneous
- [cite:@illumina2022]
- https://pubmed.ncbi.nlm.nih.gov/40020203/
- GC bias correction https://www.biorxiv.org/content/10.1101/2024.11.07.622399v1.full.pdf

**** cfDNA fragment length-based methods
- fragment size
  - https://www.nature.com/articles/s41586-020-2140-0
  - https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-020-06848-9#Sec9
- DELFI (DNA evaluation of fragments for early interception)
  - https://github.com/cancer-genomics/delfi3
  - [[file:~/library/alizadeh2023.pptx]]
  - some evidence for increased abberation in non-cancer cirrhosis
    - cite:foda2022
  - short-to-long ratio by genomic bin cite:mathios2021
    - https://github.com/cancer-genomics/reproduce_lucas_wflow
  - https://www.nature.com/articles/s41467-022-31419-9
  - cite:cristiano2019 Delfi
  - https://github.com/Cancer-Genomics/delfi_scripts
- cite:underhill2016
- cite:mouliere2018
  - cite:mouliere2018a
- ultra short https://www.degruyterbrill.com/document/doi/10.1515/cclm-2023-0541/html
**** cfDNA ChIP-seq
https://www-nature-com.mclibrary.idm.oclc.org/articles/s41587-020-00775-6#Sec2
**** Retrotransposons in cfDNA
- Retrotransposons
  - [cite:@michel2024line1]

**** cfDNA methylation
:PROPERTIES:
:ID:       79dfda7e-8b6d-45c7-88d5-804979155763
:END:
https://www.nature.com/articles/s41390-022-02448-3gas
https://www.nature.com/articles/s41587-022-01652-0
https://www.annalsofoncology.org/article/S0923-7534(20)36058-0/fulltext
- [cite:@chemi2022]
- 5hmC in cfDNA https://www.nature.com/articles/cr2017121.pdf?origin=ppub
- dPCR of global tumor methylation signature https://mail.google.com/mail/u/0/#inbox/FMfcgzQZTMLpbcLfPvXqMSjhTrBbzvKk?projector=1&messagePartId=0.1
- TAPS-seq
  - [cite:@sun2021tapsseq]
**** cfDNA long read sequencing
:PROPERTIES:
:ID:       dda1c9d0-59b6-487d-8bdb-86423062cf22
:END:
- https://academic.oup.com/clinchem/article/68/9/1151/6588669
- https://www.biorxiv.org/content/10.1101/2021.10.18.464684v1.full
- [cite:@katsman2022cfdnananopore]
- cfDNA nanopore for meth and COO [[cite:&katsman2022cfdnananopore]]
**** [[id:21d876e8-8646-4773-91c1-c4385c3218c7][cfDNA copy number calling]]
**** cfDNA feature integration
:PROPERTIES:
:ID:       434f2b3a-cd86-4d1a-955d-b84e98005a71
:END:
- https://www.sciencedirect.com/science/article/pii/S2666379123005669
- https://www.cell.com/cell-reports-medicine/pdf/S2666-3791(23)00566-9.pdf
**** cfDNA quality control (QC)
- cfdna qc
  - see cite:quigley2018 S1

**** [[*cfDNA fragmentomics][cfDNA fragmentomics]]
**** [[id:2e475e89-40a2-4359-903d-6e590f4ab8a0][cfDNA from nonterminal mouse blood draws]]
**** [[id:833f276f-f532-475e-8e0e-f4d528078a6b][cfDNA library preparation]]
**** [[*cfDNA methylation][cfDNA methylation]]
**** [[id:c4dde8d6-1a02-42c7-a6b6-786b757fcad1][cfDNA nucleosome profiling]]
**** [[*cfDNA small variant calling][cfDNA small variant calling]]
**** [[id:1c6c6e74-c470-4272-abf1-6574da0c80b0][cfDNA specimen collection and DNA isolation]]
**** [[id:47c4ed56-1dea-48dc-bb25-ddbb0a4cd359][cfDNA tissue of origin discovery]]
**** cfDNA topology
:PROPERTIES:
:ID:       2d0d13d9-857a-4285-89e6-4614f749afd3
:END:
- https://www.cell.com/cancer-cell/fulltext/S1535-6108(19)30386-1?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS1535610819303861%3Fshowall%3Dtrue
- [[id:c4dde8d6-1a02-42c7-a6b6-786b757fcad1][cfDNA nucleosome profiling]]
- https://insight.jci.org/articles/view/159590/pdf
**** General reference
:PROPERTIES:
:ID:       625e6405-29f3-45ac-8898-37987897014c
:END:
- https://www.sitcancer.org/research/jitc-2/jitc/collections/liquid-biopsies
- cite:keller2020
- https://www.nature.com/collections/gcdaehehhf/webinars
- https://www.nature.com/articles/s41551-021-00837-3
- https://www.mdpi.com/2072-6694/13/14/3460/htm
- https://www.nature.com/articles/s41416-021-01696-0
- https://royalsocietypublishing.org/doi/10.1098/rsob.200119
- cfDNA datasets-  https://generegulation.org/cfdna/
- see  [[https://mail.google.com/mail/u/0/#inbox/FMfcgxwGDNNMGQwVvHMjSKjBHhrkMLrS][jake's ulpwgs cfdna preprocessing]]
- cite:heberts2021
**** Integrated hybrid capture and genome-wide- MAESTRO
:PROPERTIES:
:ID:       55b77210-fcb6-438d-a546-0c3605f6f5c4
:END:
cite:gydush2022
**** Promenent research groups
:PROPERTIES:
:ID:       d806c115-915b-4a15-ba00-3713797d2d48
:END:
***** Mouliere
- https://www.sciencedirect.com/science/article/pii/S2666379123005669
***** Velculescu
****** LB-SIG Webinar - https://cbiit.webex.com/cbiit/j.php?MTID=m034b40090add3040f3411064c8e3dd59
  <2025-04-28 Mon 12:00>--<2025-04-28 Mon 13:00>

- < 20% of patients recieve guidlin adherant screeing for liver cancer
- high C open chrom vs frag- foda 2023 cancer disco [cite:@foda2022]
- cancer disc 20205 medina annapragada ovarian ca
  - monte carlo for different feature sets-
- lung firstlook.com test mazzone cancer disc 2024
- artemis
  - annapragada stm 2024
  - tie to amp/del
***** Adalsteinsson group
:PROPERTIES:
:ID:       217755bf-b9e9-4802-ba96-482ba39f1b1a
:END:
[[id:55b77210-fcb6-438d-a546-0c3605f6f5c4][Integrated hybrid capture and genome-wide- MAESTRO]]
***** Landau Group
:PROPERTIES:
:ID:       b4b2a35f-e59a-4e84-995e-ca16d7fd190d
:END:
- [cite:@widman2024]
- [cite:@widman2022]
- [cite:@zviran2020]
**** Tumor-informed methods
:PROPERTIES:
:ID:       10d3a3a4-dbe6-4494-b287-c3e5720932b2
:END:
- phylogenic for cancer evolution cite:abbosh2017
**** WGS cfDNA methods
:PROPERTIES:
:ID:       67251de4-3c85-4ba5-b5e5-6efefcd8961d
:END:
- [cite:@davis2019]
- phased seq of multiple muts https://www.nature.com/articles/s41587-021-00981-w
- mutational signatures for LP WGS [[cite:&wan2022]]
- [[id:55b77210-fcb6-438d-a546-0c3605f6f5c4][Integrated hybrid capture and genome-wide- MAESTRO]]
- https://www.medrxiv.org/content/10.1101/2022.12.06.22283116v1
- mutation profiling in low coverage wgs https://www.nature.com/articles/s41467-022-32598-1
- https://www.biorxiv.org/content/10.1101/2022.01.17.476508v1.full.pdf
- cite:zviran2020
*** Cell-free RNA (cfRNA), extracellular RNA (exRNA)
- https://www.nature.com/articles/s41586-025-08834-1
- cite:illumina2022
*** Machine learning in genomics and bioinformatics
:PROPERTIES:
:ID:       d11ec8a8-7fa6-4043-89b3-20045e2d339e
:END:
- machine learning in computational biology https://www.youtube.com/@mlcbconf

https://www.reddit.com/r/bioinformatics/comments/1g1j4os/complete_machine_learning_examples_in_bioinfo/
- https://colab.research.google.com/github/isb-cgc/Community-Notebooks/blob/master/MachineLearning/How_to_build_an_RNAseq_logistic_regression_classifier.ipynb
- [[id:38c00ba1-299f-4a0d-959e-58845d12c712][Machine learning of whole genome sequencing data]]
- cite:chiorean2022
- https://www.science.org/doi/10.1126/scitranslmed.abk2756
- https://www.nature.com/articles/s41568-021-00408-3
- https://www.nature.com/articles/s41576-021-00434-9
- [[id:1768b182-858a-46f8-97a8-4cd9747a2361][Probability and statistics related to bioinformatics]]
*** Massively parallel sequencing
:PROPERTIES:
:ID:       cca285b0-cd5a-4c59-9601-f069512c497f
:END:
https://www.nature.com/articles/nrg3642/tables/2
**** Sequence alignment
:PROPERTIES:
:ID:       5f21db2a-bd70-4bd3-a948-8bb9603c6432
:END:
https://www.ncbi.nlm.nih.gov/genome/doc/ftpfaq/
**** [[id:728e8984-696f-4531-8e76-bf6d78bfa3b7][DNA-seq]]
:PROPERTIES:
:ID:       dc40cf52-c7ad-4e3b-9f27-54028faf9220
:END:
**** Nucleic acid sequening processes
:PROPERTIES:
:ID:       72652128-5a3d-493b-9443-1bf0ada94cfb
:END:
https://www.reddit.com/r/bioinformatics/comments/te1f5w/what_is_important_to_know_about_your_ngs_library/
***** Massively parallel sequencing
:PROPERTIES:
:ID:       80c916d2-5028-43f2-acbf-00e12f380827
:END:

cite:mitelman2007impact

cite:lieber2016mechanisms

********* Human Pathological Translocations
:PROPERTIES:
:ID:       92C7145A-9535-4E74-B4FF-88A90EE6A78F
:END:

cite:lipson2012identification

cite:bunting2013end

cite:zheng2013oncogenic

cite:greaves14_janet_rowley

cite:wheeler2013human

********* [[Clinical Fusion Protein Databases]]
:PROPERTIES:
:ID:       4AE77A12-C491-4590-9F8B-6C6EC4077242
:END:

********* Clinical RNA-seq Assays to Detect Fusion Proteins
:PROPERTIES:
:ID:       9786E312-B8BC-4F14-BAF2-C9B682703FB7
:END:

cite:beadling16_multip_amplic_approac_detec_gene

cite:qadir2014childseq


cite:scolnick2015efficient

********** Specific Cancers
:PROPERTIES:
:ID:       E44CCF9D-6D9A-4F01-B90F-929D038CF4F4
:END:

cite:alves2015next

cite:smallridge2013rna

cite:edgren2011identification

cite:pekar2015fluorescence

cite:duncavage2012targeted

********* [[FISH]]
:PROPERTIES:
:ID:       F54BB35F-3BAA-4AA9-928C-18FAB543D7C6
:END:


********* Post-Alignment Analysis Programs
:PROPERTIES:
:ID:       EC14669D-1B71-45FD-9D4D-62E405CE6917
:END:

https://rdrr.io/bioc/chimera/man/starReads.html
http://www.bioconductor.org/packages/release/bioc/vignettes/chimera/inst/doc/chimera.pdf
https://github.com/STAR-Fusion/STAR-Fusion/wiki

cite:chimera_r

******* Variant Calling
:PROPERTIES:
:ID:       E3637686-6560-4088-9784-0A601F39C34D
:END:
https://pubmed.ncbi.nlm.nih.gov/36063163/
https://pubmed.ncbi.nlm.nih.gov/33580225/
- tumor evolution
  - fishplot https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-016-3195-z
- incidental acquired variant detection in germline https://www.nature.com/articles/s41436-021-01138-5?proof=t+target%3D#Sec3
- clonal evolution- https://cancerdiscovery.aacrjournals.org/content/8/11/1390.long
- HRDtools for homologous recombination index
  - https://github.com/eyzhao/hrdtools
- cite:ainscough2018
- - cite:barnell2018
- [[https://software.broadinstitute.org/gatk/best-practices/bp_3step.php?case=GermShortWGS][GATK Best Practices Germline SNP and Indel]]
- [[http://www.htslib.org/workflow/][WGS/WES Mapping to Variant Calls - Version 1.0]]
- [[https://software.broadinstitute.org/gatk/documentation/tooldocs/org_broadinstitute_gatk_tools_walkers_genotyper_UnifiedGenotyper.php][Broad UnifiedGenotyper]]
- [[https://software.broadinstitute.org/gatk/documentation/article?id=3238][Broad best practices DNAseq variant]]
- cite:vcf
http://swog.org/Visitors/Fall13GpMtg/plenary/03-Corless-SWOG-Genomics-TM-ver1.pdf

******** GATK Tool Set
:PROPERTIES:
:ID:       B4100085-BD16-442F-9AB8-586241CD897A
:END:

********* GATK UnifiedGenotyper
:PROPERTIES:
:ID:       0D7356A4-E139-4BDF-BD6B-4170C15531F9
:END:

- one of several GATK variant discovery tools

********* DONE Setup GATK
CLOSED: [2016-12-05 Mon 14:22]
:PROPERTIES:
:ID:       E38AAAE9-DB89-42C8-9CE3-C18003F720D3
:END:

- resuem here https://software.broadinstitute.org/gatk/documentation/quickstart.php

- [[https://software.broadinstitute.org/gatk/documentation/quickstart.php][Getting Started]]
  - "Unlike C-compiled programs such as Samtools, GATK cannot simply be added to your PATH, so we recommend setting up an environment variable to act as a shortcut."

******* sequence variation
:PROPERTIES:
:ID:       ec437673-e697-4c0d-a65f-46aec2641ed2
:END:
- https://ai.googleblog.com/2020/09/improving-accuracy-of-genomic-analysis.html?m=1
******** variant calling
:PROPERTIES:
:ID:       743b5990-53e6-4cce-8adc-a9d766d1c5e2
:END:
********* SCNA variants
:PROPERTIES:
:ID:       179ce37c-f8cf-44b3-872b-e32677bcb49c
:END:
- SCNAs
  - https://pmbio.org/module-05-somatic/0005/04/02/Somatic_CNV_FilteringAnnotationReview/
  - https://www.annualreviews.org/doi/full/10.1146/annurev-genom-082410-101404?url_ver=Z39.88-2003&rfr_id=ori%3Arid%3Acrossref.org&rfr_dat=cr_pub%3Dpubmed
  - cite:quigley2018
  - https://bioconductor.org/packages/release/bioc/html/DNAcopy.html
  - cite:talevich2016
  - [[file:~/repos/copy-number/]]
  - [[file:~/repos/copy-number/copy-number.org]]
  - https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-S11-S1
  - https://www.youtube.com/watch?v=m9XPWJrMThY&t=8s
  - https://deeptools.readthedocs.io/en/latest/content/installation.html
  - https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5737511/
- WGS callers
  - https://github.com/GavinHaLab
******* copy-number
:PROPERTIES:
:CREATED:  [2019-05-29 Wed 14:46]
:ID:       0206fb96-8785-47fb-87ca-1f597de0ee85
:END:
:LOGBOOK:
CLOCK: [2019-10-10 Thu 15:45]--[2019-10-10 Thu 15:53] =>  0:08
CLOCK: [2019-05-15 Wed 13:09]--[2019-05-15 Wed 13:24] =>  0:15
CLOCK: [2019-06-25 Tue 07:51]--[2019-06-25 Tue 08:00] =>  0:09
CLOCK: [2019-06-23 Sun 07:49]--[2019-06-23 Sun 07:53] =>  0:04
CLOCK: [2019-06-19 Wed 14:28]--[2019-06-19 Wed 14:49] =>  0:21
CLOCK: [2019-06-19 Wed 12:38]--[2019-06-19 Wed 13:33] =>  0:55
CLOCK: [2019-06-12 Wed 14:40]--[2019-06-12 Wed 14:58] =>  0:18
CLOCK: [2019-05-29 Wed 15:23]--[2019-05-29 Wed 15:34] =>  0:11
CLOCK: [2019-05-29 Wed 14:46]--[2019-05-29 Wed 14:47] =>  0:01
:END:
- [cite:@baslan2012]
- https://link.springer.com/protocol/10.1007/978-1-4939-9004-7_8
- https://bioinformaticsdotca.github.io/bicg_2017_module4_lab
- cite:hehir-kwa2015
- https://www.nature.com/scitable/topicpage/copy-number-variation-and-human-disease-741737/
- https://www.frontiersin.org/articles/10.3389/fonc.2020.00321/full
- [[id:8c535c38-9310-4fd0-a8fe-c300639493da][ichorcna]]
- copy number classifiers
  - https://www.sciencedirect.com/science/article/pii/S0016508521002778?via%3Dihub
- https://www.sciencedirect.com/science/article/pii/S1535610818301119?via%3Dihub
- allele-specific copy number: the number of copies of each inherited allele, allows for the detection of copy-neutral loss of heterozygosity https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5627665/
- [[https://www.bioconductor.org/packages/devel/bioc/vignettes/TitanCNA/inst/doc/TitanCNA.pdf][see ploidy purity correction math]]
- [[https://www.biostars.org/p/383522/][good CN,purity,ploid discussion]]
******* [[id:5738AF1F-8621-40C3-AF80-0C396CDC889B][LINK TO Clinical NGS]]
:PROPERTIES:
:ID:       413414a5-651d-4d43-82c8-a6bb13de8ca3
:END:
******* DNA break mapping
:PROPERTIES:
:ID:       8a2ff484-d234-48fa-88c9-c4994f2e0d14
:END:

https://teichlab.github.io/scg_lib_structs/methods_html/Illumina.html
http://enseqlopedia.com/2018/01/illumina-index-sequencing-sample/
https://www.illumina.com/content/dam/illumina-marketing/documents/products/illumina_sequencing_introduction.pdf
http://tucf.com/htseq_GenomicSeq_DataSheet.pdf
****** [[id:7ec3083a-b152-4ab2-b4f8-5fb9bb5ba068][Determine sequencing coverage]]
:PROPERTIES:
:ID:       f2765648-7826-4b6b-99ab-a46e416573f8
:END:
****** General reference
:PROPERTIES:
:ID:       71e5bc12-9458-4e4a-a342-d31c90656a59
:END:
=======
https://febs.onlinelibrary.wiley.com/doi/10.1111/febs.15568
https://www.nature.com/articles/s41467-019-10332-8#Sec13

****** Analysis of cell-free nucleic acids
:PROPERTIES:
:ID:       80672163-dd92-41cb-a81e-cbaebdbecb63
:END:
>>>>>>> bb11343ab3ff683a4ece1c261661becfbc0b872d
:PROPERTIES:
:ID:       906150c9-910e-464c-9d7f-d8608abf6c07
:END:
******* Cell-free DNA (cfDNA) and circulating-tumor DNA (ctDNA)
:PROPERTIES:
:ID:       0f1f4aa4-c755-42ff-8f81-8a32c14293a0
:END:
- https://www.nature.com/collections/haffgaicaf
- https://www.sciencedirect.com/science/article/pii/S0890850819303883#fig1
- https://www.nature.com/articles/s41467-022-32598-1#Sec11
- https://www.nature.com/articles/s41416-020-01047-5
- https://www.nature.com/articles/s41551-022-00855-9

******** SEQC2
:PROPERTIES:
:ID:       5bd23df2-9d70-442a-a975-95a10adc004d
:END:
https://www.nature.com/articles/s41587-021-00857-z
https://genomebiology.biomedcentral.com/articles/10.1186/s13059-021-02529-2#Sec15
******** Hybrid capture
:PROPERTIES:
:ID:       1deeadf8-99f9-4f41-8611-03ac02a6550f
:END:
https://mail.google.com/mail/u/0/#inbox/FMfcgzGrblWQxQHrNZrMjzpGmzjqDNGX
******** Landau Group
:PROPERTIES:
:ID:       b4b2a35f-e59a-4e84-995e-ca16d7fd190d
:END:
cite:widman2022

******** [[id:21d876e8-8646-4773-91c1-c4385c3218c7][cfDNA copy number calling]]
:PROPERTIES:
:ID:       8fb841f9-f632-47fe-b4c6-8ede9c262325
:END:
******** [[id:47c4ed56-1dea-48dc-bb25-ddbb0a4cd359][cfDNA tissue of origin discovery]]
:PROPERTIES:
:ID:       7e4e1b6a-75c7-4a70-9fa5-5fe8dab7532b
:END:
******** [[id:c4dde8d6-1a02-42c7-a6b6-786b757fcad1][cfDNA nucleosome profiling]]
:PROPERTIES:
:ID:       d89f7373-56a4-4b7d-8362-3a57913bc130
:END:
******** [[*cfDNA methylation][cfDNA methylation]]
:PROPERTIES:
:ID:       d8da32ab-dc8a-4cf0-ada5-1589dcb46f97
:END:
******** [[*cfDNA fragmentomics][cfDNA fragmentomics]]
:PROPERTIES:
:ID:       3354dae3-3a9b-44bd-86a0-8c90b4c22f1a
:END:
******** [[*cfDNA small variant calling][cfDNA small variant calling]]
:PROPERTIES:
:ID:       85e586bf-a622-42c6-b379-75ef0cd8250a
:END:
******** Tumor-informed methods
:PROPERTIES:
:ID:       aedb606f-bfae-419b-845d-38a85c231218
:END:
- phylogenic for cancer evolution cite:abbosh2017
******** WGS cfDNA methods
:PROPERTIES:
:ID:       1b87f575-dd0f-41c3-bc01-fe17edb0db3d
:END:
- https://www.biorxiv.org/content/10.1101/2022.01.17.476508v1.full.pdf
- cite:zviran2020 [cite:@zviran2020]
******** cfDNA and ctDNA-specific visualizations
:PROPERTIES:
:ID:       f3252217-66be-4dad-aa81-c20e55b55b66
:END:
  - cite:moding2020
  - cite:everett2020
  - - https://d0dd8a80-1a24-4cc5-a00a-3f42615181d7.filesusr.com/ugd/ad98ab_846561db683443d3af0664c558849464.pdf

******** cfDNA from nonterminal mouse blood draws
:PROPERTIES:
:ID:       b801d977-af25-48a9-aeff-de8ff97b8ef2
:END:

- Mouse non-terminal cfDNA WGBS at 0.2 mL per draw via pooling - [[cite:&maggi2018]]
- [[https://www.scopus.com/results/citedbyresults.uri?sort=plf-f&cite=2-s2.0-85041307621&src=s&imp=t&sid=34d94cc055a157a403a73abf20dce6bb&sot=cite&sdt=a&sl=0&origin=resultslist&editSaveSearch=&txGid=0be803296f96ab0d3c7cff7b5c1c816a][scopus citing]] cite:maggi2018
  -

******** General reference
:PROPERTIES:
:ID:       94bed0e0-9340-40da-b528-0a59df3c072b
:END:
- https://www.nature.com/collections/gcdaehehhf/webinars
- https://www.nature.com/articles/s41551-021-00837-3
- https://www.mdpi.com/2072-6694/13/14/3460/htm
- https://www.nature.com/articles/s41416-021-01696-0
- https://royalsocietypublishing.org/doi/10.1098/rsob.200119
- cfDNA datasets-  https://generegulation.org/cfdna/
- see  [[https://mail.google.com/mail/u/0/#inbox/FMfcgxwGDNNMGQwVvHMjSKjBHhrkMLrS][jake's ulpwgs cfdna preprocessing]]
- cite:heberts2021
******* cfRNA
:PROPERTIES:
:ID:       f4d64349-0202-41e5-9143-39de3dd63d90
:END:
- https://directorsblog.nih.gov/2023/09/12/new-approach-to-liquid-biopsy-relies-on-repetitive-rna-in-the-bloodstream/
- https://www.nature.com/articles/s41551-023-01081-7
- https://oaepublishstorage.blob.core.windows.net/b918d521-af58-4cf0-bc57-db03c5c43f33/4446.pdf
- https://mail.google.com/mail/u/0/#inbox/FMfcgzGpFgqmWTzSTxFbqlqjBLnzFsWT
[cite:@rozowsky2019]
- cite:rozowsky2019
- https://www.nature.com/articles/s41586-022-04410-z
- https://www.nature.com/articles/d41586-021-03801-y
- [[cite:&larson2021]]
- [[cite:&griffith2016a]]
- https://mail.google.com/mail/u/0/#inbox/FMfcgzGlksDcrLMrdlPVPsVnzpdCNTsx
 [[#larson2021][larson2021]]
https://www.frontiersin.org/articles/10.3389/fgene.2021.742496/full
****** Allele-specific expression
:PROPERTIES:
:ID:       a52b4ca3-c3ca-4aec-b68a-01c1de39fc8a
:END:

- https://github.com/secastel/allelecounter
- https://genomebiology.biomedcentral.com/articles/10.1186/s13059-015-0762-6#Sec11
****** Alternative splicing
:PROPERTIES:
:ID:       eba855e5-ce0e-4318-894d-4942f7e2fe45
:END:
- w/ RNA-seq via splAdder
  - https://github.com/ratschlab/spladder
  - https://academic.oup.com/bioinformatics/article/32/12/1840/1744052?login=true
****** Setup common reference files
:PROPERTIES:
:ID:       813ed980-1c55-44d7-84d8-67afdad2e5bc
:END:
  #+name: setup_common_references
  #+begin_src bash
#
# Setup
/bin/bash
alias wget_common=wget --noclobber
refdata=
#
# Download reference genomes
## Human
### UCSC Hg38
wget_common https://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz -O $refdata/hg38.fa.gz
### Ensembl
#### TopLevel
wget_common ftp://ftp.ensembl.org/pub/release-102/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.toplevel.fa.gz -O $refdata/Homo_sapiens.GRCh38.dna.toplevel.fa.gz
#### Primary assembly
wget --no-clobber ftp://ftp.ensembl.org/pub/release-102/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz -O $refdata/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
##
## Rattus norvegicus
### UCSC
wget_common ftp://hgdownload.cse.ucsc.edu/goldenPath/rn6/bigZips/rn6.fa.gz -O $refdata/rn6.fa.gz
### Ensembl
#### TopLevel
wget_common ftp://ftp.ensembl.org/pub/release-102/fasta/rattus_norvegicus/dna/Rattus_norvegicus.Rnor_6.0.dna.toplevel.fa.gz -O $refdata/Rattus_norvegicus.Rnor_6.0.dna.toplevel.fa.gz
#### NOTE: No Rattus primary assembly
#### cDNA
wget_common ftp://ftp.ensembl.org/pub/release-102/fasta/rattus_norvegicus/cdna/Rattus_norvegicus.Rnor_6.0.cdna.all.fa.gz -O /home/jeszyman/data/Rattus_norvegicus.Rnor_6.0.cdna.all.fa.gz
gunzip /home/jeszyman/data/Rattus_norvegicus.Rnor_6.0.cdna.all.fa.gz
#### GTF
wget_common ftp://ftp.ensembl.org/pub/release-102/gtf/rattus_norvegicus/Rattus_norvegicus.Rnor_6.0.102.gtf.gz -O /home/jeszyman/data/Rattus_norvegicus.Rnor_6.0.102.gtf.gz
#
# Unzip
for file in $refdata/*.fa.gz $refdata/*.gtf.gz;
do
    gunzip_common $file
done
#

#########1#########2#########3#########4#########5#########6#########7#########8
# ideas
#in/out from csv
# get readmes
#########1#########2#########3#########4#########5#########6#########7#########8
#+end_src
***** [[id:326ecd60-8cd4-4815-a389-967b2c3fef0a][Nucleic acid sequence alignment]]
:PROPERTIES:
:ID:       832bb19c-d88e-4e27-8233-43670aed60ee
:END:
***** Nucleic acid sequening processes
:PROPERTIES:
:ID:       3b56d0e4-5f22-498f-b2eb-2225e99aab9a
:END:
https://www.reddit.com/r/bioinformatics/comments/te1f5w/what_is_important_to_know_about_your_ngs_library/
****** [[id:326ecd60-8cd4-4815-a389-967b2c3fef0a][Nucleic acid sequence alignment]]
:PROPERTIES:
:ID:       f2aec4b7-67a3-43f0-a510-84026a56b4b7
:END:
****** Massively parallel sequencing
:PROPERTIES:
:ID:       3BC41E6A-00D3-4498-A48C-463F68CFD76B
:END:
:LOGBOOK:
CLOCK: [2022-06-03 Fri 08:33]--[2022-06-03 Fri 08:40] =>  0:07
CLOCK: [2021-05-27 Thu 11:25]--[2021-05-27 Thu 11:38] =>  0:13
:END:
https://www.illumina.com/content/dam/illumina-marketing/documents/products/illumina_sequencing_introduction.pdf
http://tucf.com/htseq_GenomicSeq_DataSheet.pdf
******* [[id:7ec3083a-b152-4ab2-b4f8-5fb9bb5ba068][Determine sequencing coverage]]
:PROPERTIES:
:ID:       3983fdd5-f295-435d-a50e-5e996cf4dc5f
:END:
******* General reference
:PROPERTIES:
:ID:       8438f135-bfc1-4d5e-8a02-f594a1d0773a
:END:
- https://www.youtube.com/user/IlluminaInc/playlists
- https://docs.nvidia.com/clara/parabricks/v3.0/index.html#
- https://support.illumina.com/training.html
- cite:goodwin2016
- cite:lee2016
******* High Throughput Sequencing Platforms
:PROPERTIES:
:ID:       DF6FFA19-8867-49AC-947D-FD57B403761A
:END:
- https://www.broadinstitute.org/genome-sequencing/broadillumina-genome-analyzer-boot-camp
- commercial sequencing entities
  - medgeneome
    - https://research.medgenome.com/qc-reports/
    - https://research.medgenome.com/ngs-services/whole-genome-exome-sequencing/
- https://www.illumina.com/systems/sequencing-platforms/comparison-tool.html
- https://dnatech.genomecenter.ucdavis.edu/
- [[https://www.youtube.com/watch?v=v1DbcJD4Ry0][youtube Mardis NGS]]
- [[http://www.broadinstitute.org/scientific-community/science/platforms/genome-sequencing/broadillumina-genome-analyzer-boot-camp][Broad / Illumina Genome Analyzer Boot Camp]]
- [[file:~/Box%20Sync/library/Mardis,08%20Next-Generation%20DNA%20%20Sequencing%20Methods.pdf][Mardis,08 Next-Generation DNA  Sequencing Methods]]
- 150924.1600Mardis talk
  - Illumina read length limit is signal to noise
  - Ion torrent difficult for indels with runs of single nucleotide
  - Paired end allows placement of repetitive sequences where one side might be repetitive, the other not
  - Evaluate coverage by comparison to snp array
  - Clinical sequencing false positive if variants have patterns
- Sequencing platform overview and limitations
  - cite:payton2016
- cite:glenn2011
******** Ion Torrent
:PROPERTIES:
:ID:       EC631BCD-1A9B-4B8B-877E-7861C27D948B
:END:

******** Illumina
:PROPERTIES:
:ID:       D1A3EF94-7933-4854-99ED-C63DE8F7741D
:END:
- https://www.reddit.com/r/bioinformatics/comments/uxm1s7/novaseq_2dye_v_hiseq_4dye_sequencing_differences/
- adapters
  - only 3' adapters need trim https://support.illumina.com/bulletins/2016/04/adapter-trimming-why-are-adapter-sequences-trimmed-from-only-the--ends-of-reads.html
  - indexing goes on outside of adapter seq- so routine trim will find and clip
  - https://support.illumina.com/bulletins/2016/12/what-sequences-do-i-use-for-adapter-trimming.html
- cite:illumina2015nextseq
- table
    | series  | platform |
    |---------+----------|
    | NovaSeq |     6000 |
    | HiSeq   |     3000 |
    | HiSeq   |     2500 |
    | MiSeq   |          |
    | Nexseq  |          |
    - https://www.illumina.com/systems/sequencing-platforms/comparison-tool.html
https://www.illumina.com/systems/sequencing-platforms/novaseq/specifications.html
output- *.bcl files- base call and quality score per cycle
convert *.bcl to .fastq.gz w/ CASAVA
also demultiplexes
- [[https://www.illumina.com/systems.html][system specs]]
- PhiX phasing and cluster ctrl https://www.illumina.com/content/dam/illumina-marketing/documents/products/technotes/hiseq-phix-control-v3-technical-note.pdf
- library preparation kits
  - [[https://www.illumina.com/library-prep-array-kit-selector.html][selector]]
  - https://support.illumina.com/sequencing/sequencing_kits/truseq-small-rna-kit.html
********* Phix
:PROPERTIES:
:ID:       b2b2c811-498f-46e9-92ec-85a417864c11
:END:
https://support.illumina.com/bulletins/2017/02/what-is-the-phix-control-v3-library-and-what-is-its-function-in-.html
https://support.illumina.com/bulletins/2017/02/how-much-phix-spike-in-is-recommended-when-sequencing-low-divers.html
https://support.illumina.com/bulletins/2016/07/what-is-nucleotide-diversity-and-why-is-it-important.html
********* Illumina TruSeq
:PROPERTIES:
:ID:       3CE663C4-BF37-4E2E-9A0D-0E822241D05E
:END:
- https://www.google.com/search?q=illumina+truseq+indexes
- See Kukurba,15
- Steps
  - RNA isolation
  - Poly-A purification
  - Fragmentation
  - cDNA synthesis
  - Adaptor ligation
  - Size selection
  - PCR amplification

********** Removal of rRNA and tRNA
:PROPERTIES:
:ID:       D509473A-536B-46D2-8639-22DC19DF41E2
:END:
******* [[id:f44b9dce-d7fa-4b6a-9949-49ff3c02547c][Sequencing testing, modeling, and read simulation]]
:PROPERTIES:
:ID:       e41e8c37-e0fd-4a2c-9207-0ae1ac555fd3
:END:
******* Adapter and probe design and processing
:PROPERTIES:
:ID:       8f0a09c6-2a68-425c-91a9-4d09866c8ae2
:END:
- https://en.wikipedia.org/wiki/Edit_distance
https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-017-4428-5#Sec5
- https://www.nature.com/articles/s41587-018-0006-x
- https://sfvideo.blob.core.windows.net/sitefinity/docs/default-source/user-guide-manual/xgen-prism-dna-library-prep-kit-processing-sequencing-data-with-umis.pdf
- https://github.com/pughlab/ConsensusCruncher
- https://rochesequencingstore.com/wp-content/uploads/2017/10/KAPA-DI-Adapter-Kit_KR1318-%E2%80%93-v3.19.pdf
******* Library preparation
:PROPERTIES:
:ID:       cae4df04-eb04-4148-88a3-798be945a9fd
:END:
- https://www.future-science.com/doi/10.2144/000114133
- [[http://genomebiology.biomedcentral.com/articles/10.1186/gb-2011-12-2-r18][amplification bias]]
******* Sequencing errors
:PROPERTIES:
:ID:       008673aa-98af-4ffb-89d9-cde43ededa83
:END:
- seq error correction
  - as an information model, propogation of errors, random vs. nonrandom
  - random start-stop- allows ID of PCR duplicates- by start/stop regardless of internal seq
  - ligation umi
    - umi strategies
    - umi actaully adds back 'false' pcr duplicates which can now be positively IDed as unique molecules
  - duplexing and asymmetric strand artifacts
    - distinguishing strands
- 1st exon GC-rich, poorly seq by illumina
- https://www.nature.com/articles/s41598-018-29325-6
******* Raw sequence QC and processing
:PROPERTIES:
:ID:       1EE731A3-83DD-46AF-B988-2311307C335F
:CREATED:  [2020-10-14 Wed 08:47]
:END:
:LOGBOOK:
CLOCK: [2020-10-13 Tue 14:00]--[2020-10-13 Tue 14:47] =>  0:47
CLOCK: [2016-04-05 Tue 17:21]--[2016-04-05 Tue 17:32] =>  0:11
CLOCK: [2016-04-05 Tue 17:06]--[2016-04-05 Tue 17:15] =>  0:09
CLOCK: [2016-04-05 Tue 10:44]--[2016-04-05 Tue 11:30] =>  0:46
CLOCK: [2019-07-23 Tue 20:35]--[2019-07-23 Tue 21:13] =>  0:38
CLOCK: [2019-07-23 Tue 19:27]--[2019-07-23 Tue 19:40] =>  0:13
CLOCK: [2019-07-16 Tue 14:46]--[2019-07-16 Tue 15:03] =>  0:17
CLOCK: [2019-07-07 Sun 11:18]--[2019-07-07 Sun 11:34] =>  0:16
CLOCK: [2019-07-06 Sat 08:11]--[2019-07-06 Sat 09:07] =>  0:56
CLOCK: [2019-07-05 Fri 21:00]--[2019-07-05 Fri 22:04] =>  1:04
CLOCK: [2019-06-05 Wed 09:07]--[2019-06-05 Wed 09:47] =>  0:40
CLOCK: [2019-06-03 Mon 18:40]--[2019-06-03 Mon 20:30] =>  1:22
CLOCK: [2019-06-04 Tue 12:39]--[2019-06-04 Tue 13:12] =>  0:33
CLOCK: [2020-10-13 Tue 13:38]--[2020-10-13 Tue 14:00] =>  0:22
:END:
- https://www.google.com/search?q=riboerase+adapter+trimming
- https://genomics.sschmeier.com/ngs-qc/index.html?highlight=phix#phix-genome
- 161. Lo,C.-C. and Chain,P.S.G. (2014) Rapid evaluation and quality
control of next generation sequencing data with FaQCs. BMC
Bioinformatics, 15, doi:10.1186/s12859-014-0366-2.
- . Chen,C., Khaleel,S.S., Huang,H. and Wu,C.H. (2014) Software for
pre-processing Illumina next-generation sequencing short read
sequences. Source Code Biol. Med., 9, doi:10.1186/1751-0473-9-8.
- 165. Del Fabbro,C., Scalabrin,S., Morgante,M. and Giorgi,F.M. (2013)
An extensive evaluation of read trimming effects on Illumina NGS
data analysis. PLoS One, 8, e85024.
- raw read trimming and filtering
  - https://www.biostars.org/p/368420/
  - adapter
    - https://www.ecseq.com/support/ngs/trimming-adapter-sequences-is-it-necessary
    - https://www.biostars.org/p/267388/
    - http://seqanswers.com/forums/showthread.php?t=51226
    - https://github.com/griffithlab/rnaseq_tutorial/wiki/Adapter-Trim
    - do all aligners need adaptor trimming? at least common to do so for all
    - https://www.biostars.org/p/368420/
  - trimming- removing bad ends
    - adaptors
    - low quality bases
  - filering- removing bad reads
    - low quality reads
    - contamination
    - low complexity reads
    - short reads
  - https://www.biostars.org/p/212136/
  - https://www.ecseq.com/support/ngs/trimming-adapter-sequences-is-it-necessary
- https://sequencing.qcfail.com/software/fastqc/
- RNA
  - Do not
    - quality-trim RNA- cite:williams2016a
      - see also - http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0085024
        - w/ commentary here- http://genomebio.org/is-trimming-is-beneficial-in-rna-seq/
      - - https://www.michaelchimenti.com/2016/06/trim-rna-seq-reads/
    - remove duplicate- no necessarly PCR artifact
      - https://www.biostars.org/p/55648/
      - https://www.biostars.org/p/14283/
  - https://www.slideshare.net/joachimjacob/2rna-seqpart2investigatin-rawdata
  - https://sequencing.qcfail.com/applications/mrna-seq/
- [[id:c0c0ee28-2e41-41a7-9a3b-ae195117a93e][LINK TO common sequence file manipulation]]
- QC outputs explained- https://sequencing.qcfail.com/
- see - cite:chen2013 for GC bias and effects on assembly
- [[http://bioinformatics-core-shared-training.github.io/cruk-bioinf-sschool/Day1/fastqc_sweave.pdf][de Santiago,15]]
- [[https://www.danielecook.com/double-checking-fastqs/][nice fastq python]]
- https://wikis.utexas.edu/display/bioiteam/Evaluating+your+raw+sequencing+data
- [[id:1165bc2b-9373-4313-94bd-2a1d7be34fb8][LINK TO aligned sequence qc]]
- reference
  - yas
  - [[id:D2FAA88D-70CC-4450-BBB3-8A446CB43AF3][docker]]
    - dockerfile - include current build status in comments
    - sequencing dockerfile repos
      - https://github.com/broadinstitte/gtex-pipeline.git
      - https://hub.docker.com/u/mgibio/
      - https://hub.docker.com/u/biocontainers
  - https://github.com/genome/gms
  - best practices
    - each tool install as standalone
    - Version control
    - File organization
      - https://libraries.mit.edu/data-management/
      - See [[file:~/maintenance.org::Information Maintenance][information maintenance]] Organization -> File tree structure
    - http://www.broadinstitute.org/gatk/guide/best-practices
      best practices include recording everything
      record of all commands
      record of all software versions
      see Emacs, rpubs.com, sessionInfo and knitR
    - [[http://www.nature.com/sdata/for-authors/submission-guidelines][Nature data submission guidelines]]
    - https://kieranhealy.org/resources/
    - http://kieranhealy.org/files/misc/workflow-apps.pdf
    - see Anders,13
    - no docker in docker for dev- confuses vols, etc. instead add emacs to each container and have local repos of .emacs and org
  - associated mods
    - [[id:43331BB8-4234-48FE-B510-E92F631D5D7B][Code]]
  - compendia
    - [[file:~/Box%20Sync/org/compend.org::*UNIX][UNIX]]
    - [[file:~/.emacs.d/settings.org::*Emacs][Emacs]]
    - git
  - [ ] information management- see cite:griffith2015b
  - https://github.com/cbcrg/lncrna-annotation-nf
  - set alias https://emacs.stackexchange.com/questions/34022/error-initialization-user-has-no-home-directory
  - https://www.nextflow.io/blog/2016/docker-and-nextflow.html
  - https://hub.docker.com/r/mgibio/mark_duplicates-cwl/dockerfile
  - https://hub.docker.com/r/broadinstitute/picard/dockerfile
  - stack
    - ubuntu
    - git and github
    - docker
      - https://github.com/bioinformatics-core-shared-training/docker-4-bioinformatics
      - https://gatkforums.broadinstitute.org/firecloud/discussion/6886/guidelines-for-working-with-docker-images-and-dockerfiles-broadies-only
    - nextflow
      - https://www.youtube.com/watch?v=jsxTC8pNPUc&t=579s
      - https://github.com/cbcrg/lncrna-annotation-nf
      - https://www.nextflow.io/example1.html
      - https://www.nextflow.io/blog/2016/docker-and-nextflow.html
      - commands
        |----------+---------|
        | function | command |
        |----------+---------|
        | <35>     | <35>    |
        |          |         |
      - processes
      - documentation
- ideas
  - Consider more emacs shell work:
  - add to gatk docker
    - https://hub.docker.com/u/broadinstitute
    - https://software.broadinstitute.org/gatk/documentation/tooldocs/3.8-0/org_broadinstitute_gatk_tools_walkers_cancer_m2_MuTect2.php
  - ideas
    - link to documentation- maybe an org and/or markdown file?
    - script comment design
  - https://gatkforums.broadinstitute.org/gatk/discussion/2909/how-to-fix-a-badly-formatted-bam

******* DNA-seq
:PROPERTIES:
:ID:       728e8984-696f-4531-8e76-bf6d78bfa3b7
:END:
- https://www.nature.com/articles/s41586-021-03894-5
- index, adapter, barcode
- https://www.genscript.com/molecular-biology-glossary/11941/genomic-equivalent
- DNA
  - for immuno regulatory regions- https://bmcmedgenomics.biomedcentral.com/articles/10.1186/s12920-016-0220-7
  - for chromatin accessibility
    - ATAC-seq
      - cite:buenrostro2015
      - FAST ATAC- ATAC-Seq optimized for blood
  - DNA for sequence variation
    - variation
      - visualizations
        - - https://mail.google.com/mail/u/0/#inbox/FMfcgxwHNCtwvpXGcckxJfDWPTPKHTst
      - clingen
        - https://www.youtube.com/channel/UCsn4nEVUTpVQz70rClgMMsQ?view_as=subscriber
    - https://gatk.broadinstitute.org/hc/en-us/articles/360035535892-Somatic-copy-number-variant-discovery-CNVs-
    - https://gatk.broadinstitute.org/hc/en-us/articles/360035535912-Data-pre-processing-for-variant-discovery
    - https://gatk.broadinstitute.org/hc/en-us/sections/360007226651-Best-Practices-Workflows
    - https://mail.google.com/mail/u/0/#inbox/FMfcgxwHNWHJNLRlZwfGkGJHwJnBxFlh
  - for sequence homology- cite:stoeger2018
  - cfDNA
    - cite:huang2019
- marking duplicates :process:
  - consider picard markduplicates - https://gatkforums.broadinstitute.org/gatk/discussion/6945/picard-tools-markduplicates-using-cram-format-how-to-pass-a-valid-cram-reference
  - samtools
    - https://samtools.github.io/hts-specs/SAMv1.pdf
    - sort
      - https://www.biostars.org/p/247588/
    - http://www.htslib.org/algorithms/duplicate.html
  - https://qcb.ucla.edu/wp-content/uploads/sites/14/2016/03/GATKwr12-2-Marking_duplicates.pdf
******** [[id:719b2017-4ec6-44dd-8e91-a677bc6654bd][DNA-seq pre-alignment processing and QC]]
:PROPERTIES:
:ID:       af96d992-45ce-4e07-bffd-7cb139fb59a4
:END:
******** Paired tumor-normal sequencing
:PROPERTIES:
:ID:       0496ac54-3250-4fd3-9681-c880aaa296b2
:END:
- https://github.com/mskcc/facets
******** Tumor-only whole exome sequencing
:PROPERTIES:
:CREATED:  [2021-05-01 Sat 07:26]
:ID:       eed43327-3a0c-4f7b-9886-855a88afa02d
:END:
- https://ascopubs.org/doi/full/10.1200/CCI.19.00130
- https://www.cell.com/cell-reports/pdfExtended/S2211-1247(18)31635-8
- cite:carter2012 ABSOLUTE
  - https://software.broadinstitute.org/cancer/cga/absolute
  - https://www.biostars.org/p/175131/
******** DNA Bioinformatics
:PROPERTIES:
:ID:       1C24E3B6-CE16-47C8-8D7B-95EB530560F1
:END:

- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4669575/
- https://github.com/kevinblighe/ClinicalGradeDNAseq
- https://support.illumina.com/sequencing/sequencing_software/bcl2fastq-conversion-software.html

- https://software.broadinstitute.org/gatk/documentation/tooldocs/current/picard_illumina_IlluminaBasecallsToFastq.php

- ffpe
  - cite:munchel2015
  - cite:spencer2013
- Fonseca,12 Tools for mapping high throughput sequencing data(2)
- [[file:~/Box%20Sync/scientific_technique/Cruchaga%20lab%20eQTLs.pptx][Cruchaga eQTLs]]

********* Post-alignment Samtools
:PROPERTIES:
:ID:       2D153E08-9F4A-4564-ACA7-5B4932D1022B
:END:

- nice header review https://sarahpenir.github.io/bioinformatics/awk/calculating-mapping-stats-from-a-bam-file-using-samtools-and-awk/
- Post-alignment
  - samtools
    - [[http://www.htslib.org/][website]]
      - [[http://www.htslib.org/workflow/][workflows]]
      - [[http://www.htslib.org/doc/][documentation]]
        - [[http://www.htslib.org/doc/#publications][publications]]
    - [[https://github.com/samtools/][github]]
    - cite:li2009
    - samtools view sorted.bam | awk '{sum+=$5} END { print "Mean MAPQ =",sum/NR}'
    - [[https://www.biostars.org/p/15953/][biostars: calculate MAPQ]]
    - calc mapq w/ samtools- https://www.biostars.org/p/15953/][Malachi Griffith biostars
- [[http://www.htslib.org/doc/samtools-1.2.html][Documentation]]
- Subset a bam
  - By chromosome
    - e.g.: ​samtools view -b in.bam chr1 > in_chr1.bam
- [[https://www.biostars.org/p/17361/][Picard is Samtools!]]
- Find ummapped reads by flags
- [[http://davetang.org/wiki/tiki-index.php?page=SAMTools#Converting_a_SAM_file_to_a_BAM_file][Sam to Bam, indexing ]]

********* Ideas
:PROPERTIES:
:ID:       F6511EA3-A5B4-455E-99F1-D536EE81F22D
:END:

- [[http://zvfak.blogspot.com/2012/02/samtools-in-parallel.html][run in parallel]]

- incorporate samtools in R workflow via Rsamtools

********* Exome Sequencing Pipeline
:PROPERTIES:
:ID:       57992D53-D767-4E44-9E3F-B4A05E5B4EF1
:END:

********* Specialized Applications
:PROPERTIES:
:ID:       7A9FC47A-2E9E-46D5-8E3E-E7C7C5C5AD9E
:END:

********** Detecting Internal Tandem Duplications
:PROPERTIES:
:ID:       4B340D6D-E38D-42E5-AD1F-3CB0BDF62545
:END:

[[file:~/Box%20Sync/library/Spencer,12%20Detection%20of%20FLT3%20ITD%20in%20short%20read%20length%20NGS.pdf][Spencer,12 Detection of FLT3 ITD in short read length NGS]]

********* DNA Alignment
:PROPERTIES:
:ID:       B2F17B06-C1BA-487A-93EC-D9737584BC0E
:END:

- https://www.youtube.com/watch?v=4n7NPk5lwbI
- - https://www.youtube.com/watch?v=hpb-mH-yjLc&list=PL2mpR0RYFQsBiCWVJSvVAO3OJ2t7DzoHA
- tutorials
  - http://seqinformatics.com/?page_id=160
    - near perfect matches (BLAST not specific)
  - https://www.youtube.com/watch?v=zMAa9gFd2Gs
  - http://www.ngscourse.org/Course_Materials/alignment/tutorial/example.html
  - https://wikis.utexas.edu/display/bioiteam/Mapping+tutorial

********** Novoalign
:PROPERTIES:
:ID:       22097A02-1E18-40BD-BA2F-0D3BC645F0D5
:END:

- cite:Novocraft
- [[http://www.novocraft.com/support/download/][Novoalign]]

********** BWA
:PROPERTIES:
:ID:       83F91393-2108-4785-9696-BDE8EC09FA88
:END:

https://bioinformatics.stackexchange.com/questions/2955/is-there-a-more-elegant-solution-to-the-bwa-mem-paired-reads-have-different-nam

-"bwa concatenates all the references sequences together before aligning. So if a read hangs off of one sequence onto the next, it's given the appropriate mapping position, and the unmapped flag is also set, as a sign that something is off about the alignment."

- sequences should be <3% difference from reference
- A block sorting lossless data compression algorithm
- Compresses the genome as a BWT index
- Identical sequences (genome repeats) only occur once in the index, reads that match the genome in multiple locations get a mapping quality of 0
- output is SAM
- [[http://bio-bwa.sourceforge.net/][Burrows-Wheeler Aligner]]
- [[https://www.biostars.org/t/bwa%20mem/][Biostars BWA Posts]]
- [[http://bio-bwa.sourceforge.net/bwa.shtml][bwa manual]]
  - algorithms
    - backtrack illumina to 100 bp
    - 70 bp to 1 mb
      - sw
      - mem
    - mem is generally recommended
    -

********* Post-Alignment QC
:PROPERTIES:
:ID:       92672d75-9623-4876-a691-880912af62fe
:END:
:PROPERTIES:
:ID:       F689D6FA-071C-4167-BC21-85A7EC20DA41
>>>>>>> bb11343ab3ff683a4ece1c261661becfbc0b872d
:END:

filtering
noncoding, known mis-spliced, mitochondrial, x/y in mixed sex, unannotated

********** Inspection
:PROPERTIES:
:ID:       07602EB8-5EFD-4179-9F55-320190ECE670
:END:

********** Processing
:PROPERTIES:
:ID:       2A4B2B42-C088-4479-BC65-670CC8377D39
:END:

********** FASTX-Toolkit
:PROPERTIES:
:ID:       8169C9DC-FDB6-473E-9B54-E154261186EA
:END:

  - [[http://hannonlab.cshl.edu/fastx_toolkit/commandline.html][documentation]]
  - brew installed on mac, but says, "cannot execute binary file", will have to run from cluster
  - [[http://hannonlab.cshl.edu/fastx_toolkit/commandline.html][Command-line Usage]]
  - the clip can be a .fa file
  - [[http://mgt2.chpc.wustl.edu/wiki119/index.php/FASTX_Toolkit][on cluster]]
  - Clipper
    https://github.com/NCBI-Hackathons/RNA_mapping

********* Broad Best Practices for Variant Discovery in DNAseq
:PROPERTIES:
:ID:       850AA38C-75E9-42E2-8DEE-61F4950BCFDE
:END:

https://software.broadinstitute.org/gatk/documentation/topic?name=methods

******** aligned sequence qc
:PROPERTIES:
:ID:       1165bc2b-9373-4313-94bd-2a1d7be34fb8
:END:
- https://sarahpenir.github.io/bioinformatics/awk/calculating-mapping-stats-from-a-bam-file-using-samtools-and-awk/
- coverage
  - cite:illumina2014
  - Picard CollectWgsMetrics
********* coverage and depth
:PROPERTIES:
:ID:       a4dcf0d6-1619-4f82-989d-2bd599cdf061
:END:
- https://www.illumina.com/content/dam/illumina-marketing/documents/products/technotes/hiseq-x-30x-coverage-technical-note-770-2014-042.pdf
- https://www.biostars.org/p/331957/
- https://www.htslib.org/doc/samtools-depth.1.html#OPTIONS
- for coverage https://www.biostars.org/p/104063/
******** capture probes and barcoding
:PROPERTIES:
:ID:       675eba72-76e5-4b49-81e9-37bdc02cce9b
:END:
https://mail.google.com/mail/u/0/#inbox/FMfcgzGpFWNbSMxNkbQTTtVwBpvBltDq
https://support.illumina.com/bulletins/2018/08/understanding-unique-dual-indexes--udi--and-associated-library-p.html
https://www.illumina.com/content/dam/illumina-marketing/documents/products/whitepapers/index-hopping-white-paper-770-2017-004.pdf
https://www.google.com/search?q=calculation+probability+of+sequence+mismatch&oq=calculation+probability+of+sequence+mismatch&aqs=chrome..69i57j33.12480j0j7&client=ubuntu&sourceid=chrome&ie=UTF-8
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3245947/
- capture probe design
  - https://ascopubs.org/doi/full/10.1200/CCI.19.00077?url_ver=Z39.88-2003&rfr_id=ori%3Arid%3Acrossref.org&rfr_dat=cr_pub%3Dpubmed
   Contigs: group of sequences representing overlapping regions from a genome or transcriptome.
- [[https://wikis.utexas.edu/display/GSAF/Illumina+-+all+flavors][illumina adaptors explained]]
- adaptor strategies
  - https://sfvideo.blob.core.windows.net/sitefinity/docs/default-source/case-study/idt_improved-coverage-uniformity-with-xgen-lockdown-panels-case-study.pdf?sfvrsn=c33d1907_6
  - https://sfvideo.blob.core.windows.net/sitefinity/docs/default-source/protocol/idt_xgen-prism-dna-library-prep-kit-quick-reference-guide.pdf?sfvrsn=6fe71207_4
  - https://sfvideo.blob.core.windows.net/sitefinity/docs/default-source/user-guide-manual/xgen-prism-dna-library-prep-kit-processing-sequencing-data-with-umis.pdf?sfvrsn=22991407_10
  - https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-017-4428-5#MOESM1
- UMI
  - - [[http://www.genomics.agilent.com/article.jsp?pageId=3081][HaloPlex]]
  - - https://cgatoxford.wordpress.com/2015/08/14/unique-molecular-identifiers-the-problem-the-solution-and-the-proof/
- barcoding
  - 10x
- https://pdfs.semanticscholar.org/310b/3bac42989485c98406848217418ff22c22e7.pdf
- barcodes and adaptors for increased sensitivity
  - cite:kennedy2014
  - cite:newman2016
  - cite:wang2019
  - https://www.youtube.com/watch?v=HIVCQ7iaowk
  - newman2016
    - adaptor informatics
      - consensus building
        - set "family size"
        -
    - error base signature
      - C>A C>T
  - wang2019
    - IDT xGen
      - blocks adaptor to limit off-target
      - Cot-1 blocks repetitve regions
    - method explanation followed by experiments to validate
      - present experiments as condition vs. condition

- see edit distance in [[id:A91BF233-F14E-4E91-A1E9-B39802A9ED2D][Computers, Computer Science, and Information Technology]]
******* [[id:61aac189-1770-4d80-a367-e7c39b46e0d1][Adaptive TCR-beta immunosequencing]]
:PROPERTIES:
:ID:       7c98bf05-a2a7-438b-a2c5-2f51bd5cb47f
:END:
******* [[id:ccab4617-0399-4ba3-828e-b5fbbb972ba1][Whole-genome sequencing]]
:PROPERTIES:
:ID:       897de413-a06b-40c5-8b97-4dcc6adcc8c3
:END:



****** Code associated with sequence reference builds
:PROPERTIES:
:ID:       767e5e30-8490-4cda-8018-8b0bd91c4ef3
:END:
- need wget for github-             'https://raw.githubusercontent.com/Boyle-Lab/Blacklist/blob/master/lists/mm10-blacklist.v2.bed.gz')
#+begin_src bash
ref_dir=/mnt/local/users/jeszyman/data/ref/raw_downloads

assemblies=('http://ftp.ensembl.org/pub/release-104/fasta/rattus_norvegicus/dna/Rattus_norvegicus.Rnor_6.0.dna.toplevel.fa.gz'
            'http://ftp.ensembl.org/pub/release-104/fasta/rattus_norvegicus/cdna/Rattus_norvegicus.Rnor_6.0.cdna.all.fa.gz'
            'https://ftp.ncbi.nlm.nih.gov/genomes/genbank/vertebrate_mammalian/Mus_musculus/latest_assembly_versions/GCA_000001635.9_GRCm39/GCA_000001635.9_GRCm39_genomic.fna.gz'
            'https://ftp.ncbi.nlm.nih.gov/genomes/genbank/vertebrate_mammalian/Mus_musculus/latest_assembly_versions/GCA_000001635.9_GRCm39/GCA_000001635.9_GRCm39_genomic.gtf.gz'
            'https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/001/635/GCA_000001635.8_GRCm38.p6/GCA_000001635.8_GRCm38.p6_genomic.fna.gz'
            'https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/001/635/GCA_000001635.8_GRCm38.p6/GCA_000001635.8_GRCm38.p6_genomic.gtf.gz'
            'http://hgdownload.cse.ucsc.edu/goldenpath/mm10/bigZips/latest/mm10.fa.gz'
            'https://hgdownload.soe.ucsc.edu/goldenPath/mm10/bigZips/genes/mm10.knownGene.gtf.gz')

for i in "${assemblies[@]}";
do
    wget \
        --continue \
        --directory-prefix $ref_dir \
        --execute robots=off \
        --no-check-certificate \
        --no-parent \
        --timestamping $i
    file=$(echo $i | sed "s/^.*\///g")
    base=$(basename -s .gz "$file")
done


    # if [ "${file: -3}" == ".gz" ] && [ $ref_dir/$base -ot $ref_dir/$file ];
    # then
    #     gunzip --to-stdout $ref_dir/$file > $ref_dir/$base
    # fi
#+end_src

#+begin_src bash
bwa index \
    --algoType bwtsw \
    --prefix $prefix \
    $fasta
#+end_src
- pull down common reference sequences
  #+name: reference_pull
  #+begin_src bash
#########1#########2#########3#########4#########5#########6#########7#########8
#
wget --no-clobber https://hgdownload.soe.ucsc.edu/goldenPath/rn6/bigZips/genes/rn6.ensGene.gtf.gz -O /mnt/users/jeszyman/data/rn6.ensGene.gtf.gz
#
gunzip -c /mnt/users/jeszyman/data/rn6.ensGene.gtf.gz > /mnt/users/jeszyman/data/rn6.ensGene.gtf
#

cd /mnt/users/jeszyman/data
rsem-prepare-reference --gtf ./rn6.ensGene.gtf \
#                       --bowtie \
                       ./rn6.fa \
                       rsem_ref

#+end_src
****** Sequencing target data types and methods
:PROPERTIES:
:ID:       52f360bb-28b1-444a-a2df-ca9313ab249a
:END:
******* Motifs
:PROPERTIES:
:ID:       8edce2af-9ca0-44ab-aed3-0e27eb2b4ce0
:END:
https://academic.oup.com/genetics/article/216/2/353/6066178
******* Sequence similarity and patterns
:PROPERTIES:
:ID:       508ac0df-9d93-4455-a451-cb876f83498d
:END:
- https://www.nature.com/articles/nature12477

<<<<<<< HEAD
  #########1#########2#########3#########4#########5#########6#########7#########8
  #
  # ichorCNA
  ##
  ## linux dependencies
  RUN apt-get update \
     && apt-get install -y \
     libcurl4-openssl-dev \
     libssl-dev \
     libxml2-dev
  #RUN rm /usr/lib/x86_64-linux-gnu/libcurl.so.4
  #RUN ln -s /usr/lib/x86_64-linux-gnu/libcurl.so.4.5.0 /usr/lib/x86_64-linux-gnu/libcurl.so.4
  ##
  ## R dependencies
  RUN R -e 'install.packages("BiocManager"); BiocManager::install(); BiocManager::install("HMMcopy"); BiocManager::install("GenomeInfoDb"); BiocManager::install("GenomicRanges");'
  ##
  ## git clone install
  RUN cd /opt \
      && git clone https://github.com/broadinstitute/ichorCNA.git \
      && cd ichorCNA \
      && R CMD INSTALL . \
      && cd /opt
  ##
  #RUN echo "source activate py2" > ~/.bashrc
  #ENV PATH /opt/conda/envs/py2/bin:$PATH
****** [[file:docker/rna_Dockerfile][RNA docker]]
:PROPERTIES:
:ID:       db8041c2-939d-47a0-92a9-ff9321f6ac91
:END:
=======
******* Sequence variation and variant calling
:PROPERTIES:
:ID:       2e14b8be-894e-4a32-bb5b-561d4c1097ba
:END:
>>>>>>> bb11343ab3ff683a4ece1c261661becfbc0b872d
:PROPERTIES:
:ID:       57E81A44-3233-479B-8264-2CD5F1904A60
:END:
:LOGBOOK:
CLOCK: [2020-07-07 Tue 12:17]--[2020-07-07 Tue 12:52] =>  0:35
CLOCK: [2019-04-26 Fri 11:28]--[2019-04-26 Fri 11:44] =>  0:16
CLOCK: [2019-04-26 Fri 11:03]--[2019-04-26 Fri 11:13] =>  0:10
CLOCK: [2019-04-26 Fri 10:43]--[2019-04-26 Fri 10:57] =>  0:14
:END:
<<<<<<< HEAD
******* Preamble
:PROPERTIES:
:ID:       1c3263f1-8ace-4e8e-a690-99798d819603
:END:
#+begin_src bash
FROM jeszyman/biotools:1.0.2
################################################################################
################################################################################
###                                                                          ###
###         Dockerfile to build an RNA-focused docker image                  ###
###                                                                          ###
################################################################################
################################################################################

#################
###   Notes   ###
#################
#
# After build, the image will be pushed to the dockerhub as
# jeszyman/rna
# (https://hub.docker.com/repository/docker/jeszyman/rna)

#+end_src
******* Conda
:PROPERTIES:
:ID:       a39a87c2-e66f-44c0-96cc-a4cf8482786e
:END:
#+begin_src bash
RUN conda install -c bioconda kallisto
RUN conda install -c bioconda rsem
RUN conda install -c bioconda star
RUN conda install -c bioconda subread
RUN conda install -c bioconda salmon
#+end_src
******* R and Bioconductor
:PROPERTIES:
:ID:       482a65d1-28e2-4494-b49a-eb53f721f35e
:END:
#+begin_src bash
RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("DESeq2", \
                                 "edgeR", \
                                 "fgsea", \
                                 "limma", \
                                 "tximport"));'

#+end_src
******* Custom installs
:PROPERTIES:
:ID:       d9ee8d9e-55e0-4c71-9162-ed774488ae65
:END:
#+begin_src bash
RUN cd /opt && git clone https://github.com/rajewsky-lab/mirdeep2 && cd /opt/mirdeep2 && perl install.pl

RUN /bin/bash

RUN cd /opt/mirdeep2 && perl install.pl

ENV PATH="/opt/mirdeep2/bin:${PATH}"
#+end_src
****** [[file:docker/atac_Dockerfile][ATAC-seq docker]]
:PROPERTIES:
:ID:       1e71d7ee-2c47-4f37-bc49-771ec5786fc4
:END:
#+begin_src bash :tangle ./docker/atac_Dockerfile
FROM jeszyman/biotools:1.0.2
#########1#########2#########3#########4#########5#########6#########7#########8

###################################
###   Dockerfile for ATAC-seq   ###
###################################

# After build, the image will be pushed to dockerhub as jeszyman/atac
# (https://hub.docker.com/repository/docker/jeszyman/atac)

RUN apt-get -y update && apt-get upgrade -y

# Simple bioconda installs
RUN conda install -c bioconda macs2

# Simple R installs
##
## Via Bioconductor
RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("ATACseqQC", \
                                 "ChIPpeakAnno", \
                                 "ChIPseeker", \
                                 "clusterProfiler", \
                                 "csaw"));'


# ATACseqQC
##
## Linux prerequisites
RUN apt-get install -yq --no-install-recommends --allow-unauthenticated --fix-missing \
    libgsl-dev \
    libcurl4-openssl-dev
    #libssl-dev
##
## ATACseqQC
RUN R -e 'install.packages("BiocManager"); \
    BiocManager::install(); \
    BiocManager::install(c("ATACseqQC"));'

# Homer
RUN mkdir /opt/homer
RUN cd /opt/homer
RUN wget http://homer.ucsd.edu/homer/configureHomer.pl -O /opt/homer/configureHomer.pl
RUN perl /opt/homer/configureHomer.pl -install

ENV PATH="${PATH}:/opt/homer/bin/"

RUN perl /opt/homer/.//configureHomer.pl -install mouse-p

RUN conda install -c bioconda samtools=1.7

# R CRAN Installs
RUN R -e "install.packages(c('statmod', repos='http://cran.rstudio.com/'))"

#+end_src
*** Metabolomics
:PROPERTIES:
:CREATED:  [2020-10-08 Thu 09:15]
:ID:       fce92cb5-cf68-4944-b2f4-eff55996ec5f
:END:
https://www.sciencedirect.com/science/article/pii/S1097276515003032
https://www.medrxiv.org/content/10.1101/2021.02.05.21251173v1
- http://www.visantnet.org/visantnet.html
**** Metabolomics
:PROPERTIES:
:CREATED:  [2020-10-08 Thu 09:15]
:ID:       fce92cb5-cf68-4944-b2f4-eff55996ec5f
:END:
https://www.sciencedirect.com/science/article/pii/S1097276515003032
https://www.medrxiv.org/content/10.1101/2021.02.05.21251173v1
- http://www.visantnet.org/visantnet.html
*** Bioinformatics visualizations
:PROPERTIES:
:ID:       2d0863b4-fe7a-4cc5-b940-2e5f45153432
:END:
https://www.reddit.com/r/bioinformatics/comments/12ddk5r/what_genomics_plot_types_are_appealing_to_wet/
- [[id:c0359d9c-246a-41fb-a9b4-05ea5cb546ab][Biomarker visualizations]]
*** Probability and statistics related to bioinformatics
:PROPERTIES:
:ID:       1768b182-858a-46f8-97a8-4cd9747a2361
:END:
- https://www.reddit.com/r/bioinformatics/comments/teeywx/advicebooks_for_getting_started_on_mathematical/
[[id:ee66da5b-aa64-4535-af72-5d98976871ff][clinical prediction models]]
- https://www.nature.com/articles/s41576-019-0130-6
- https://www.pnas.org/content/107/21/9546
- cite:tarazona2020
- https://cran.r-project.org/web/packages/NMF/vignettes/NMF-vignette.pdf
- Pavlou M, Ambler G, Seaman SR, Guttmann O, Elliott P, King M, et al. How to develop a more accurate risk prediction model when there are few events. BMJ 2015;351:h3868.
- https://www.liebertpub.com/doi/abs/10.1089/cmb.2004.11.714

**** Clustering and cluster analysis
:PROPERTIES:
:ID:       5372195f-b5fd-41da-8020-a87533c6e74a
:END:
https://stackoverflow.com/questions/42674102/extracting-members-of-cluster-pheatmap
https://www.datanovia.com/en/lessons/determining-the-optimal-number-of-clusters-3-must-know-methods/

https://www.reddit.com/r/statistics/comments/t3ok40/q_is_there_any_difference_between_latent_profile/
- https://www.reddit.com/r/statistics/comments/t6gudh/q_how_to_evaluate_clustering_in_dimensionality/
- http://statweb.stanford.edu/~susan/courses/stats305c/examplesClusters.html
- https://bookdown.org/rdpeng/exdata/k-means-clustering.html
- https://www.datanovia.com/en/lessons/cluster-analysis-example-quick-start-r-code/
- https://academic.oup.com/biostatistics/article/19/1/71/3852318
**** [[*Machine learning in genomics and bioinformatics][LINK TO Machine learning in genomics and bioinformatics]]
:PROPERTIES:
:ID:       f514af07-e639-468d-9dea-890de6da16e5
:END:
*** Proteomics
:PROPERTIES:
:ID:       e01aba61-2ea4-4235-a237-b0b90b49f153
:END:
https://www.nature.com/articles/s41586-023-06802-1
- liquid biopsy somascan https://www.cell.com/cell/fulltext/S0092-8674(23)01033-4#secsectitle0090

https://www.sciencedirect.com/science/article/pii/S1535610823002192#sec1.3
https://bioone.org/journals/radiation-research/volume-198/issue-6/RADE-22-00074.1/Prediction-of-Total-Body-and-Partial-Body-Exposures-to-Radiation/10.1667/RADE-22-00074.1.short
https://www.kavrakilab.org/nci-1u01ca258512-01.html
https://www.science.org/doi/10.1126/science.abj1541
https://www.science.org/doi/10.1126/science.abj1541
https://www.degruyter.com/document/doi/10.1515/hsz-2017-0104/html
https://www.annualreviews.org/doi/10.1146/annurev-anchem-071015-041535
https://analyticalsciencejournals.onlinelibrary.wiley.com/doi/full/10.1002/pmic.201800247
https://analyticalsciencejournals.onlinelibrary.wiley.com/doi/epdf/10.1002/pmic.200800417
https://pubs.acs.org/doi/10.1021/pr400132j
https://www.embopress.org/doi/full/10.15252/msb.20156297
https://pubs.acs.org/doi/10.1021/acs.jproteome.5b0090
1https://www.sciencedirect.com/science/article/pii/S2212968513000044?via%3Dihub#fig0005
https://analyticalsciencejournals.onlinelibrary.wiley.com/doi/full/10.1002/pmic.201300377
https://www.mdpi.com/2227-7382/1/2/109/htm
https://www.olink.com/data-you-can-trust/technology/
Mass Spectrometry

 MASCOT peptide mass fingerprint
 SILAC (stable isotope labeling by amino acids in cell culture)

 LC/MS- 1995- 166. Appella, E., Padlan, E. A. & Hunt, D. F. Analysis of the
 structure of naturally processed peptides bound by
 class I and class II major histocompatibility complex
 molecules. Exs 73, 105–119 (1995).

 iTraq
 By Technique
 MALDI-TOF
 MS/MS
 By Experimental Design


- [[id:179b243b-e6c0-484c-81ef-e8bff57e7f46][Circulating biomarkers]]
- proteome dynamic range is ~10^12, machine limit is usually ~10^3
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6096388/
- https://link.springer.com/article/10.1007%2Fs00216-012-6203-4#Sec14
- https://www.nature.com/articles/nprot.2017.040
- label-free
  - bioinformatics
    - MaxQuant https://www.maxquant.org/
    - Perseus
      - https://link.springer.com/protocol/10.1007/978-1-4939-7493-1_7
      - http://coxdocs.org/doku.php?id=perseus:start
**** SOMAscan
:PROPERTIES:
:ID:       89b4ec6d-992d-4551-81da-19011597732a
:END:
:LOGBOOK:
CLOCK: [2021-08-30 Mon 13:28]--[2021-08-30 Mon 14:10] =>  0:42
:END:
- somascan examples
  - https://www.ncbi.nlm.nih.gov/pubmed/27327800
- cite:yang2020
- cite:joshi2018
- cite:candia2017
- cite:wilcox2016
- isolation for somascan
  - http://mohanlab.bme.uh.edu/wp-content/uploads/2015/09/HOU-SOMAscan-Methods-2016.pdf
- per-reviewed protocols
  - https://link.springer.com/protocol/10.1007%2F978-1-4939-9706-0_13
- [[https://mail.google.com/mail/u/0/#inbox/FMfcgxwGCtQssVccPJsjlFklhgFHqJGd][email: GTAC SOMAscan notes]]
- https://mail.google.com/mail/u/0/#inbox/FMfcgxwGCtQssVccPJsjlFklhgFHqJGd
- https://www.sciencedirect.com/science/article/pii/S1874391916304006
- For protein, SOMAscan has a higher dynamic range and lower limit of detection than comparable Luminex antibody-based assays (cite doi.org/10.1038/s41591-019-0665-2). Moreover, SOMAscan includes targets such as Jagged-1 and -2 not available for multiplexed antibody assays.
**** Proteomics
:PROPERTIES:
:ID:       e01aba61-2ea4-4235-a237-b0b90b49f153
:END:
https://ashpublications.org/blood/article/doi/10.1182/blood.2022016033/486036/Proteomic-and-Phosphoproteomic-Landscapes-of-Acute
https://www.science.org/doi/10.1126/science.abj1541
https://www.science.org/doi/10.1126/science.abj1541
https://www.degruyter.com/document/doi/10.1515/hsz-2017-0104/html
https://www.annualreviews.org/doi/10.1146/annurev-anchem-071015-041535
https://analyticalsciencejournals.onlinelibrary.wiley.com/doi/full/10.1002/pmic.201800247
https://analyticalsciencejournals.onlinelibrary.wiley.com/doi/epdf/10.1002/pmic.200800417
https://pubs.acs.org/doi/10.1021/pr400132j
https://www.embopress.org/doi/full/10.15252/msb.20156297
https://pubs.acs.org/doi/10.1021/acs.jproteome.5b0090
1https://www.sciencedirect.com/science/article/pii/S2212968513000044?via%3Dihub#fig0005
https://analyticalsciencejournals.onlinelibrary.wiley.com/doi/full/10.1002/pmic.201300377
https://www.mdpi.com/2227-7382/1/2/109/htm
https://www.olink.com/data-you-can-trust/technology/
Mass Spectrometry

 MASCOT peptide mass fingerprint
 SILAC (stable isotope labeling by amino acids in cell culture)

 LC/MS- 1995- 166. Appella, E., Padlan, E. A. & Hunt, D. F. Analysis of the
 structure of naturally processed peptides bound by
 class I and class II major histocompatibility complex
 molecules. Exs 73, 105–119 (1995).

 iTraq
 By Technique
 MALDI-TOF
 MS/MS
 By Experimental Design


- [[id:179b243b-e6c0-484c-81ef-e8bff57e7f46][Circulating biomarkers]]
- proteome dynamic range is ~10^12, machine limit is usually ~10^3
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6096388/
- https://link.springer.com/article/10.1007%2Fs00216-012-6203-4#Sec14
- https://www.nature.com/articles/nprot.2017.040
- label-free
  - bioinformatics
    - MaxQuant https://www.maxquant.org/
    - Perseus
      - https://link.springer.com/protocol/10.1007/978-1-4939-7493-1_7
      - http://coxdocs.org/doku.php?id=perseus:start
***** SOMAscan
:PROPERTIES:
:ID:       89b4ec6d-992d-4551-81da-19011597732a
:END:
:LOGBOOK:
CLOCK: [2021-08-30 Mon 13:28]--[2021-08-30 Mon 14:10] =>  0:42
:END:
- somascan examples
  - https://www.ncbi.nlm.nih.gov/pubmed/27327800
- cite:yang2020
- cite:joshi2018
- cite:candia2017
- cite:wilcox2016
- isolation for somascan
  - http://mohanlab.bme.uh.edu/wp-content/uploads/2015/09/HOU-SOMAscan-Methods-2016.pdf
- per-reviewed protocols
  - https://link.springer.com/protocol/10.1007%2F978-1-4939-9706-0_13
- [[https://mail.google.com/mail/u/0/#inbox/FMfcgxwGCtQssVccPJsjlFklhgFHqJGd][email: GTAC SOMAscan notes]]
- https://mail.google.com/mail/u/0/#inbox/FMfcgxwGCtQssVccPJsjlFklhgFHqJGd
- https://www.sciencedirect.com/science/article/pii/S1874391916304006
- For protein, SOMAscan has a higher dynamic range and lower limit of detection than comparable Luminex antibody-based assays (cite doi.org/10.1038/s41591-019-0665-2). Moreover, SOMAscan includes targets such as Jagged-1 and -2 not available for multiplexed antibody assays.
**** Illumina protein prep
:PROPERTIES:
:ID:       052b5d06-5f71-4a86-b4eb-5d59cbb6b622
:END:
- ~10k targets
*** Systems biology
:PROPERTIES:
:ID:       228D364B-48C8-49E4-9B00-FBFD52384623
:END:
https://www.reddit.com/r/bioinformatics/comments/11ym1x9/multiomics_integration_and_analysis_tutorials/
https://www.reddit.com/r/bioinformatics/comments/11ym1x9/multiomics_integration_and_analysis_tutorials/
- http://xena.ucsc.edu/
- https://www.mdpi.com/1099-4300/22/6/627
- https://www.sciencedirect.com/science/article/pii/S2589004222015486
- cite:sanchez-vega2018
- https://www.sciencedirect.com/science/article/pii/S2666166721004755
- https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-3016-x
- http://bioportal.bioontology.org/ontologies/GO/?p=classes&conceptid=root
- pathways
  - pathways
   Pathway Browsers and Visualizers
   GenMAPP
   http://cytoscapeweb.cytoscape.org/
   NCBI BioStstems (pathway diagrams)
   NCI Pathway Interaction Database
   http://www.reactome.org/ReactomeGWT/entrypoint.html
   NIH Molecular Interaction Maps
   Pathvisio
   Pathvisio pathway styles
   Wikipathways
- Geurts,09 Supervised learning with decision tree-based methods in computational.pdf
- Breker,09 Explorations in topology–delving underneath the surface of genetic.pdf
- Lima-Mendez,09 The powerful law of the power law and other myths in network biologyw.pdf
- - [[http://science.sciencemag.org/content/353/6306/aaf1420][A global genetic interaction network maps a wiring diagram of cellular function]]
- cite:chicco2017
- cite:sen2014
- cytoscape
  - https://github.com/mohd-akram/languages
  - [[http://www.nature.com/nmeth/journal/v9/n11/full/nmeth.2212.html][cytoscape plugins]]
- http://acacia.atspace.eu/Tutorial/Tutorial.html
- - http://amp.pharm.mssm.edu/Enrichr/#stats
- - https://academic.oup.com/bioinformatics/article-lookup/doi/10.1093/bioinformatics/btr656
- https://toppgene.cchmc.org/
- Pathway analysis
  - https://www.pathvisio.org/documentation/tutorials/tutorial-1/
  - cite:Khatri_2012
- GEDI (Gene Expression Dynamics Inspector)
 Website
 Software v.2.1 Manual
 Invented Eichler,03
 Traditional hierarchical clustering and self organizing maps do not idnetify genome-wide emergent phenotypic profiles
 Uses self organizing map to reduce dimensionality into miniclusters of 1-9 genes and create mosic patterns
- Kitano H (2002) Looking beyond the details: A rise in system-oriented approaches in genetics and molecular biology. Curr Genet 41: 1–10.
- Kitano H (2002) Systems biology: A brief overview. Science 295: 1662–1664.
- Ehrenberg M, Elf J, Aurell E, Sandberg R, Tegner J (2003) Systems biology is taking off. Genome Res 13: 2377–2380.
- http://www.springer.com/us/book/9780387989921
**** [[id:91d46e60-eec3-48c7-97f1-b53eb1559b3f][Co-expression]]
**** [[id:abb6fc6c-07d9-4375-a8f6-a87370f5c0ea][Multivariate biomarker discovery methods]]
:PROPERTIES:
:ID:       34a99004-090f-44c6-a721-f5f1054e5b1f
:END:
- iPANDA
  - https://www.nature.com/articles/ncomms13427#Sec10
    - https://github.com/varnivey/ipanda/blob/master/MANUAL.txt
- JCO top cited biomarker studies
      - with cfDNA copy number
        - cite:stover2018
        - cite:slaven2018
      - past 1 year
        - innocenti2019.pdf
        - loi2019.pdf
        - ott2019.pdf
      - past 5 years
        - oxnard2016.pdf
        - roemer2016.pdf
        - fribbens2016.pdf
        - rizvi2018.pdf
**** Systems biology
:PROPERTIES:
:ID:       228D364B-48C8-49E4-9B00-FBFD52384623
:END:
- cite:sanchez-vega2018
- https://www.sciencedirect.com/science/article/pii/S2666166721004755
- https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-3016-x
- http://bioportal.bioontology.org/ontologies/GO/?p=classes&conceptid=root
- pathways
  - pathways
   Pathway Browsers and Visualizers
   GenMAPP
   http://cytoscapeweb.cytoscape.org/
   NCBI BioStstems (pathway diagrams)
   NCI Pathway Interaction Database
   http://www.reactome.org/ReactomeGWT/entrypoint.html
   NIH Molecular Interaction Maps
   Pathvisio
   Pathvisio pathway styles
   Wikipathways
- Geurts,09 Supervised learning with decision tree-based methods in computational.pdf
- Breker,09 Explorations in topology–delving underneath the surface of genetic.pdf
- Lima-Mendez,09 The powerful law of the power law and other myths in network biologyw.pdf
- - [[http://science.sciencemag.org/content/353/6306/aaf1420][A global genetic interaction network maps a wiring diagram of cellular function]]
- cite:chicco2017
- cite:sen2014
- cytoscape
  - https://github.com/mohd-akram/languages
  - [[http://www.nature.com/nmeth/journal/v9/n11/full/nmeth.2212.html][cytoscape plugins]]
- http://acacia.atspace.eu/Tutorial/Tutorial.html
- - http://amp.pharm.mssm.edu/Enrichr/#stats
- - https://academic.oup.com/bioinformatics/article-lookup/doi/10.1093/bioinformatics/btr656
- https://toppgene.cchmc.org/
- Pathway analysis
  - https://www.pathvisio.org/documentation/tutorials/tutorial-1/
  - cite:Khatri_2012
- GEDI (Gene Expression Dynamics Inspector)
 Website
 Software v.2.1 Manual
 Invented Eichler,03
 Traditional hierarchical clustering and self organizing maps do not idnetify genome-wide emergent phenotypic profiles
 Uses self organizing map to reduce dimensionality into miniclusters of 1-9 genes and create mosic patterns
- Kitano H (2002) Looking beyond the details: A rise in system-oriented approaches in genetics and molecular biology. Curr Genet 41: 1–10.
- Kitano H (2002) Systems biology: A brief overview. Science 295: 1662–1664.
- Ehrenberg M, Elf J, Aurell E, Sandberg R, Tegner J (2003) Systems biology is taking off. Genome Res 13: 2377–2380.
- http://www.springer.com/us/book/9780387989921
***** LINK TO [[id:91d46e60-eec3-48c7-97f1-b53eb1559b3f][Co-expression]]
:PROPERTIES:
:ID:       632d1c7d-aecc-4ad5-85ad-0f26571e454d
:END:
***** [[id:abb6fc6c-07d9-4375-a8f6-a87370f5c0ea][Multivariate biomarker discovery methods]]
:PROPERTIES:
:ID:       34a99004-090f-44c6-a721-f5f1054e5b1f
:END:
- JCO top cited biomarker studies
      - with cfDNA copy number
        - cite:stover2018
        - cite:slaven2018
      - past 1 year
        - innocenti2019.pdf
        - loi2019.pdf
        - ott2019.pdf
      - past 5 years
        - oxnard2016.pdf
        - roemer2016.pdf
        - fribbens2016.pdf
        - rizvi2018.pdf
*** Online GUIs
:PROPERTIES:
:ID:       f7064e3f-6d40-4fb2-b8cd-1c8c519bd7f8
:END:
https://hgserver1.amc.nl/cgi-bin/r2/main.cgi?open_page=login
*** Coordinate-based genomics visualization tracks
:PROPERTIES:
:ID:       29821fa1-acfe-4a74-9c5d-a24adddf2969
:END:
- https://cmdcolin.github.io/awesome-genome-visualization/?citations=-1&tag=Coverage
- https://rockefelleruniversity.github.io/RU_VisualizingGenomicsData/exercises/answers/Viz_part1_answers.html

- motif tracks https://bioconductor.org/packages/release/bioc/vignettes/motifStack/inst/doc/motifStack_HTML.html
- plotgardener
- soGGi https://bioconductor.org/packages/release/bioc/vignettes/soGGi/inst/doc/soggi.pdf
- aggregate signal based
  - https://bioconductor.org/packages/release/bioc/vignettes/metagene2/inst/doc/metagene2.html
  - https://bioconductor.org/packages/release/bioc/vignettes/chromstaR/inst/doc/chromstaR.pdf
  - https://bioconductor.org/packages/release/bioc/vignettes/CoverageView/inst/doc/CoverageView.pdf
  - https://bioconductor.org/packages/release/bioc/vignettes/profileplyr/inst/doc/profileplyr.html
- specific signal-based
  - https://www.bioconductor.org/packages/release/bioc/vignettes/wiggleplotr/inst/doc/wiggleplotr.html
  - gviz
    - https://bioconductor.org/packages/devel/bioc/vignettes/Gviz/inst/doc/Gviz.html
    - https://rockefelleruniversity.github.io/RU_VisualizingGenomicsData/exercises/answers/Viz_part1_answers.html
    - https://bioconductor.org/packages/release/bioc/vignettes/GenVisR/inst/doc/Intro.html
  - https://bioconductor.org/packages/release/bioc/vignettes/soGGi/inst/doc/soggi.pdf
  - https://phanstiellab.github.io/plotgardener/reference/plotSignal.html
*** EM-seq
:PROPERTIES:
:ID:       85e691cc-ebb3-4d74-825b-1c9204fb9c96
:END:
- New England Biolabs materials
  - [[https://www.neb.com/en-us/products/e7120-nebnext-enzymatic-methyl-seq-kit#FAQs---Troubleshooting][Troubleshooting]]
  - [[https://github.com/nebiolabs/EM-seq/tree/master][EM-seq repo]]
  - Technical note [cite:@emseq2021] (largely mirroring the vaisvila2021 paper)
  - Initial publication: [cite:@vaisvila2021]
  - [[cite:&emseq2023manual]]
- Initial publication: [cite:@vaisvila2021]
- Scopus citing vaisvila2021 https://www-scopus-com.mclibrary.idm.oclc.org/search/save/action.uri?activity=allAction&userSearchID=3&origin=savedsearch
- [[id:d9b52bbd-ec6a-4b9e-af4b-17f6efafdcf6][Methylation sequencing biotools process]]
- [cite:@bie2023] uses EM-seq for multimodal cfDNA analysis including fragmentomics. They validate EM-seq fragments ~ WGS fragments
- [cite:@an2023] uses EM-seq to show that hypo-methylated fragments are shorter
*** Single-cell methods
:PROPERTIES:
:ID:       2597b54c-972a-43c3-9630-0e542ba90eeb
:END:
https://www.reddit.com/r/bioinformatics/comments/1kc5a5t/newbie_in_singlecell_omics_any_top_lab_work_to/
https://www.reddit.com/r/bioinformatics/comments/1keqtce/designing_rnaseq_experiments_with_confidence_no/
https://mail.google.com/mail/u/0/#inbox/FMfcgzGxTFWDgPhqMLGHBDfJrdBMrWXq
https://www.nature.com/articles/s41587-023-01685-z
#+begin_src R
library(Seurat)
library(patchwork)

library(SingleR)
library(celldex)

library(glmGamPoi)


#library(future)
#plan(multisession, workers = 8)

female_tg_rt = readRDS("/mnt/ris/cbergom/Active/scrna/Bergom_SR003528_10X/Seurat_5_GEX_Analysis_Resolution_0.8/SR003528_8-Female_TG_RT_Seurat_Analysis_0.8_Resolution/SR003528_8-Female_TG_RT.RDS")

female_tg_sham = readRDS("/mnt/ris/cbergom/Active/scrna/Bergom_SR003528_10X/Seurat_5_GEX_Analysis_Resolution_0.8/SR003528_7-Female_TG_sham_Seurat_Analysis_0.8_Resolution/SR003528_7-Female_TG_sham.RDS")

male_tg_sham = readRDS("/mnt/ris/cbergom/Active/scrna/Bergom_SR003528_10X/Seurat_5_GEX_Analysis_Resolution_0.8/SR003528_3-Male_TG_sham_Seurat_Analysis_0.8_Resolution/SR003528_3-Male_TG_sham.RDS")

male_tg_rt = readRDS("/mnt/ris/cbergom/Active/scrna/Bergom_SR003528_10X/Seurat_5_GEX_Analysis_Resolution_0.8/SR003528_4-Male_TG_RT_Seurat_Analysis_0.8_Resolution/SR003528_4-Male_TG_RT.RDS")

#########1#########2#########3#########4#########5#########6#########7#########8

male_tg_sham$condition <- 'sham'
male_tg_rt$condition <- 'rt'

male_tg <- merge(male_tg_sham, y = list(male_tg_rt), add.cell.ids = c("sham", "rt"), project = "male_tg")

male_tg = SCTransform(male_tg)

male_tg = RunPCA(male_tg)

ElbowPlot(male_tg)

male_tg <- RunUMAP(male_tg, dims = 1:10)  # Adjust dims as needed based on PCA output

DimHeatmap(male_tg, dims = 1:10, cells = 500, balanced = TRUE)

male_tg
test = PrepSCTFindMarkers(macrophages)



DimPlot(male_tg, reduction = "umap", group.by = "condition")


#########1#########2#########3#########4#########5#########6#########7#########8
# Ensure the default assay is set to RNA (or the relevant assay for your analysis)
DefaultAssay(male_tg)
male_tg
# Convert to SingleCellExperiment again, ensuring the assay data is included
sce <- as.SingleCellExperiment(male_tg)
# Assuming 'male_tg' is your Seurat object and you want to use 'counts' data from the 'SCT' assay
sce <- as.SingleCellExperiment(x = male_tg, assay = "SCT", layer = "counts")
sce

refData <- celldex::ImmGenData()

predictions <- SingleR(test = sce, assay.type.test = 1, ref = refData, labels = refData$label.main)

male_tg$singleR_predictions <- predictions$labels


DimPlot(male_tg, reduction = "umap", group.by = "singleR_predictions")
DimPlot(male_tg, reduction = "umap", group.by = "condition")



p1 = DimPlot(male_tg, reduction = "umap", group.by = "singleR_predictions")
p2 = DimPlot(male_tg, reduction = "umap", group.by = "condition")
combined = p1 + p2
combined

keep_type = c("Macrophages", "Monocytes", "Stromal cells", "Endothelial cells")

male_sub = subset(male_tg, subset = singleR_predictions %in% keep_type)

p1 = DimPlot(male_sub, reduction = "umap", group.by = "singleR_predictions")
p2 = DimPlot(male_sub, reduction = "umap", group.by = "condition")
combined = p1 + p2
combined

#########1#########2#########3#########4#########5#########6#########7#########8
# Subset male_tg to only stromal cells
stromal_cells <- subset(male_tg, subset = singleR_predictions == "Stromal cells")

stromal_cells = PrepSCTFindMarkers(stromal_cells)

# Set condition as the identity for differential expression analysis
Idents(stromal_cells) <- stromal_cells$condition
stromal_de_genes <- FindMarkers(stromal_cells, ident.1 = "rt", ident.2 = "sham")


#########1#########2#########3#########4#########5#########6#########7#########8


endothelial = subset(male_tg, subset = singleR_predictions == "Endothelial cells")
endothelial = PrepSCTFindMarkers(endothelial)

Idents(endothelial) <- endothelial$condition
endothelial_de_genes <- FindMarkers(endothelial, ident.1 = "rt", ident.2 = "sham")

test = FindMarkers(endothelial, assay = "SCT", ident.1 = "rt", ident.2 = "sham", recorrect_umi = F)


macrophages <- subset(male_tg, subset = singleR_predictions == "Macrophages")

macrophages = PrepSCTFindMarkers(macrophages, assay = "SCT")

# Set condition as the identity for differential expression analysis
Idents(macrophages) <- macrophages$condition

macrophages_de_genes <- FindMarkers(macrophages, ident.1 = "rt", ident.2 = "sham")

library(tidyverse)

head(de_genes, n = 20)
de_genes %>% row_names
grep("cd47", row.names(de_genes), value = T, ignore.case = T)

stromal_markers <- FindAllMarkers(stromal_cells, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)

macrophages = JoinLayers(macrophages)
female_tg_trans <- PrepSCTFindMarkers(female_tg_trans)

test = PrepSCTFindMarkers(macrophages)


markers <- FindAllMarkers(macrophages, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)


# Differential expression analysis to find genes predictive of condition rt vs sham
de_genes <- FindMarkers(stromal_cells, ident.1 = "rt", ident.2 = "sham")

# Subset for "Macrophage" cells
macrophages <- subset(male_tg, subset = singleR_predictions == "Stromal cells")
DimPlot(macrophages, reduction = "umap", group.by = "condition")

#########1#########2#########3#########4#########5#########6#########7#########8

female_tg_sham$condition <- 'sham'
female_tg_rt$condition <- 'rt'

female_tg <- merge(female_tg_sham, y = list(female_tg_rt), add.cell.ids = c("sham", "rt"), project = "female_tg")

female_tg = SCTransform(female_tg)

female_tg = RunPCA(female_tg)

ElbowPlot(female_tg)

female_tg <- RunUMAP(female_tg, dims = 1:10)  # Adjust dims as needed based on PCA output

DimHeatmap(female_tg, dims = 1:10, cells = 500, balanced = TRUE)

DimPlot(female_tg, reduction = "umap", group.by = "condition")


#########1#########2#########3#########4#########5#########6#########7#########8
# Ensure the default assay is set to RNA (or the relevant assay for your analysis)
DefaultAssay(female_tg)
female_tg

# Assuming 'female_tg' is your Seurat object and you want to use 'counts' data from the 'SCT' assay
sce <- as.SingleCellExperiment(x = female_tg, assay = "SCT", layer = "counts")
sce

refData <- celldex::ImmGenData()

female_predictions <- SingleR(test = sce, assay.type.test = 1, ref = refData, labels = refData$label.main)

female_tg$singleR_predictions <- female_predictions$labels


p1 = DimPlot(female_tg, reduction = "umap", group.by = "singleR_predictions")
p2 = DimPlot(female_tg, reduction = "umap", group.by = "condition")

combined = p1 + p2
combined

keep_type = c("Macrophages", "Monocytes", "Stromal cells", "Endothelial cells")

female_sub = subset(female_tg, subset = singleR_predictions %in% keep_type)

p1 = DimPlot(female_sub, reduction = "umap", group.by = "singleR_predictions")
p2 = DimPlot(female_sub, reduction = "umap", group.by = "condition")
combined = p1 + p2
combined





#########1#########2#########3#########4#########5#########6#########7#########8

macrophages <- RunUMAP(macrophages, dims = 1:15)  # Adjust dims as needed

pdf("/mnt/ris/cbergom/Active/szymanski/tmp/merge_macro.pdf")

dev.off()

# Assuming you've correctly prepared 'sce' from your Seurat object
# and you're using a predefined reference dataset:


dim(sce)


#########1#########2#########3#########4#########5#########6#########7#########8

test = readRDS("/mnt/ris/cbergom/Active/scrna/Bergom_SR003528_10X/Seurat_5_GEX_Analysis_Resolution_0.8/SR003528_8-Female_TG_RT_Seurat_Analysis_0.8_Resolution/SR003528_8-Female_TG_RT.RDS")



#########1#########2#########3#########4#########5#########6#########7#########8

# Normalize data
male_tg <- NormalizeData(male_tg)

# Find variable features
male_tg <- FindVariableFeatures(male_tg)

# Scale data
male_tg <- ScaleData(male_tg)

# Run PCA
male_tg <- RunPCA(male_tg, features = VariableFeatures(object = male_tg))

# Run UMAP
ElbowPlot(test)
ElbowPlot(male_tg)

male_tg <- RunUMAP(male_tg, dims = 1:15)  # Adjust dims as needed based on PCA output

#########1#########2#########3#########4#########5#########6#########7#########8

test = readRDS("/mnt/ris/cbergom/Active/scrna/Bergom_SR003528_10X/Seurat_5_GEX_Analysis_Resolution_0.8/SR003528_8-Female_TG_RT_Seurat_Analysis_0.8_Resolution/SR003528_8-Female_TG_RT.RDS")

DimHeatmap(test, dims = 1:15, cells = 500, balanced = TRUE)



test = FindNeighbors(test, dims = 1:10)
test = FindClusters(test, resolution = 0.5)

head(Idents(test), 5)

test = RunUMAP(test, dims = 1:10)

DimPlot(test, reduction = "umap")

#########1#########2#########3#########4#########5#########6#########7#########8


if (!requireNamespace("remotes", quietly = TRUE))
  install.packages("remotes")
remotes::install_github("satijalab/seurat-data")

library(SeuratData)


InstallData("ifnb")

#install.packages("~/ifnb.SeuratData_3.1.0.tar.gz", repos = NULL, type = "source")

# load dataset
ifnb <- LoadData("ifnb")
# split the RNA measurements into two layers one for control cells, one for stimulated cells

ifnb[["RNA"]] <- split(ifnb[["RNA"]], f = ifnb$stim)



ifnb

# run standard anlaysis workflow
ifnb <- NormalizeData(ifnb)
ifnb <- FindVariableFeatures(ifnb)
ifnb <- ScaleData(ifnb)
ifnb <- RunPCA(ifnb)

ifnb <- FindNeighbors(ifnb, dims = 1:30, reduction = "pca")
ifnb <- FindClusters(ifnb, resolution = 2, cluster.name = "unintegrated_clusters")

ifnb <- RunUMAP(ifnb, dims = 1:30, reduction = "pca", reduction.name = "umap.unintegrated")
DimPlot(ifnb, reduction = "umap.unintegrated", group.by = c("stim", "seurat_clusters"))

ifnb <- IntegrateLayers(object = ifnb, method = CCAIntegration, orig.reduction = "pca", new.reduction = "integrated.cca",
    verbose = FALSE)

# re-join layers after integration
ifnb[["RNA"]] <- JoinLayers(ifnb[["RNA"]])

ifnb <- FindNeighbors(ifnb, reduction = "integrated.cca", dims = 1:30)
ifnb <- FindClusters(ifnb, resolution = 1)

ifnb <- RunUMAP(ifnb, dims = 1:30, reduction = "integrated.cca")

DimPlot(ifnb, reduction = "umap", group.by = c("stim", "seurat_annotations"))

DimPlot(ifnb, reduction = "umap", split.by = "stim")

Idents(ifnb) <- "seurat_annotations"

install.packages('BiocManager')
BiocManager::install('multtest')
install.packages('metap')

nk.markers <- FindConservedMarkers(ifnb, ident.1 = "NK", grouping.var = "stim", verbose = FALSE)
head(nk.markers)




names(female_tg_sham)

female_tg_sham$condition <- 'sham'
female_tg_rt$condition <- 'rt'

female_tg <- merge(female_tg_sham, y = list(female_tg_rt), add.cell.ids = c("sham", "rt"), project = "female_tg")

install.packages('BiocManager')
BiocManager::install('glmGamPoi')

test = SCTransform(female_tg)

female_tg_trans = RunPCA(female_tg_trans)

# Find clusters
female_tg_trans <- FindNeighbors(female_tg_trans, dims = 1:30)
female_tg_trans <- FindClusters(female_tg_trans, resolution = 0.5)  # Adjust resolution as needed

# Prepare the Seurat object for differential expression analysis
female_tg_trans <- PrepSCTFindMarkers(female_tg_trans)

test = PrepSCTFindMarkers(macrophages)
macrophages = JoinLayers(macrophages)

markers <- FindAllMarkers(macrophages, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)

grep("if", rownames(markers), value = T, ignore.case = T)

# Find markers
markers <- FindAllMarkers(female_tg_trans, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)


#########1#########2#########3#########4#########5#########6#########7#########8
female_tg_trans = readRDS("/tmp/female_tg_trans.rds")

markers = readRDS("/tmp/markers.rds")

library(SingleR)

refData <- celldex::ImmGenData() # Example for mouse immune cells


# run standard anlaysis workflow
female_tg_sham <- NormalizeData(female_tg_sham)
female_tg_sham <- FindVariableFeatures(female_tg_sham)
female_tg_sham <- ScaleData(female_tg_sham)
female_tg_sham <- RunPCA(female_tg_sham)


# Ensure the default assay is set to RNA (or the relevant assay for your analysis)
DefaultAssay(female_tg_sham) <- "RNA"

# Convert to SingleCellExperiment again, ensuring the assay data is included
sce <- as.SingleCellExperiment(female_tg_sham)

library(SingleR)
library(celldex)

if (is.null(refData) || is.null(refData$label)) {
  stop("Reference data or labels are missing.")
}

# Inspect the metadata of the reference dataset
metadata(refData)

# Alternatively, inspect colData if metadata doesn't give clues
colData(refData)

# Extract cell type annotations from colData
cellTypeLabels <- colData(refData)$cellType

# If the above line doesn't directly work, it means identifying the correct column name
# where the labels are stored is necessary. Adjust 'cellType' accordingly.
predictions <- SingleR(test = sce, ref = refData, labels = cellTypeLabels)

# Run SingleR
predictions <- SingleR(test = sce, assay.type.test = 1, ref = refData, labels = refData$label.main)

table(predictions$labels)

#########1#########2#########3#########4#########5#########6#########7#########8

# run standard anlaysis workflow
female_tg_rt <- NormalizeData(female_tg_rt)
female_tg_rt <- FindVariableFeatures(female_tg_rt)
female_tg_rt <- ScaleData(female_tg_rt)
female_tg_rt <- RunPCA(female_tg_rt)

# Ensure the default assay is set to RNA (or the relevant assay for your analysis)
DefaultAssay(female_tg_rt) <- "RNA"

# Convert to SingleCellExperiment again, ensuring the assay data is included
sce <- as.SingleCellExperiment(female_tg_rt)


# Run SingleR
predictions_rt <- SingleR(test = sce, assay.type.test = 1, ref = refData, labels = refData$label.main)

# Assuming 'female_tg_sham' is your original Seurat object
# and 'predictions_rt' contains your SingleR predictions
female_tg_sham$singleR_predictions <- predictions_sham$labels

pdf("/mnt/ris/cbergom/Active/szymanski/tmp/cells.pdf")
DimPlot(female_tg_sham, reduction = "umap", group.by = "singleR_predictions")
dev.off()

female_tg_rt$singleR_predictions <- predictions_rt$labels

pdf("/mnt/ris/cbergom/Active/szymanski/tmp/cells_rt.pdf")
DimPlot(female_tg_rt, reduction = "umap", group.by = "singleR_predictions")
dev.off()

table(predictions_rt$labels)

predictions_sham = predictions


#########1#########2#########3#########4#########5#########6#########7#########8
female_tg_sham$condition <- 'sham'
female_tg_rt$condition <- 'rt'

female_tg <- merge(female_tg_sham, y = list(female_tg_rt), add.cell.ids = c("sham", "rt"), project = "female_tg")

# Normalize data
female_tg <- NormalizeData(female_tg)

# Find variable features
female_tg <- FindVariableFeatures(female_tg)

# Scale data
female_tg <- ScaleData(female_tg)

# Run PCA
female_tg <- RunPCA(female_tg, features = VariableFeatures(object = female_tg))

# Run UMAP
female_tg <- RunUMAP(female_tg, dims = 1:15)  # Adjust dims as needed based on PCA output


DimPlot(female_tg, reduction = "umap", group.by = "singleR_predictions")

pdf("/mnt/ris/cbergom/Active/szymanski/tmp/merge.pdf")
DimPlot(female_tg, reduction = "umap", group.by = "condition")
dev.off()

pdf("/mnt/ris/cbergom/Active/szymanski/tmp/merge_cells.pdf")
DimPlot(female_tg, reduction = "umap", group.by = "singleR_predictions")
dev.off()

# Subset for "Macrophage" cells
macrophages <- subset(female_tg, subset = singleR_predictions == "Macrophages")
macrophages <- RunUMAP(macrophages, dims = 1:15)  # Adjust dims as needed

pdf("/mnt/ris/cbergom/Active/szymanski/tmp/merge_macro.pdf")
DimPlot(macrophages, reduction = "umap", group.by = "condition")
dev.off()

pdf("/mnt/ris/cbergom/Active/szymanski/tmp/merge_cells_macro.pdf")
DimPlot(macrophages, reduction = "umap", group.by = "singleR_predictions")
dev.off()

table(female_tg$condition)
macrophages <- subset(female_tg, subset = singleR_predictions == "Macrophages")
table(macrophages$condition)

# Set identities based on the 'condition' column
macrophages$active.ident <- macrophages$condition

# Attempt to find markers again
markers_rt_vs_sham <- FindMarkers(macrophages, ident.1 = "rt", ident.2 = "sham", min.pct = 0.25, logfc.threshold = 0.25)

Idents(macrophages) <- macrophages$condition

levels(Idents(macrophages))

markers_rt_vs_sham <- FindMarkers(macrophages, ident.1 = "rt", ident.2 = "sham", min.pct = 0.25, logfc.threshold = 0.25)

markers_rt_vs_sham <- FindMarkers(macrophages, ident.1 = "rt", ident.2 = "sham", min.pct = 0.25, logfc.threshold = 0.25)

head(macrophages$condition)
# Identify markers for differentiation between 'rt' and 'sham'

markers_rt_vs_sham <- FindMarkers(macrophages, ident.1 = "rt", ident.2 = "sham", min.pct = 0.25, logfc.threshold = 0.25)


install.packages('BiocManager')
BiocManager::install('glmGamPoi')

test = SCTransform(female_tg)

female_tg_trans = RunPCA(female_tg_trans)

# Find clusters
female_tg_trans <- FindNeighbors(female_tg_trans, dims = 1:30)
female_tg_trans <- FindClusters(female_tg_trans, resolution = 0.5)  # Adjust resolution as needed

# Prepare the Seurat object for differential expression analysis
female_tg_trans <- PrepSCTFindMarkers(female_tg_trans)
ls()

# Find markers
markers <- FindAllMarkers(female_tg_trans, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)


#########1#########2#########3#########4#########5#########6#########7#########8

# Check results
head(predictions$labels)

# Proceed with SingleR for cell type prediction
predictions <- SingleR(test = sce, ref = refData, labels = refData$label)


# Before running SingleR, check that sce contains expression data
if (any(dim(counts(sce)) == 0)) {
  stop("No counts data found in SingleCellExperiment object. Check the conversion process.")
}

# Assuming 'female_tg_sham' is your Seurat object and it has RNA assay set as default

# Ensure log-normalized data is present
if (!"RNA" %in% names(Assays(female_tg_sham))) {
  stop("RNA assay not found in Seurat object.")
}

# Convert Seurat object to SingleCellExperiment
sce <- as.SingleCellExperiment(female_tg_sham)

# Check if 'logcounts' needs to be added
if (!"logcounts" %in% assayNames(sce)) {
  # Assuming log-normalized data is in the 'data' slot of the Seurat object
  # You might need to adjust this based on where your log-normalized data resides
  logcounts <- GetAssayData(female_tg_sham, slot = "data")
  assays(sce)$logcounts <- Matrix::Matrix(logcounts, sparse = TRUE)
}

# Verify 'logcounts' is now part of the SCE object
if (!"logcounts" %in% assayNames(sce)) {
  stop("'logcounts' not successfully added to SingleCellExperiment object.")
}

# Now, try running SingleR again with the adjusted SCE object
predictions <- SingleR(test = sce, ref = refData, labels = refData$label)

# Proceed with SingleR, ensuring you have the correct reference dataset
predictions <- SingleR(test = sce, ref = refData, labels = refData$label)

predictions <- SingleR(test = as.SingleCellExperiment(female_tg_sham), ref = refData, labels = refData$label)

seuratObject$predictedCellType <- predictions$labels

#########1#########2#########3#########4#########5#########6#########7#########8

female_tg_trans = RunUMAP(female_tg_trans, dims = 1:30)

test = DimPlot(female_tg_trans, reduction = "umap", group.by = c("condition", "seurat_clusters"))

test = DimPlot(female_tg_trans, reduction = "umap", group.by = c("condition"))

plot2 <- DimPlot(female_tg_trans, reduction = "umap", group.by = "seurat_clusters")

# Subset the Seurat object to include only specific clusters
female_tg_subset <- subset(female_tg_trans, idents = c("3","4","5","6","7","8"))

# Now, plot the UMAP for the subsetted data
plot2_subset <- DimPlot(female_tg_subset, reduction = "umap", group.by = "seurat_clusters")

# Display the plot

pdf("/mnt/ris/cbergom/Active/szymanski/tmp/test3.pdf")
plot2_subset
dev.off()

cluster3.markers <- FindMarkers(female_tg_trans, ident.1 = 3)
head(cluster3.markers, n = 5)

# Filter for cluster 3 and sort by logFC in descending order to get the top markers
cluster_3_markers <- markers[markers$cluster == 3, ]

names(cluster_3_markers)

(top_10_markers_cluster_3 <- head(cluster_3_markers[order(cluster_3_markers$avg_log2FC, decreasing = TRUE), ], 10))
markers3 = row.names(top_10_markers_cluster_3)

test =FeaturePlot(female_tg_trans, features = markers3)

pdf(test, file= "/mnt/ris/cbergom/Active/szymanski/tmp/feat_plot_3.pdf", width = 20)
test
dev.off()

cluster_4_markers <- markers[markers$cluster == 4, ]
(top_10_markers_cluster_4 <- head(cluster_4_markers[order(cluster_4_markers$avg_log2FC, decreasing = TRUE), ], 10))
markers4 = row.names(top_10_markers_cluster_4)
pdf(test, file= "/mnt/ris/cbergom/Active/szymanski/tmp/feat_plot_4.pdf")
FeaturePlot(female_tg_trans, features = markers4)
dev.off()

cluster_6_markers <- markers[markers$cluster == 6, ]
(top_10_markers_cluster_6 <- head(cluster_6_markers[order(cluster_6_markers$avg_log2FC, decreasing = TRUE), ], 10))
markers6 = row.names(top_10_markers_cluster_6)
pdf(test, file= "/mnt/ris/cbergom/Active/szymanski/tmp/feat_plot_6.pdf")
FeaturePlot(female_tg_trans, features = markers6)
dev.off()


# Find differential markers between cluster 3 and cluster 4
differential_markers <- FindMarkers(female_tg_trans, ident.1 = "3", ident.2 = "4", min.pct = 0.1, logfc.threshold = 0.75)
(clust3_v_4 = head(differential_markers[order(abs(differential_markers$avg_log2FC), decreasing = T),],10))
markers3v4 = row.names(clust3_v_4)
pdf(file= "/mnt/ris/cbergom/Active/szymanski/tmp/feat_plot_3_v_4.pdf", width = 15)
FeaturePlot(female_tg_trans, features = markers3v4)
dev.off()

markers3v4 = c("Hcn1", "Txnip", "Pdk4", "Nr4a1", "Ifi27", "Ddx60")
pdf(file= "/mnt/ris/cbergom/Active/szymanski/tmp/feat_plot_3_v_4.pdf")
FeaturePlot(female_tg_trans, features = markers3v4)
dev.off()

# Find differential markers between cluster 3 and cluster 4
differential_markers <- FindMarkers(female_tg_trans, ident.1 = "4", ident.2 = "6", min.pct = 0.1, logfc.threshold = 0.75)
(clust4_v_6 = head(differential_markers[order(abs(differential_markers$avg_log2FC), decreasing = T),],15))
markers4v6 = row.names(clust4_v_6)
pdf(file= "/mnt/ris/cbergom/Active/szymanski/tmp/feat_plot_4_v_6.pdf", width = 20)
FeaturePlot(female_tg_trans, features = markers4v6)
dev.off()

# Sort the results to get the most significant markers at the top
# Assuming sorting by p-value; you can also sort by logFC if you're interested in the magnitude of change
sorted_markers <- differential_markers[order(differential_markers$p_val_adj), ]

# View the top differential markers
head(sorted_markers, n = 5)

# Display the top 5 markers for cluster 3
top_5_markers_cluster_3


#########1#########2#########3#########4#########5#########6#########7#########8

female_tg[["RNA"]] = split(female_tg[["RNA"]], f = female_tg$condition)

library(Seurat)

# Assuming female_tg_rt and female_tg_sham are your loaded Seurat objects

# Step 0: Address potential duplicated cell names (Seurat should handle this automatically, as per the warning, but ensure unique cell names if needed)

# 1. Select integration features across the datasets
features.to.integrate <- SelectIntegrationFeatures(object.list = list(female_tg_rt, female_tg_sham), nfeatures = 3000)

print(class(female_tg_rt))
print(class(female_tg_sham))

options(future.globals.maxSize = 8000 * 1024^2)
# Prep the list of Seurat objects for SCT integration

pancreas.list.prepped <- PrepSCTIntegration(
  object.list = list(female_tg_rt, female_tg_sham),
  anchor.features = features.to.integrate
)

class(pancreas.list.prepped)


# 2. Prepare for SCT integration by scaling data and storing necessary information for integration
female_tg_rt <- PrepSCTIntegration(object = female_tg_rt, anchor.features = features.to.integrate)
female_tg_sham <- PrepSCTIntegration(object = female_tg_sham, anchor.features = features.to.integrate)

# 3. Find integration anchors using the prepared data
integration.anchors <- FindIntegrationAnchors(object.list = list(female_tg_rt, female_tg_sham),
                                              normalization.method = "SCT",
                                              anchor.features = features.to.integrate)

# 4. Integrate the data
integrated.data <- IntegrateData(anchorset = integration.anchors)

# Optional: Proceed with the analysis (scaling, PCA, UMAP, clustering) on the integrated dataset
integrated.data <- ScaleData(integrated.data)
integrated.data <- RunPCA(integrated.data)
integrated.data <- RunUMAP(integrated.data, dims = 1:30)
integrated.data <- FindNeighbors(integrated.data, dims = 1:30)
integrated.data <- FindClusters(integrated.data, resolution = 0.5)

# Now, integrated.data is ready for downstream analysis

#########1#########2#########3#########4#########5#########6#########7#########8


female_tg_sham
test = CreateAssay5Object(counts = female_tg$counts)




head(


# Set the RNA assay as active and normalize
female_tg_sham <- NormalizeData(object = SwitchAssay(female_tg_sham, "RNA"), normalization.method = "LogNormalize", scale.factor = 10000)
female_tg_rt <- NormalizeData(object = SwitchAssay(female_tg_rt, "RNA"), normalization.method = "LogNormalize", scale.factor = 10000)



# Merge the datasets
female_tg <- merge(female_tg_sham, y = list(female_tg_rt), add.cell.ids = c("sham", "rt"), project = "female_tg")

table(female_tg$condition)

library(Seurat)

# Step 1: Select integration features
features <- SelectIntegrationFeatures(object.list = list(female_tg_sham, female_tg_rt), nfeatures = 3000)

# Select features for integration
features <- SelectIntegrationFeatures(object.list = list(female_tg_sham, female_tg_rt))

# Prep each object for SCT integration
female_tg_sham <- PrepSCTIntegration(object = female_tg_sham, anchor.features = features)
female_tg_rt <- PrepSCTIntegration(object = female_tg_rt, anchor.features = features)

# Find integration anchors
anchors <- FindIntegrationAnchors(object.list = list(female_tg_sham, female_tg_rt), normalization.method = "SCT", anchor.features = features)

# Integrate the data
female_tg <- IntegrateData(anchorset = anchors)


#########1#########2#########3#########4#########5#########6#########7#########8

# Assuming features is correctly defined
# Prepare both objects for integration
list_of_objects <- list(female_tg_sham, female_tg_rt)
list_of_objects_prep <- lapply(list_of_objects, function(x) {
  PrepSCTIntegration(object = x, anchor.features = features)
})


# Step 2: Prep SCT integration
# This creates a list of Seurat objects with a new assay named "SCT" containing the data for integration
female_tg_sham <- PrepSCTIntegration(object = female_tg_sham, anchor.features = features)

female_tg_rt <- PrepSCTIntegration(object = female_tg_rt, anchor.features = features)

# Step 3: Find integration anchors using the prepared data
anchors <- FindIntegrationAnchors(object.list = list(female_tg_sham, female_tg_rt),
                                  normalization.method = "SCT")

# Step 4: Integrate the data
female_tg <- IntegrateData(anchorset = anchors)

# run standard anlaysis workflow
female_tg <- NormalizeData(female_tg)

# (JFC this loads a lot of shit)
install.packages('BiocManager')
BiocManager::install('glmGamPoi')

# Re-run SCTransform on the merged dataset
female_tg <- SCTransform(female_tg, vars.to.regress = "percent.mt", verbose = FALSE)

# Proceed with the analysis
female_tg <- FindVariableFeatures(female_tg)

female_tg <- FindVariableFeatures(female_tg)

female_tg <- ScaleData(female_tg)
female_tg <- RunPCA(female_tg)
#+end_src

**** [[id:99ee4bd0-060e-4109-9901-29aa7fafd816][Single nucleus and single cell methods applied to heart]]
:PROPERTIES:
:ID:       c6f0444d-cc0d-4ace-aa59-cc643b993b7b
:END:
**** [[id:992de4dc-775e-41f0-a70a-e38c99b87265][Single cell methylation sequencing]]
:PROPERTIES:
:ID:       d38b29c9-2cdb-4f20-a353-70b195ee778e
:END:
**** Good practice
:PROPERTIES:
:ID:       f6418486-9a29-4a65-9145-2a2a3ac788a7
:END:
- [[cite:&slyper2020]]
- [[cite:&luecken2019]]
- cite:heumos2023 and associated [[https://www.sc-best-practices.org/preamble.html#peer-review][ebook]]
- cite:slyper2020
- https://www.nature.com/articles/s41576-023-00586-w
**** Well-done applications
:PROPERTIES:
:ID:       800e407d-3980-482b-ba9a-cd57b5938adc
:END:
- cite:storrs2022
- Li Ding pancreas - https://www.nature.com/articles/s41588-022-01157-1
- cite:qi2019
**** single-nucleus RNA-seq
:PROPERTIES:
:ID:       1149b091-eabe-4137-a3e9-222f21bfdd57
:END:
- https://www.nature.com/articles/s41591-020-0844-1
**** Jointly defining cell states from singl-cell multi-omic and spatial tanscriptomic datasest
:PROPERTIES:
:ID:       76cd9647-825f-46b4-9344-b7b95049f2f6
:END:
:LOGBOOK:
CLOCK: [2021-11-02 Tue 11:01]--[2021-11-02 Tue 11:26] =>  0:25
:END:
- https://event.on24.com/eventRegistration/console/EventConsoleApollo.jsp?&eventid=3478709&sessionid=1&username=&partnerref=&format=fhaudio&mobile=&flashsupportedmobiledevice=&helpcenter=&key=87791679E10838FA9DCF16C96D7F22F8&newConsole=true&nxChe=true&newTabCon=true&consoleEarEventConsole=false&text_language_id=en&playerwidth=748&playerheight=526&eventuserid=488203953&contenttype=A&mediametricsessionid=422205446&mediametricid=4883132&usercd=488203953&mode=launch
- liger cell welch 2019 linked inference of henomic experimental relationships
- scalable, iteratifve integration with online iNMF gai nature biotechnology 2021
-
**** General                                                            :ref:
:PROPERTIES:
:ID:       c877b498-ca0f-48c7-927c-0d6fe0a82dd0
:END:
- inputs and pre-processing
  - https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-02048-6
  - https://genomebiology.biomedcentral.com/articles/10.1186/s13059-017-1171-9
- [[id:1acf73b6-ca1e-458c-91c1-b93f17b80a02][single-cell illumina workshop [2019-09-10 Tue 09:00-15:30]​]]
- Single cell data integration cite:stuart2019
- applications
  - [[id:7bb87c84-6b06-44ef-9a1d-1bb9b9e57295][immunoprofiling]]
  - intra-tumor heterogeneity / [[id:12cfb78c-7912-4c68-b0f4-e2f90c112185][tumor microenvironment]]
    - cite:lawson2018
- simulated data https://genomebiology.biomedcentral.com/articles/10.1186/s13059-023-02904-1
- https://www.sciencedirect.com/science/article/pii/S1097276516301861?via%3Dihub
- Tutorials, guides, good practice
  - Sanger Institute https://www.singlecellcourse.org/
  - EMBL-EBI https://www.ebi.ac.uk/training/events/single-cell-rna-seq-analysis-using-r-virtual/
  - https://www.reddit.com/r/bioinformatics/comments/uy9g1j/where_to_start_with_scrnaseq_data/
  - https://www.embopress.org/doi/full/10.15252/msb.20188746
  - https://mobile.twitter.com/nomad421/status/1522554692202598403?s=20&t=UObG4oqigCp6gJIIgmyhPA
- Reviews
  - https://www.nature.com/articles/nmeth.4612
  - cite:stuart2019
- Multi-cell pathway analysis - https://bioengineeringcommunity.nature.com/posts/dialogue-maps-multicellular-programs-in-tissue-from-single-cell-or-spatial-transcriptomics-data
- Integrating multiple single cell data sets - Harmony - https://www.nature.com/articles/s41592-019-0619-0

**** Time-based analysis
:PROPERTIES:
:ID:       4f5d6aee-a1d0-43f6-9286-ee932de4b4bb
:END:
- RNA velocity - scVelo RNA velocity  [[https://scvelo.readthedocs.io/][site]]
**** Single cell methylation sequencing
:PROPERTIES:
:ID:       992de4dc-775e-41f0-a70a-e38c99b87265
:END:
https://www.nature.com/articles/nmeth.3035
https://www.nature.com/articles/s41467-018-03149-4
[[id:2597b54c-972a-43c3-9630-0e542ba90eeb][Single-cell methods]]
**** Single cell ATAC-seq
:PROPERTIES:
:ID:       7b83aff5-3020-4aa9-9cb0-4222f41817a0
:END:
- https://www.nature.com/articles/s41467-021-21583-9#Sec2
**** single-nucleus RNA-seq
:PROPERTIES:
:ID:       1149b091-eabe-4137-a3e9-222f21bfdd57
:END:
- cite:grindberg2013
- https://www.nature.com/articles/s41591-020-0844-1

**** single-cell RNA sequencing (scRNA-seq)
:PROPERTIES:
:ID:       2bbeb644-af54-4f07-80ad-3584e1e21b04
:END:
- https://www.reddit.com/r/bioinformatics/comments/1ccufty/how_do_you_guys_annotate_your_scrna_cell_clusters/
- example
  - https://www.cell.com/cell-reports/pdfExtended/S2211-1247(20)30162-5
  - https://hub.hku.hk/bitstream/10722/271189/1/content.pdf?accept=1
- clustering and identification algorithms - https://www.nature.com/articles/s41467-023-36383-6
- trajectory inference
  - Monocle 2
  - Slingshot
  - TSCAN
  - Wishbone
- https://cancerdiscovery.aacrjournals.org/content/early/2021/12/22/2159-8290.CD-RW2021-181

https://www.nature.com/articles/s41587-022-01452-6
https://www.embopress.org/doi/full/10.15252/msb.20188746
- https://www.biorxiv.org/content/biorxiv/early/2019/02/05/541433.full.pdf
- examples
  - - see fig 3 & methods https://genome.cshlp.org/content/27/2/208.full.pdf
- https://www.nature.com/articles/s41587-020-0553-9
- 10x
  - applications - https://pages.10xgenomics.com/nur-gen-research-area-literature.html?src=email&utm_medium=email&lss=nurture&utm_source=nurture&cnm=es-nurture-ra_g-general&utm_campaign=es-nurture-ra_g-general&utm_content=&utm_term=&useroffertype=marketing-literature&userresearcharea=ra_g&userregion=&userrecipient=customer&mktouserid=1265915&cid=&usercampaignid=
- https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0212031
- http://www.nature.com/nbt/journal/v34/n2/full/nbt.3445.html
- https://www.10xgenomics.com/videos
- https://www.nature.com/articles/s41591-021-01276-y
- [[id:2bbeb644-af54-4f07-80ad-3584e1e21b04][single-cell RNA sequencing (scRNA-seq)]]
- https://bioconductor.org/packages/release/bioc/vignettes/FlowSOM/inst/doc/FlowSOM.pdf
- https://chanzuckerberg.github.io/scRNA-python-workshop/analysis/05-diffexp.html
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6914766/
- https://www.nature.com/articles/s41467-019-12235-0
- http://www.kumc.edu/genomics/genome-sequencing-facility/services/chromium-single-cell-5-and-v(d)j-enrichment.html
- https://www.10xgenomics.com/solutions/vdj/
- https://research.medgenome.com/ngs-services/single-cell-sequencing/
- https://www.sciencedirect.com/science/article/pii/S1097276517300497#fig1
- https://www.biorxiv.org/content/10.1101/615013v1
- https://www.youtube.com/watch?v=Wbusqowyu6g&t=147s
- cite:monaco2019
- cite:see2018
- toolkits
  - Seurat
  - Monocle 2
  - scVI
- clustering
  - SC3
  - SIMLR
  - CIDR
  - SNN-Cliq
  - Biscuit
- imputing dropouts
  - MAGIC
  - scImpute
  - SAVER
- https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/mkfastq
- http://www.partek.com/free-trial/
- https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger
- https://github.com/koash/cellranger-docker
- https://satijalab.org/seurat/v3.0/pbmc3k_tutorial.html
- http://core-genomics.blogspot.com/2016/07/10x-genomics-single-cell-3mrna-seq.html
- https://www.frontiersin.org/articles/10.3389/fcell.2018.00108/full
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6292934/
- https://www.sciencedirect.com/science/article/pii/S1097276515002610?via%3Dihub
- https://www.ncbi.nlm.nih.gov/pubmed/26000846/
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5561556/
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6131190/
- https://www.nature.com/articles/s41598-019-46932-z
- https://www.biorxiv.org/content/biorxiv/early/2018/03/05/275859.full.pdf
- cite:wohnhaas2019
- cite:papalexi2018
- https://support.10xgenomics.com/single-cell-gene-expression/datasets
- https://www.cell.com/cell-reports/pdf/S2211-1247(19)30059-2.pdf
- https://www.nature.com/articles/s41591-020-0844-1
- https://www.workcast.com/AuditoriumAuthenticator.aspx?cpak=8475927829006248&pak=1763506853003757

- cite:qi2019
- applications
  - [[id:7bb87c84-6b06-44ef-9a1d-1bb9b9e57295][immunoprofiling]]
  - intra-tumor heterogeneity / [[id:12cfb78c-7912-4c68-b0f4-e2f90c112185][tumor microenvironment]]
    - cite:lawson2018
- cite:stuart2019
- [[id:1acf73b6-ca1e-458c-91c1-b93f17b80a02][single-cell illumina workshop [2019-09-10 Tue 09:00-15:30]​]]
- inputs and pre-processing
  - - https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-02048-6
  - https://genomebiology.biomedcentral.com/articles/10.1186/s13059-017-1171-9
  - https://www.nature.com/articles/s41591-020-0844-1
- trajectory inference
  - Monocle 2
  - Slingshot
  - TSCAN
  - Wishbone
**** Single cell conda yaml
:PROPERTIES:
:ID:       48692b20-239f-4392-8100-9ed0ab028ca8
:END:
#+begin_src bash :tangle ./resources/conda/single_cell_env.yaml
name: single_cell

#########1#########2#########3#########4#########5#########6#########7#########8
#
# Notes:
#
# This file contains ONLY single-cell-specific packages. For full environment
#  functionality, this yaml is intended to be used with basecamp and biotools
#  general yamls which can be found at
#  https://github.com/jeszyman/basecamp/blob/master/basecamp_env.yaml and
#  https://github.com/jeszyman/biotools/blob/master/biotools_env.yaml.
#
# These can be incorporated from local files as:
#
#  mamba env update --name single_cell \
#     --file /path/to/basecamp_env.yaml

channels:
  - conda-forge
  - bioconda

dependencies:
  - r-seurat
  - r-singler

#+end_src

*** ENCODE analysis pipelines
:PROPERTIES:
:ID:       682d7304-cada-4d95-b492-bafb24081ca7
:END:
- https://github.com/ENCODE-DCC/atac-seq-pipeline
https://www.genome.gov/sites/default/files/Multimedia/Slides/ENCODE2016-ResearchAppsUsers/ENCODE2016_strattan_slides.pdf
https://www.biorxiv.org/content/10.1101/2023.04.04.535623v1.full.pdf
*** 0 Bioinformatics process flat list                                 :flat:
:PROPERTIES:
:ID:       af903dfc-4470-43cb-9e05-64dba6b32abb
:END:
**** Flowcell partitioning
https://chatgpt.com/c/67191dd3-e8b4-8005-bacd-6876cf5f524d
**** Adaptive TCR-beta immunosequencing
:PROPERTIES:
:CREATED:  [2020-12-20 Sun 16:45]
:ID:       61aac189-1770-4d80-a367-e7c39b46e0d1
:END:
**** Adaptive TCR-beta immunosequencing
:PROPERTIES:
:CREATED:  [2020-12-20 Sun 16:45]
:ID:       61aac189-1770-4d80-a367-e7c39b46e0d1
:END:

**** [#Y] Assess library complexity
:PROPERTIES:
:ID:       dd9f6806-1704-444c-8498-f9c50a52022a
:END:
[[id:6d8cbcc0-2651-4c51-991e-639dbc81ea66][preseq]]

**** ATAC-seq peak calling
:PROPERTIES:
:ID:       1c56c6ad-e0f8-47db-8d69-3782b7ed1e8b
:END:
- https://www.encodeproject.org/software/idr/
- Devon recommending against MACS2 https://www.biostars.org/p/447927/
- https://bioinformatics-core-shared-training.github.io/cruk-autumn-school-2017/ChIP/Materials/Lectures/Lecture5_Peak%20Calling_SS.pdf
- Used in [[id:22e31d06-f5df-427e-bd70-3a2ccd3f47ec][ATAC-seq]]
- homer
  - some basic homer commands
    To identify Tn5 hypersensitive sites (THSs), peak calling was performed by findPeak in HOMER software (v4.9) with “-localSize 50000 -size 100 -minDist 50 -fragLength 0 -o auto.” ΔTHS score was calculated with all pairwise comparison of ESC, hCO and hMGEO by dnase_ddhs_scorer.py script with “-A” option in pyDNase library (v0.2.4) (Figure S2)
- [[id:496e62cd-3138-4120-a499-a10246ce77b5][Published MACS2 commands for ATAC-seq]]
**** ATAC-seq QC
:PROPERTIES:
:ID:       fe58011b-ca46-4e45-9c4e-d4780fbfa115
:END:
- see cite:corces2017 sup note 1
- [X] 80% unique mapping, 50 mil reads per cite:yan2020atac
- https://docs.google.com/document/d/1f0Cm4vRyDQDu0bMehHD7P7KOMxTOP-HiNoIvL1VcBt8/edit
- https://yiweiniu.github.io/blog/2019/03/Calculate-FRiP-score/
- cite:gontarz2020  https://github.com/Zhang-lab
- atacqv https://github.com/ParkerLab/ataqv/
- mononucleosomal peaks 147 +/- 30 bp
- Get input cell number (can work as low as 500 cells) cite:minnoye2021
- [[id:22e31d06-f5df-427e-bd70-3a2ccd3f47ec][ATAC-seq]]
- cite:alvarez_benayas2021
- consider batch correction using limma, see- cite:alvarez_benayas2021
- "A typical way to visually assess the effectiveness of normalization is through an MA plot: a single cloud should be present and the MA distribution should not display an upward or downward shift" cite:minnoye2021
- [[id:a5b73c70-3f1f-4018-92b2-bfdcaed53cf5][ATACseqQC]]
- QC
  - https://www.cell.com/cell-systems/pdfExtended/S2405-4712(20)30079-X
  - https://bioconductor.org/packages/release/bioc/vignettes/ATACseqQC/inst/doc/ATACseqQC.html
  - https://bioconductor.org/packages/release/bioc/html/soGGi.html
**** Batch effect
:PROPERTIES:
:ID:       ccc5beb6-da8d-4d0a-959a-80d556d7dba7
:END:

**** Bioinformatics project management
:PROPERTIES:
:ID:       5a7a057f-0283-4a4c-8b7a-44c10767d827
:END:
- https://www.reddit.com/r/bioinformatics/comments/18alwyn/best_practices_for_putting_a_project_on_github/
- https://www.reddit.com/r/bioinformatics/comments/zxbeqw/how_can_i_have_an_organized_team/
**** Biotools docker containers
:PROPERTIES:
:ID:       89e7c2f1-2213-453e-8d13-90f02b392a25
:END:
- ...rebuild local sing and add checker
- [ ] sing builds to box
- [ ] move all docker to single repo
***** Dockerfiles
:PROPERTIES:
:ID:       5e0b3ef1-3df9-41fc-b8a9-fe5592556198
:END:
- https://github.com/orgs/genome/repositories?type=all
****** Methylation docker
:PROPERTIES:
:header-args:bash: :tangle ./docker/meth_Dockerfile
:ID:       93bc867c-fbd2-4625-b6d0-e86af34b084a
:END:
:LOGBOOK:
CLOCK: [2022-07-24 Sun 09:05]--[2022-07-24 Sun 09:55] =>  0:50
:END:
******* Preamble
:PROPERTIES:
:ID:       30acaf7e-0b41-4390-972e-49700298c95a
:END:
#+begin_src bash
FROM jeszyman/biotools:1.0.2
# Dockerfile to build a bioinformatics methylation toolkit

#################
###   Notes   ###
#################
#
# After build, the image will be pushed to the dockerhub as
# jeszyman/meth
# (https://hub.docker.com/repository/docker/jeszyman/meth)
#+end_src
******* Conda
:PROPERTIES:
:ID:       7a5178e3-6792-420d-b67b-3708ae566fea
:END:
#+begin_src bash
#################
###   Conda   ###
#################

RUN conda update conda
RUN conda install -c bioconda metilene=0.2.8
#+end_src
******* Custom
:PROPERTIES:
:ID:       8e517826-f4e8-476e-acab-8203c965a20a
:END:
#+begin_src bash
###########################
###   Custom Installs   ###
###########################

# Biscuit
RUN curl -OL $(curl -s https://api.github.com/repos/huishenlab/biscuit/releases/latest | grep browser_download_url | grep linux_amd64 | cut -d '"' -f 4)
RUN mv biscuit_* biscuit
RUN chmod +x biscuit
RUN mv /biscuit /bin/
RUN curl -OL $(curl -s https://api.github.com/repos/huishenlab/biscuit/releases/latest | grep browser_download_url | grep build_biscuit_QC_assets.pl | cut -d '"' -f 4)
RUN chmod +x build_biscuit_QC_assets.pl
RUN curl -OL $(curl -s https://api.github.com/repos/huishenlab/biscuit/releases/latest | grep browser_download_url | grep QC.sh | cut -d '"' -f 4)
RUN chmod +x QC.sh
#+end_src

****** [[file:docker/biotools_Dockerfile][Biotools docker]]
:PROPERTIES:
:ID:       7ed344ce-373c-4f9e-b24f-87b57374e1a0
:header-args:bash: :tangle ./docker/biotools_Dockerfile
:END:
:LOGBOOK:
CLOCK: [2021-12-09 Thu 16:19]--[2021-12-09 Thu 17:19] =>  1:00
CLOCK: [2022-01-04 Tue 09:15]--[2022-01-04 Tue 09:16] =>  0:01
CLOCK: [2021-12-09 Thu 16:19]--[2021-12-09 Thu 17:15] =>  0:56
CLOCK: [2021-03-03 Wed 19:56]--[2021-03-03 Wed 21:25] =>  1:29
:END:
******** Preamble
:PROPERTIES:
:ID:       784d575d-ab29-4791-88ea-c961b3c252ea
:END:
#+begin_src bash
FROM jeszyman/basecamp
################################################################################
################################################################################
###                                                                          ###
###         Dockerfile to build a basic bioinformatics docker image          ###
###                                                                          ###
################################################################################
################################################################################

#################
###   Notes   ###
#################
#
# After build, the image will be pushed to the dockerhub as
# jeszyman/biotools
# (https://hub.docker.com/repository/docker/jeszyman/atac)

#+end_src
******** Conda
:PROPERTIES:
:ID:       9484b0c0-cb0f-478f-97f8-fec77ef47d7d
:END:
#+begin_src bash

#################
###   Conda   ###
#################

RUN conda install -c bioconda bbmap \
    && conda install -c bioconda bcftools \
    && conda install -c bioconda bedops \
    && conda install -c bioconda bedtools \
    && conda install -c bioconda bowtie \
    && conda install -c bioconda bowtie2 \
    && conda install -c bioconda bwa \
    && conda install -c bioconda cutadapt \
    && conda install -c bioconda deeptools=3.5.1 --force \
    && conda install -c bioconda fastp \
    && conda install -c bioconda fastqc \
    && conda install -c bioconda gatk \
    && conda install -c bioconda goleft \
    && conda install -c bioconda htseq \
    && conda install -c bioconda mosdepth \
    && conda install -c bioconda preseq \
    && conda install -c bioconda pysam \
    && conda install -c bioconda qualimap \
    && conda install -c bioconda sambamba \
    && conda install -c bioconda samblaster \
    && conda install -c bioconda samtools=1.7 \
    && conda install -c bioconda seqkit \
    && conda install -c bioconda seqtk \
    && conda install -c bioconda skewer \
    && conda install -c bioconda snakemake \
    && conda install -c bioconda trimmomatic=0.39 \
    && conda install -c bioconda vcftools
#+end_src
******** R and Bioconductor
:PROPERTIES:
:ID:       fcbc7fbd-e2d4-416d-a9ff-d1c7a736c124
:END:
#+begin_src bash
# To avoid conflict with jeszyman/basecamp R install
#RUN conda uninstall r-base

##########################
###   R Bioconductor   ###
##########################

RUN R -e "install.packages('BiocManager', repos='http://cran.rstudio.com/')"

RUN R -e "BiocManager::install(version='3.15', update=TRUE, ask=FALSE)"

RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("AnnotationDbi",\
                                 "apeglm"
                                 "BiocParallel", \
                                 "BSgenome.Hsapiens.UCSC.hg19", \
                                 "ComplexHeatmap", \
                                 "EnsDb.Mmusculus.v79", \
                                 "org.Mm.eg.db", \
                                 "readr", \
                                 "Rsamtools", \
                                 "TxDb.Mmusculus.UCSC.mm10.ensGene"));'

#+end_src
******** UCSC
:PROPERTIES:
:ID:       15f14b2e-0445-4f59-b1f5-6906e0c5aaa1
:END:
#+begin_src bash

##############################################
###   Select UCSC Command-line utilities   ###
##############################################

RUN mkdir /opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/liftOver --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedClip --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedCommonRegions --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedCoverage --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedExtendRanges --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGeneParts --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGraphPack --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGraphToBigWig --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedIntersect --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedItemOverlapCount --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedJoinTabOffset --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedJoinTabOffset.py --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedMergeAdjacent --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedPartition --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedPileUps --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedRemoveOverlap --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedRestrictToPositions --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedSort --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToBigBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToExons --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigBedSummary --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigBedToBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigAverageOverBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCat --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCluster --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCorrelate --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigInfo --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigMerge --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigSummary --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigToBedGraph --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigToWig --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/#+end_src --directory-prefix=/opt/ucsc \
    && chmod -R +x /opt/ucsc/

ENV PATH="/opt/ucsc:${PATH}"

#+end_src
******** Custom and manual installs
:PROPERTIES:
:ID:       b9e5e45f-8137-46cf-bc8e-8be40ff93323
:END:
#+begin_src bash

###########################
###   Custom Installs   ###
###########################

# Multiqc

RUN pip install multiqc

# Flexbar
RUN apt-get install -yq --no-install-recommends --allow-unauthenticated libtbb2
RUN wget https://github.com/seqan/flexbar/releases/download/v3.5.0/flexbar-3.5.0-linux.tar.gz && tar -xzf flexbar-3.5.0-linux.tar.gz && mv flexbar-3.5.0-linux/flexbar /usr/bin/ && mv flexbar-3.5.0-linux/libtbb.so.2 /usr/bin/

# samtools
# https://www.biostars.org/p/9480029/
RUN conda install -c bioconda samtools openssl=1.0

#+end_src
********* Picard
:PROPERTIES:
:ID:       80a0ab58-c388-47d8-868f-72a23f2e1660
:END:
#+begin_src bash

##################
###   Picard   ###
##################

RUN apt-get install -yq --no-install-recommends --allow-unauthenticated openjdk-8-jdk

#########1#########2#########3#########4#########5#########6#########7#########8
#https://github.com/genome/docker-picard-cwl/commit/639ad8e4d8e7bd7e6e10f193df8d5cd16260d2e2
RUN mkdir /opt/picard-2.18.1/ \
    && cd /tmp/ \
    && wget --no-check-certificate https://github.com/broadinstitute/picard/releases/download/2.18.1/picard.jar \
    && mv picard.jar /opt/picard-2.18.1/ \
    && ln -s /opt/picard-2.18.1 /opt/picard \
    && ln -s /opt/picard-2.18.1 /usr/picard
#########1#########2#########3#########4#########5#########6#########7#########8


#+end_src
******** Development                                                    :dev:
:PROPERTIES:
:header-args: :tangle no
:ID:       5b1e6890-8982-49ba-907f-8ea3c05507c4
:END:
- How to install multiple samtools and call 1.9 vs 1.7?
- give specific versions for all condas
- Old code
    #
  # cnvkit
  RUN pip install -U cython
  #FAILS [2021-02-17] RUN pip install -U future futures pandas pomegranate pyfaidx
  #FAILS [2021-02-17] RUN pip install cnvkit==0.9.6
  #
  # RSeQC
  RUN pip install RSeQC
  #
  #
  RUN cd /opt && \
      git clone https://github.com/shahcompbio/hmmcopy_utils.git && \
      cd hmmcopy_utils && \
      cmake . && \
      make
  ##NEED edger, limma, gage, dseq2, wgcna
  #
  RUN R -e 'install.packages("BiocManager"); BiocManager::install(); BiocManager::install("DNAcopy");'
  #

  #########1#########2#########3#########4#########5#########6#########7######
  #TESTING
  #
  #RUN conda install -c bioconda tophat
  #RUN conda install -c bioconda cnvkit
  #RUN conda install -c bioconda manta
  #RUN conda install -c bioconda lumpy-sv
  #RUN conda install -c bioconda multiqc

  ###8
  # #
  # ### LUMPY
  # # from https://raw.githubusercontent.com/zlskidmore/docker-lumpy/master/Dockerfile
  # # RUN apt-get update -qq
  # # RUN apt-get install -qq --no-install-recommends \
  # # python-pip \
  # # git \
  # # cmake \
  # # build-essential \
  # # libz-dev
  # # RUN cd /opt && git clone https://github.com/hall-lab/lumpy-sv.git && cd /opt/lumpy-sv && make
  # #########1#########2#########3#########4#########5#########6#########7#########8
  # ### Samtools
  # RUN apt-get update -qq
  # RUN apt-get install -qq --no-install-recommends \
  # wget \
  # bzip2 \
  # cmake \
  # gcc \
  # zlib1g-dev \
  # libncurses5-dev
  # ENV SAMTOOLS_INSTALL_DIR=/opt/samtools
  # WORKDIR /tmp
  # RUN wget --no-check-certificate https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2 && \
  # tar --bzip2 -xf samtools-1.9.tar.bz2 && \
  # cd /tmp/samtools-1.9 && \
  # ./configure --prefix=$SAMTOOLS_INSTALL_DIR && \
  # make && \
  # make install && \
  # cd / && \
  # rm -rf /tmp/samtools-1.9 && \
  # ln -s /opt/samtools/bin/* /usr/bin/

  # # # WORKDIR /usr/local/bin/
  # # # RUN curl -SL https://github.com/samtools/samtools/releases/download/${samtools_version}/samtools-${samtools_version}.tar.bz2 \
  # # #     > /usr/local/bin/samtools-${samtools_version}.tar.bz2
  # # # RUN tar -xjf /usr/local/bin/samtools-${samtools_version}.tar.bz2 -C /usr/local/bin/
  # # # RUN cd /usr/local/bin/samtools-${samtools_version}/ && ./configure
  # # # RUN cd /usr/local/bin/samtools-${samtools_version}/ && make
  # # # RUN cd /usr/local/bin/samtools-${samtools_version}/ && make install

  # # # # install lumpy
  # # # WORKDIR /usr/local/bin
  # # # RUN wget https://github.com/arq5x/lumpy-sv/releases/download/${lumpy_version}/lumpy-sv.tar.gz
  # # # RUN tar -xzvf lumpy-sv.tar.gz
  # # # WORKDIR /usr/local/bin/lumpy-sv
  # # # RUN make
  # # # RUN ln -s /usr/local/bin/lumpy-sv/bin/lumpy /usr/local/bin/lumpy
  # # # RUN ln -s /usr/local/bin/lumpy-sv/bin/lumpy_filter /usr/local/bin/lumpy_filter
  # # # RUN ln -s /usr/local/bin/lumpy-sv/bin/lumpyexpress /usr/local/bin/lumpyexpress
  # # # https://github.com/hall-lab/sv-pipeline/blob/master/docker/lumpy/Dockerfile
  # # # Build dependencies
  # # RUN apt-get update -qq \
  # #     && apt-get -y install \
  # #         apt-transport-https \
  # #         g++ \
  # # 	gawk \
  # #         libcurl4-gnutls-dev \
  # #         autoconf \
  # # 	libssl-dev \
  # #         git

  # #########1#########2#########3#########4#########5#########6#########7#########8
  # # ###############
  # # #bam-readcount#
  # # ###############
  # # # ENV SAMTOOLS_ROOT=/opt/samtools
  # # # RUN apt-get update && apt-get install -y --no-install-recommends \
  # # #         cmake \
  # # #         patch && \
  # # #     mkdir /opt/bam-readcount && \
  # # #     cd /opt/bam-readcount && \
  # # #     git clone https://github.com/genome/bam-readcount.git /tmp/bam-readcount-0.7.4 && \
  # # #     git -C /tmp/bam-readcount-0.7.4 checkout v0.7.4 && \
  # # #     cmake /tmp/bam-readcount-0.7.4 && \
  # # #     make && \
  # # #     rm -rf /tmp/bam-readcount-0.7.4 && \
  # # #     ln -s /opt/bam-readcount/bin/bam-readcount /usr/bin/bam-readcount

  # # # #note - this script needs cyvcf - installed in the python secetion!
  # # # COPY bam_readcount_helper.py /usr/bin/bam_readcount_helper.py
  # # # #############
  # # # ## IGV 3.0 ##

  # # # RUN apt-get update && apt-get install -y --no-install-recommends \
  # # #     software-properties-common \
  # # #     glib-networking-common && \
  # # #     mkdir -p /igv && \
  # # #     cd /igv && \
  # # #     wget http://data.broadinstitute.org/igv/projects/downloads/3.0_beta/IGV_3.0_beta.zip && \
  # # #     unzip IGV_3.0_beta.zip && \
  # # #     cd IGV_3.0_beta && \
  # # #     sed -i 's/Xmx4000/Xmx8000/g' igv.sh && \
  # # #     cd /usr/bin && \
  # # #     ln -s /igv/IGV_3.0_beta/igv.sh ./igv

  # # ##############
  # # ## bedtools ##

  # # WORKDIR /usr/local
  # # RUN git clone https://github.com/arq5x/bedtools2.git && \
  # #     cd /usr/local/bedtools2 && \
  # #     git checkout v2.25.0 && \
  # #     make && \
  # #     ln -s /usr/local/bedtools2/bin/* /usr/local/bin/
  # # ##############
  # # ## vcftools ##
  # # ENV ZIP=vcftools-0.1.14.tar.gz
  # # ENV URL=https://github.com/vcftools/vcftools/releases/download/v0.1.14/
  # # ENV FOLDER=vcftools-0.1.14
  # # ENV DST=/tmp

  # # RUN wget $URL/$ZIP -O $DST/$ZIP && \
  # #     tar xvf $DST/$ZIP -C $DST && \
  # #     rm $DST/$ZIP && \
  # #     cd $DST/$FOLDER && \
  # #     ./configure && \
  # #     make && \
  # #     make install && \
  # #     cd / && \
  # #     rm -rf $DST/$FOLDER
  # # ##################
  # # # ucsc utilities #
  # # RUN mkdir -p /tmp/ucsc && \
  # #     cd /tmp/ucsc && \
  # #     wget http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGraphToBigWig http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToBigBed http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigBedToBed http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigAverageOverBed http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigToBedGraph http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/wigToBigWig && \
  # #     chmod ugo+x * && \
  # #     mv * /usr/bin/
  # # ############################
  # # # R, bioconductor packages #
  # # # from https://raw.githubusercontent.com/rocker-org/rocker-versioned/master/r-ver/3.4.0/Dockerfile
  # # # we'll pin to 3.4.0 for now

  # # # ARG R_VERSION
  # # # ARG BUILD_DATE
  # # # ENV BUILD_DATE 2017-06-20
  # # # ENV R_VERSION=${R_VERSION:-3.4.0}
  # # # RUN apt-get update && apt-get install -y --no-install-recommends locales && \
  # # #     echo "en_US.UTF-8 UTF-8" >> /etc/locale.gen && \
  # # #     locale-gen en_US.UTF-8 && \
  # # #     LC_ALL=en_US.UTF-8 && \
  # # #     LANG=en_US.UTF-8 && \
  # # #     /usr/sbin/update-locale LANG=en_US.UTF-8 && \
  # # #     TERM=xterm && \
  # # #     apt-get install -y --no-install-recommends \
  # # #     bash-completion \
  # # #     ca-certificates \
  # # #     file \
  # # #     fonts-texgyre \
  # # #     g++ \
  # # #     gfortran \
  # # #     gsfonts \
  # # #     libbz2-1.0 \
  # # #     libcurl3 \
  # # #     libicu55 \
  # # #     libjpeg-turbo8 \
  # # #     libopenblas-dev \
  # # #     libpangocairo-1.0-0 \
  # # #     libpcre3 \
  # # #     libpng12-0 \
  # # #     libtiff5 \
  # # #     liblzma5 \
  # # #     locales \
  # # #     zlib1g \
  # # #     libbz2-dev \
  # # #     libcairo2-dev \
  # # #     libcurl4-openssl-dev \
  # # #     libpango1.0-dev \
  # # #     libjpeg-dev \
  # # #     libicu-dev \
  # # #     libmariadb-client-lgpl-dev \
  # # #     libmysqlclient-dev \
  # # #     libpcre3-dev \
  # # #     libpng-dev \
  # # #     libreadline-dev \
  # # #     libtiff5-dev \
  # # #     liblzma-dev \
  # # #     libx11-dev \
  # # #     libxt-dev \
  # # #     perl \
  # # #     tcl8.5-dev \
  # # #     tk8.5-dev \
  # # #     texinfo \
  # # #     texlive-extra-utils \
  # # #     texlive-fonts-recommended \
  # # #     texlive-fonts-extra \
  # # #     texlive-latex-recommended \
  # # #     x11proto-core-dev \
  # # #     xauth \
  # # #     xfonts-base \
  # # #     xvfb \
  # # #     zlib1g-dev && \
  # # #     cd /tmp/ && \
  # # #     ## Download source code
  # # #     curl -O https://cran.r-project.org/src/base/R-3/R-${R_VERSION}.tar.gz && \
  # # #     ## Extract source code
  # # #     tar -xf R-${R_VERSION}.tar.gz && \
  # # #     cd R-${R_VERSION} && \
  # # #     ## Set compiler flags
  # # #     R_PAPERSIZE=letter && \
  # # #     R_BATCHSAVE="--no-save --no-restore" && \
  # # #     R_BROWSER=xdg-open && \
  # # #     PAGER=/usr/bin/pager && \
  # # #     PERL=/usr/bin/perl && \
  # # #     R_UNZIPCMD=/usr/bin/unzip && \
  # # #     R_ZIPCMD=/usr/bin/zip && \
  # # #     R_PRINTCMD=/usr/bin/lpr && \
  # # #     LIBnn=lib && \
  # # #     AWK=/usr/bin/awk && \
  # # #     CFLAGS="-g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g" && \
  # # #     CXXFLAGS="-g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g" && \
  # # #     ## Configure options
  # # #     ./configure --enable-R-shlib \
  # # #                --enable-memory-profiling \
  # # #                --with-readline \
  # # #                --with-blas="-lopenblas" \
  # # #                --disable-nls \
  # # #                --without-recommended-packages && \
  # # #     ## Build and install
  # # #     make && \
  # # #     make install && \
  # # #     ## Add a default CRAN mirror
  # # #     echo "options(repos = c(CRAN = 'https://cran.rstudio.com/'), download.file.method = 'libcurl')" >> /usr/local/lib/R/etc/Rprofile.site && \
  # # #     ## Add a library directory (for user-installed packages)
  # # #     mkdir -p /usr/local/lib/R/site-library && \
  # # #     chown root:staff /usr/local/lib/R/site-library && \
  # # #     chmod g+wx /usr/local/lib/R/site-library && \
  # # #     ## Fix library path
  # # #     echo "R_LIBS_USER='/usr/local/lib/R/site-library'" >> /usr/local/lib/R/etc/Renviron && \
  # # #     echo "R_LIBS=\${R_LIBS-'/usr/local/lib/R/site-library:/usr/local/lib/R/library:/usr/lib/R/library'}" >> /usr/local/lib/R/etc/Renviron && \
  # # #     ## install packages from date-locked MRAN snapshot of CRAN
  # # #     [ -z "$BUILD_DATE" ] && BUILD_DATE=$(TZ="America/Los_Angeles" date -I) || true && \
  # # #     MRAN=https://mran.microsoft.com/snapshot/${BUILD_DATE} && \
  # # #     echo MRAN=$MRAN >> /etc/environment && \
  # # #     export MRAN=$MRAN && \
  # # #     echo "options(repos = c(CRAN='$MRAN'), download.file.method = 'libcurl')" >> /usr/local/lib/R/etc/Rprofile.site && \
  # # #     ## Use littler installation scripts
  # # #     Rscript -e "install.packages(c('littler', 'docopt'), repo = '$MRAN')" && \
  # # #     ln -s /usr/local/lib/R/site-library/littler/examples/install2.r /usr/local/bin/install2.r && \
  # # #     ln -s /usr/local/lib/R/site-library/littler/examples/installGithub.r /usr/local/bin/installGithub.r && \
  # # #     ln -s /usr/local/lib/R/site-library/littler/bin/r /usr/local/bin/r

  # # #    ## install r packages, bioconductor, etc ##
  # # #    ADD rpackages.R /tmp/
  # # #    RUN R -f /tmp/rpackages.R && \
  # # #    ## install fishplot ##
  # # #    cd /tmp/ && \
  # # #     wget https://github.com/chrisamiller/fishplot/archive/v0.4.tar.gz && \
  # # #     mv v0.4.tar.gz fishplot_0.4.tar.gz && \
  # # #     R CMD INSTALL fishplot_0.4.tar.gz && \
  # # #     cd && rm -rf /tmp/fishplot_0.4.tar.gz

  # # #    ## Clean up
  # # #    RUN cd / && \
  # # #    rm -rf /tmp/* && \
  # # #    apt-get autoremove -y && \
  # # #    apt-get autoclean -y && \
  # # #    rm -rf /var/lib/apt/lists/* && \
  # # #    apt-get clean

  # # # #################################
  # # # # Python 2 and 3, plus packages

  # # # # Configure environment
  # # # ENV CONDA_DIR /opt/conda
  # # # ENV PATH $CONDA_DIR/bin:$PATH

  # # # # Install conda
  # # # RUN cd /tmp && \
  # # #     mkdir -p $CONDA_DIR && \
  # # #     curl -s https://repo.continuum.io/miniconda/Miniconda3-4.3.21-Linux-x86_64.sh -o miniconda.sh && \
  # # #     /bin/bash miniconda.sh -f -b -p $CONDA_DIR && \
  # # #     rm miniconda.sh && \
  # # #     $CONDA_DIR/bin/conda config --system --add channels conda-forge && \
  # # #     $CONDA_DIR/bin/conda config --system --set auto_update_conda false && \
  # # #     conda clean -tipsy

  # # # # Install Python 3 packages available through pip
  # # # RUN conda install --yes 'pip' && \
  # # #     conda clean -tipsy && \
  # # #     #dependencies sometimes get weird - installing each on it's own line seems to help
  # # #     pip install numpy==1.13.0 && \
  # # #     pip install scipy==0.19.0 && \
  # # #     pip install cruzdb==0.5.6 && \
  # # #     pip install cython==0.25.2 && \
  # # #     pip install pyensembl==1.1.0 && \
  # # #     pip install pyfaidx==0.4.9.2 && \
  # # #     pip install pybedtools==0.7.10 && \
  # # #     pip install cyvcf2==0.7.4 && \
  # # #     pip install intervaltree_bio==1.0.1 && \
  # # #     pip install pandas==0.20.2 && \
  # # #     pip install scipy==0.19.0 && \
  # # #     pip install pysam==0.11.2.2 && \
  # # #     pip install seaborn==0.7.1 && \
  # # #     pip install scikit-learn==0.18.2 && \
  # # #     pip install svviz==1.6.1

  # # # # Install Python 2
  # # # RUN conda create --quiet --yes -p $CONDA_DIR/envs/python2 python=2.7 'pip' && \
  # # #     conda clean -tipsy && \
  # # #     /bin/bash -c "source activate python2 && \
  # # #     #dependencies sometimes get weird - installing each on it's own line seems to help
  # # #     pip install numpy==1.13.0 && \
  # # #     pip install scipy==0.19.0 && \
  # # #     pip install cruzdb==0.5.6 && \
  # # #     pip install cython==0.25.2 && \
  # # #     pip install pyensembl==1.1.0 && \
  # # #     pip install pyfaidx==0.4.9.2 && \
  # # #     pip install pybedtools==0.7.10 && \
  # # #     pip install cyvcf2==0.7.4 && \
  # # #     pip install intervaltree_bio==1.0.1 && \
  # # #     pip install pandas==0.20.2 && \
  # # #     pip install scipy==0.19.0 && \
  # # #     pip install pysam==0.11.2.2 && \
  # # #     pip install seaborn==0.7.1 && \
  # # #     pip install scikit-learn==0.18.2 && \
  # # #     pip install openpyxl==2.4.8 && \
  # # #     source deactivate"

  # # # COPY tsv2xlsx.py /usr/bin/tsv2xlsx.py

  # # # needed for MGI data mounts
  # # RUN apt-get update && apt-get install -y libnss-sss && apt-get clean all

  # # #set timezone to CDT
  # # #LSF: Java bug that need to change the /etc/timezone.
  # # #/etc/localtime is not enough.
  # # # RUN ln -sf /usr/share/zoneinfo/America/Chicago /etc/localtime && \
  # # #     echo "America/Chicago" > /etc/timezone && \
  # # #     dpkg-reconfigure --frontend noninteractive tzdata

  # # #UUID is needed to be set for some applications
  # # RUN apt-get update && apt-get install -y dbus && apt-get clean all
  # # RUN dbus-uuidgen >/etc/machine-id

  # # # WORKS TO HERE
  # # ENV PATH /opt/conda/bin:$PATH

  # # RUN apt-get update --fix-missing && apt-get install -y wget bzip2 ca-certificates \
  # #     libglib2.0-0 libxext6 libsm6 libxrender1 \
  # #     git mercurial subversion

  # # RUN wget --quiet https://repo.anaconda.com/miniconda/Miniconda2-4.5.11-Linux-x86_64.sh -O ~/miniconda.sh && \
  # #     /bin/bash ~/miniconda.sh -b -p /opt/conda && \
  # #     rm ~/miniconda.sh && \
  # #     ln -s /opt/conda/etc/profile.d/conda.sh /etc/profile.d/conda.sh && \
  # #     echo ". /opt/conda/etc/profile.d/conda.sh" >> ~/.bashrc && \
  # #     echo "conda activate base" >> ~/.bashrc

  # # RUN apt-get install -y curl grep sed dpkg && \
  # #     TINI_VERSION=`curl https://github.com/krallin/tini/releases/latest | grep -o "/v.*\"" | sed 's:^..\(.*\).$:\1:'` && \
  # #     curl -L "https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini_${TINI_VERSION}.deb" > tini.deb && \
  # #     dpkg -i tini.deb && \
  # #     rm tini.deb && \
  # #     apt-get clean
  # # RUN conda install -c bioconda sambamba

  # # # WORKDIR /opt

  # # # RUN apt-get update && apt-get install -y \
  # # # 	autoconf \
  # # # 	automake \
  # # # 	make \
  # # # 	g++ \
  # # # 	gcc \
  # # # 	build-essential \
  # # # 	zlib1g-dev \
  # # # 	libgsl0-dev \
  # # # 	perl \
  # # # 	curl \
  # # # 	git \
  # # # 	wget \
  # # # 	unzip \
  # # # 	tabix \
  # # # 	libncurses5-dev

  # # # RUN wget https://github.com/ldc-developers/ldc/releases/download/v0.17.1/ldc2-0.17.1-linux-x86_64.tar.xz && \
  # # #   tar xJf ldc2-0.17.1-linux-x86_64.tar.xz

  # # # ENV PATH=/opt/ldc2-0.17.1-linux-x86_64/bin/:$PATH
  # # # ENV LIBRARY_PATH=/opt/ldc2-0.17.1-linux-x86_64/lib/

  # # # #RUN wget https://github.com/biod/sambamba/releases/download/v0.7.0/sambamba-0.7.0-linux-static.gz && \
  # # # tar xJf sambamba-0.7.0-linux-static.gz

  # # # RUN git clone --recursive https://github.com/lomereiter/sambamba.git && cd WHERE && make
  # # RUN conda install -c bioconda samtools
  # # ## bioconductor R install
  # # # nuke cache dirs before installing pkgs; tip from Dirk E fixes broken img
  # # RUN rm -f /var/lib/dpkg/available && rm -rf  /var/cache/apt/*

  # # # same set of packages for both devel and release
  # # RUN apt-get update && \
  # # 	apt-get -y --no-install-recommends install --fix-missing \
  # # 	gdb \
  # # 	libxml2-dev \
  # # 	python-pip \
  # # 	libz-dev \
  # # 	liblzma-dev \
  # # 	libbz2-dev \
  # # 	libpng-dev \
  # # 	libmariadb-client-lgpl-dev \
  # # 	&& rm -rf /var/lib/apt/lists/*

  # # # issues with '/var/lib/dpkg/available' not found
  # # # this will recreate
  # # RUN dpkg --clear-avail

  # # # # Add bioc user as requested
  # # # RUN useradd -ms /bin/bash -d /home/bioc bioc \
  # # # 	&& echo "bioc:bioc" | chpasswd && adduser bioc sudo
  # # # USER bioc
  # # # RUN mkdir -p /home/bioc/R/library && \
  # # # 	echo "R_LIBS=/usr/local/lib/R/host-site-library:~/R/library" | cat > /home/bioc/.Renviron
  # # # USER root
  # # # RUN echo "R_LIBS=/usr/local/lib/R/host-site-library:\${R_LIBS}" > /usr/local/lib/R/etc/Renviron.site \
  # # # 	&& echo "R_LIBS_USER=''" >> /usr/local/lib/R/etc/Renviron.site \
  # # # 	&& echo "options(defaultPackages=c(getOption('defaultPackages'),'BiocManager'))" >> /usr/local/lib/R/etc/Rprofile.site

  # # # # add R packages test
  # # # RUN R -e "install.packages('methods',dependencies=TRUE, repos='http://cran.rstudio.com/')"
  # # # RUN R -e "install.packages('jsonlite',dependencies=TRUE, repos='http://cran.rstudio.com/')"
  # # # RUN R -e "install.packages('tseries',dependencies=TRUE, repos='http://cran.rstudio.com/')"
  #RSEM
  #RUN cd /opt/
  #RUN git clone https://github.com/deweylab/RSEM.git && cd RSEM && make && make install
  #ENV PATH /opt/RSEM:$PATH

  # # # # install skewer
  # # # RUN \
  # # #   wget -c https://downloads.sourceforge.net/project/skewer/Binaries/skewer-0.2.2-linux-x86_64 && \
  # # #   chmod +x skewer-0.2.2-linux-x86_64 && \
  # # #   cp skewer-0.2.2-linux-x86_64 /usr/local/bin/skewer

  # # # run update and install necessary tools
  # # RUN apt-get update -y && apt-get install -y \
  # #     build-essential \
  # # RUN apt-get install -y software-properties-common
  # # RUN add-apt-repository -y ppa:jonathonf/python-3.6
  # # RUN apt-get update && apt-get install -y python3.6
  #
    ### ^^^ BUILDS INDEPENDENTLY VALIDATED ABOVE THIS POINT ^^^ ###
    ### Last successful build 2020-01-14 15:26 CST              ###
    #
    #
    ### TESTING ###
    ### Installs below this point are not individually validated and my require dependencies from above
    # multiqc
    ## Set the locale
    ## https://stackoverflow.com/questions/28405902/how-to-set-the-locale-inside-a-debian-ubuntu-docker-container#28406007
    #
  RUN pip install -U multiqc

  ##############
  ### simNGS ###
  ##############
  #
  #RUN apt-get update -qq
  #RUN apt-get install -qq --no-install-recommends --allow-unauthenticated \
  #    libblas-dev \
  #    liblapack-dev \
  #    make \
  #    tar \
  #    wget
  #RUN cd /opt && wget --no-check-certificate #https://www.ebi.ac.uk/goldman-srv/simNGS/current/simNGS.tgz && tar -xvzf #simNGS.tgz
  #RUN cd /opt/simNGS/src && make -f Makefile.linux
  #ENV PATH="/opt/simNGS/bin:${PATH}"
  #
  RUN R -e 'install.packages("BiocManager"); BiocManager::install(); BiocManager::install(
  #
  # WORKS TO HERE [2020-09-21]
  #
  # # GISTIC 2.0
  # RUN mkdir -p /opt/GISTIC2 \
  #     && cd /opt/GISTIC2 \
  #     && wget --no-check-certificate ftp://ftp.broadinstitute.org/pub/GISTIC2.0/GISTIC_2_0_23.tar.gz \
  #     && tar --owner=root --group=root -vxf GISTIC_2_0_23.tar.gz
  # RUN cd /opt/GISTIC2/MCR_Installer \
  #     && unzip MCRInstaller.zip \
  #     && ./install -mode silent -agreeToLicense yes -destinationFolder /opt/GISTIC2
  # RUN cd /opt/GISTIC2 \
  #     && wget --no-check-certificate ftp://ftp.broadinstitute.org/pub/GISTIC2.0/hg19.mat
  # ENV PATH="/opt/GISTIC2/:${PATH}"
  # RUN chown -R root:root /opt/GISTIC2
  # ENV MCR_ROOT=/opt/GISTIC2/MATLAB_Compiler_Runtime
  #

  #
  #RUN conda install -c bioconda mirge3
  #
  #RUN conda create -n py2 python=2.7
  #RUN echo "source activate py2" > ~/.bashrc
  #ENV PATH /opt/conda/envs/py2/bin:$PATH
  #
  #########1#########2#########3#########4#########5#########6#########7#########8
  #

  #########1#########2#########3#########4#########5#########6#########7#########8
  #
  # ichorCNA
  ##
  ## linux dependencies
  RUN apt-get update \
     && apt-get install -y \
     libcurl4-openssl-dev \
     libssl-dev \
     libxml2-dev
  #RUN rm /usr/lib/x86_64-linux-gnu/libcurl.so.4
  #RUN ln -s /usr/lib/x86_64-linux-gnu/libcurl.so.4.5.0 /usr/lib/x86_64-linux-gnu/libcurl.so.4
  ##
  ## R dependencies
  RUN R -e 'install.packages("BiocManager"); BiocManager::install(); BiocManager::install("HMMcopy"); BiocManager::install("GenomeInfoDb"); BiocManager::install("GenomicRanges");'
  ##
  ## git clone install
  RUN cd /opt \
      && git clone https://github.com/broadinstitute/ichorCNA.git \
      && cd ichorCNA \
      && R CMD INSTALL . \
      && cd /opt
  ##
  #RUN echo "source activate py2" > ~/.bashrc
  #ENV PATH /opt/conda/envs/py2/bin:$PATH
****** [[file:docker/rna_Dockerfile][RNA docker]]
:PROPERTIES:
:header-args:bash: :tangle ./docker/rna_Dockerfile
:ID:       1338f10d-c3d0-4b29-9c4a-d3a01758a3d2
:END:
:LOGBOOK:
CLOCK: [2022-06-28 Tue 07:55]--[2022-06-28 Tue 15:55] =>  8:00
:END:
******* Preamble
:PROPERTIES:
:ID:       649a5972-d9c6-4194-a388-96e47941d660
:END:
#+begin_src bash
FROM jeszyman/biotools:1.0.2
################################################################################
################################################################################
###                                                                          ###
###         Dockerfile to build an RNA-focused docker image                  ###
###                                                                          ###
################################################################################
################################################################################

#################
###   Notes   ###
#################
#
# After build, the image will be pushed to the dockerhub as
# jeszyman/rna
# (https://hub.docker.com/repository/docker/jeszyman/rna)

#+end_src
******* Conda
:PROPERTIES:
:ID:       231d12e4-5dc5-4955-a41a-15b0ed47320c
:END:
#+begin_src bash
RUN conda install -c bioconda kallisto
RUN conda install -c bioconda rsem
RUN conda install -c bioconda star
RUN conda install -c bioconda subread
RUN conda install -c bioconda salmon
#+end_src
******* R and Bioconductor
:PROPERTIES:
:ID:       911dc16d-bb70-4b7d-807b-f9421c5f3987
:END:
#+begin_src bash
RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("DESeq2", \
                                 "edgeR", \
                                 "fgsea", \
                                 "limma", \
                                 "tximport"));'

#+end_src
******* Custom installs
:PROPERTIES:
:ID:       81632e35-0970-4554-a22c-4cc2bb65cdbd
:END:
#+begin_src bash
RUN cd /opt && git clone https://github.com/rajewsky-lab/mirdeep2 && cd /opt/mirdeep2 && perl install.pl

RUN /bin/bash

RUN cd /opt/mirdeep2 && perl install.pl

ENV PATH="/opt/mirdeep2/bin:${PATH}"
#+end_src
****** [[file:docker/atac_Dockerfile][ATAC-seq docker]]
:PROPERTIES:
:ID:       dccf525d-6c1c-48ab-b757-989cafabe530
:END:
#+begin_src bash :tangle ./docker/atac_Dockerfile
FROM jeszyman/biotools:1.0.2
#########1#########2#########3#########4#########5#########6#########7#########8

###################################
###   Dockerfile for ATAC-seq   ###
###################################

# After build, the image will be pushed to dockerhub as jeszyman/atac
# (https://hub.docker.com/repository/docker/jeszyman/atac)

RUN apt-get -y update && apt-get upgrade -y

# Simple bioconda installs
RUN conda install -c bioconda macs2

# Simple R installs
##
## Via Bioconductor
RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("ATACseqQC", \
                                 "ChIPpeakAnno", \
                                 "ChIPseeker", \
                                 "clusterProfiler", \
                                 "csaw"));'


# ATACseqQC
##
## Linux prerequisites
RUN apt-get install -yq --no-install-recommends --allow-unauthenticated --fix-missing \
    libgsl-dev \
    libcurl4-openssl-dev
    #libssl-dev
##
## ATACseqQC
RUN R -e 'install.packages("BiocManager"); \
    BiocManager::install(); \
    BiocManager::install(c("ATACseqQC"));'

# Homer
RUN mkdir /opt/homer
RUN cd /opt/homer
RUN wget http://homer.ucsd.edu/homer/configureHomer.pl -O /opt/homer/configureHomer.pl
RUN perl /opt/homer/configureHomer.pl -install

ENV PATH="${PATH}:/opt/homer/bin/"

RUN perl /opt/homer/.//configureHomer.pl -install mouse-p

RUN conda install -c bioconda samtools=1.7

# R CRAN Installs
RUN R -e "install.packages(c('statmod', repos='http://cran.rstudio.com/'))"

#+end_src
***** Helper shell scripts
:PROPERTIES:
:ID:       f62b7743-446e-4d0f-a96e-86ed4c3ad123
:END:
****** Built docker container
:PROPERTIES:
:ORDERED:  t
:ID:       d9400316-b6a3-4922-a20d-c2f203259f6a
:END:
#+begin_src bash :tangle ./tools/shell/docker_build.sh
#!/usr/bin/env bash

set -o errexit   # abort on nonzero exitstatus
set -o nounset   # abort on unbound variable
set -o pipefail  # don't hide errors within pipes

print_usage(){
    cat <<- EOF

###################################################
###   Docker and Singularity Building Command   ###
###################################################

Steps
1) Builds docker container
2) Pushes container to dockerhub
3) Builds singularity file
4) Pushes singularity file to box

usage: docker_build.sh [options] <DOCKER FILE> <DOCKER TAG> [OPTIONAL - DOCKER BUILD LOC]
  options:
    -n  No cache, use for validation of full build
    -s  A sif directory location
    -v  Docker version, a version appended to docker and singularity tags
        Note: adding a version will push the singularity build to
        shared/singularity-containers/stable

example:

docker_build.sh -n -s ~/sing_containers -v 2.0.0 ~/dockerfiles/atac_Dockerfile jeszyman/atac ~/docker_bulid_dir

EOF
}

# Setup options
while getopts "nt:v:s:" options;
do
    case "${options}" in
        n) usecache="--no-cache" ;;
        v) version=${OPTARG} ;;
        s) sifdir=${OPTARG} ;;
        h | *) print_usage; exit 0 ;;
    esac
done

shift $((OPTIND -1))

[[ $# -eq 0 ]] && print_usage && exit 1

# Scipt variables
dockerfile=$1
tag=$2
if [ -z ${usecache+x} ]; then usecache="cache"; fi
dockerloc="${3:-.}"

main(){
    # Build and push docker container. Append version if provided.
    printf "\nBuilding Docker container now...\n "
    sleep 2s
    if [ -z ${version+x} ]
    then
        build_docker $dockerfile $tag $dockerloc $usecache
        printf "\nPushing docker container to dockerhub...\n "
        docker push $tag
    else
        build_docker $dockerfile "${tag}:${version}" $dockerloc $usecache
        printf "\nPushing docker container to dockerhub...\n "
        docker push $tag:$version
    fi

    # Build and push sif if provided.

    if [ -z ${sifdir+x} ];
    then
        sleep 2s
        printf "\n-s flag is unset, nothing more to do.\n "
    else
        dockertag="$tag"
        if [ -z ${version+x} ];
        then
            siftag=$(echo $tag | sed 's/^.*\///g')
            target="shared/singularity-containers/most-recent/"
        else
            presiftag=$(echo $tag | sed 's/^.*\///g')
            siftag="${presiftag}.${version}"
            target="shared/singularity-containers/stable/"
        fi

        printf "\nBuilding Singularity container now...\n"

        build_singularity $sifdir \
                          $siftag \
                          $dockertag

        sleep 2s
        echo "build_singularity $sifdir $siftag $dockertag"
        printf "\nLocal Singularity build complete.\nPushing singularity to box...\n"

        push_singularity $sifdir \
                         $siftag \
                         $target

    fi
}

# main(){


#     # Build and push sif if provided.

#     if [ -z ${sifdir+x} ];

#     then
#         sleep 2s
#         printf "\n-s flag is unset, nothing more to do.\n "
#     else
#         dockertag="$tag"
#         if [ -z ${version+x} ];
#         then
#             siftag="$tag"
#             target="shared/singularity-containers/most-recent"
#         else
#             siftag="${tag}.${version}"
#             target="shared/singularity-containers/stable"
#         fi
#         printf "\nBuilding Singularity container now...\n"
#         sleep 2s
#         build_singularity $sifdir \
#                           $siftag \
#                           $dockertag
#         printf "\nLocal Singularity build complete.\nPushing singularity to box...\n"
#         push_singularity $sifdir \
#                          $siftag \
#                          $target
#     fi
# }

build_docker(){
    local dockerfile="${1}"
    local dockertag="${2}"
    local dockerloc="${3}"
    if [ $4 == "--no-cache" ];
    then
        docker build \
               --file $dockerfile $4 \
               --pull \
               --tag $dockertag \
               $dockerloc
    else
        docker build \
               --file $dockerfile \
               --pull \
               --tag $dockertag \
               $dockerloc
    fi
}

push_docker(){
    local dockertag="${1}"
    docker push $dockertag
}

build_singularity(){
    local sifdir="${1}"
    local siftag="${2}"
    local dockertag="${3}"
    singularity pull \
                --force \
                "${sifdir}/${siftag}.sif" \
                "docker://${dockertag}"
}

push_singularity(){
    local sifdir="${1}"
    local siftag="${2}"
    local target="${3}"
    rclone copy \
           --update \
           --verbose \
           "${sifdir}/${siftag}.sif" remote:"${target}"
}

main "$@"

#+end_src

****** Make singularity container
:PROPERTIES:
:ID:       9786c366-abe6-481d-86b9-98c062c42177
:END:
#+begin_src bash
#!/usr/bin/env bash
#
###   SCRIPT NAME   ###
#

# Notes
# ...

# Setup

set -e # enable exit on error
set -u # unset variables are errors
set -o pipefail # failures can occur anywhere in pipeline

# Variables

readonly blah=$1
blue=$(tput setaf 4)

# Functions

usage()
{
    printf "
           ${blue}Script to do blah \n
    usage:  blah\n
"
    exit 1
}

main()
{
    [[ $# -ne 2 ]] && usage
    echo "$blah"
    normal=$(tput sgr0)
    printf "%40s\n" "${blue}This text is bluenormal"
}

# Run

main "$@"
#+end_src

#+begin_src bash
singularity pull /mnt/ris/aadel/jeszyman/sing_containers/biotools.sif docker://jeszyman/biotools
#+end_src
****** Run functions
:PROPERTIES:
:ID:       df24242a-f19b-49c9-b5e1-5b601452119f
:END:
- run docker interactively
  #+name: docker_interactive
  #+begin_src bash
docker_interactive() {
    if [ -f /.dockerenv ]; then
        echo "shell already in docker, exiting"
        exit 1
    else
        account="USER INPUT"
        container="USER INPUT"
        read -p "docker account name: " account
        account="${account:=jeszyman}"
        read -p "container name: " container
        container="${container:=biotools}"
        case $HOSTNAME in
            (radonc-cancerbio) docker run -it \
                                      --env HOME=${HOME} \
                                      --hostname ${HOSTNAME} \
                                      --user $(id -u ${USER}) \
                                      --volume /home/:/home/ \
                                      --volume /mnt/:/mnt/ \
                                      --volume /tmp/:/tmp/ \
                                      $account/$container \
                                      /bin/bash;;
            (acl*) docker run -it \
                          --env HOME=${HOME} \
                          --hostname ${HOSTNAME} \
                          -v /drive3/:/drive3/ \
                          -v /duo4/:/duo4/ \
                          -v /home/:/home/ \
                          -v /tmp/:/tmp/ \
                          -u $(id -u ${USER}) \
                          $account/$container \
                          /bin/bash;;
            (ACL*) docker run -it \
                          --env HOME=${HOME} \
                          --hostname ${HOSTNAME} \
                          -v /home/:/home/ \
                          -v /duo4/:/duo4/ \
                          -u $(id -u ${USER}):$(id -g ${USER}) \
                          $account/$container \
                          /bin/bash;;
            (virtual-workstation*.gsc.wustl.edu) bsub -Is -q docker-interactive -a 'docker($account/'"$container"')' /bin/bash;;
            (*) docker run -it \
                       --env HOME=/home/${USER} \
                       --hostname ${HOSTNAME} \
                       --user $(id -u ${USER}) \
                       --volume /home/:/home/ \
                       --volume /mnt/:/mnt/ \
                       --volume /tmp/:/tmp/ \
                       $account/$container \
                       /bin/bash;;
        esac
    fi
}
#+end_src

:LOGBOOK:
CLOCK: [2020-10-08 Thu 10:05]--[2020-10-08 Thu 10:15] =>  0:10
:END:
***** Reference
:PROPERTIES:
:ID:       cc7346db-b797-4e75-9f1c-24001bbc8296
:END:
- [[id:D2FAA88D-70CC-4450-BBB3-8A446CB43AF3][Docker software]]

**** cfDNA clonal evolution
:PROPERTIES:
:ID:       c9ce98a3-e54c-4ffd-9819-cf3e59a06c31
:END:
https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-020-03919-2
https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-021-00895-x#Sec2
https://mail.google.com/mail/u/0/#inbox/FMfcgzGpFWWgNKMCfqmfTbDzSlvgqZDq
**** cfDNA copy number calling and CNA-based tumor fraction
:PROPERTIES:
:ID:       21d876e8-8646-4773-91c1-c4385c3218c7
:END:
- [cite:@ostrup2017]
- Boost via em-seq? https://www.pnas.org/doi/10.1073/pnas.1313995110
- Copy number ANomaly Assessment and Recovery (CANARy)
  - https://aacrjournals-org.mclibrary.idm.oclc.org/cancerres/article/85/8_Supplement_1/4565/760975/Abstract-4565-CANARy-TF-an-improved-copy-number
  - https://drive.google.com/file/d/1MpA65YpwE37gJy8jrozYAjwwYy07AOjR/view?usp=drive_link
  - https://ashpublications.org/blood/article/140/Supplement%201/10712/491124/Accurate-Detection-of-Clinically-Actionable-Copy
- [cite:@chabon2020]
- How to do allele-specific copy number and LOH?
  - https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5027494/
- [cite:@ricklesyoung2024]
- MSK with augmented CNA TF [cite:@tsui2021] used https://doi.org/10.1186/gm434 method
- [[#0f1f4aa4-c755-42ff-8f81-8a32c14293a0][Cell-free DNA (cfDNA) and circulating-tumor DNA (ctDNA)]]
- https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-023-01171-w
- has LOH on seq panel w/ custom pipeline  - https://www.sciencedirect.com/science/article/pii/S0923753419454604?pes=vor#ec0010
- https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-020-00735-4#Sec12
- snv based with ABSOLUTE https://www.nature.com/articles/nbt.2203#Sec12
  - https://bioconductor.org/packages/devel/bioc/vignettes/PureCN/inst/doc/PureCN.pdf
- post-CN call processessing and denoising
  - cite:zviran2020
- BIC-seq
  - cite:zviran2020
- Proprietary method
  - cite:chen2019cna
- CNVkit on duplex hybrid capture reads
  - cite:mansukhani2018
- optimal read pre-processing for cfDNA CNV
  - cite:molparia2018
- arm-level by z-score
  - cite:xu2018crc
- review articles
  - cite:cristofanilli2017
    - (p. 119)"In addition, although copy number assessments can be challenging in ptDNA, there are studies that suggest that this is feasible. For example, HER2 amplification for breast and possibly other cancers may one day be assayed through the use of blood [49],"
    - (p. 119)"Wyatt et  al. serially profiled ptDNA in men with castration-resistant metastatic prostate cancer to assess for copy number and mutations in androgen receptor (AR) along with targeted sequencing of 19 genes through subsequent therapies [51]."
  - cite:huang2019
- simulation and power calculation
  - cite:molparia2017
- GISTIC2
  - cite:bujak2020
  - cite:hemming2019
- ichorCNA
  - cite:hemming2019
  - ichorCNA on off-target reads - cite:shah2021
  - Other papers applying ichorCNA
    - cite:bujak2020
    - cite:ge2020
      - tumor vs cfDNA CN see cite:ge2020 fig2C
    - cite:stover2018
    - https://bmccancer.biomedcentral.com/articles/10.1186/s12885-019-6003-8
  - Method-establishing paper cite:adalsteinsson2017
- instability score
  - cite:li2017a
  - cite:feng2020
- by PCR
  - https://www.pnas.org/content/117/9/4858
**** cfDNA fragment end motif analysis
:PROPERTIES:
:ID:       de9c6398-4ffe-48bf-9ef9-31028edf9873
:END:
- [[file:~/data/career/golkaram2022.pdf]]
- [[#0f1f4aa4-c755-42ff-8f81-8a32c14293a0][Cell-free DNA (cfDNA) and circulating-tumor DNA (ctDNA)]]
- cite:an2023
- F-profiles: cite:zhou2023 [cite:@zhou2023]
- cite:guo2022
- cite:zhitnyuk2022
- cite:zhou2022 - fragma
- cite:moldovan2021
- cite:zhou2021 - jaggedness
- cite:jiang2020motif [cite:@jiang2020motif]
**** cfDNA fragmentomics
:PROPERTIES:
:ID:       173e0331-9140-47d0-9e5e-ec91672ebdc3
:END:
- cite:liu2022
- Fragmentomics from targeted panels [[cite:&helzer2023panelfrag]]
- [[cite:&jiang2015]]
- fragment length NMF [[cite:&renaud2021]]
- https://academic.oup.com/clinchem/article/68/9/1184/6623478#377336919
- fragmentomics from targeted panel [[https://www.annalsofoncology.org/article/S0923-7534(23)00724-X/fulltext]]
- [[file:~/library/alizadeh2023.pptx]]
- cite:lo2021
- Inferred gene expression
  - https://mail.google.com/mail/u/0/#inbox/FMfcgzGsltShrnWQMVgTLMNJhmrjkmXx?projector=1&messagePartId=0.1
- transcription factor binding
  - cite:ulz2019
- https://www.nature.com/articles/s41416-021-01635-z
- https://www.pnas.org/doi/10.1073/pnas.2209852119
- LIQUORICE
  - cite:peneder2021
  - https://jhoonline.biomedcentral.com/articles/10.1186/s13045-022-01342-z#Sec2
- cite:ding2022
- cite:esfahani2022
- http://m.genome.cshlp.org/content/early/2021/12/20/gr.275691.121.full.pdf#page=1&view=FitH
- fragments for open chromatin and tissue of origin
- footprinting
  - https://www.nature.com/articles/s41523-021-00237-5
  - for nucleosome footprinting cite:snyder2016
- cite:chabon2020 - per individual mutant molecules- see "ctDNA fragment size analysis", R zoo for sliding window, relative enrichment per frag size
- cite:peneder2021
  - [[https://ega-archive.org/studies/EGAS00001003611][peneder data (restricted)]]
**** cfDNA from patient derived xenograft (PDX) models
:PROPERTIES:
:ID:       2e475e89-40a2-4359-903d-6e590f4ab8a0
:END:
- [[cite:&rao2022]] [cite:@rao2022]
  - [[https://www.scopus.com/results/citedbyresults.uri?sort=plf-f&cite=2-s2.0-85136454112&src=s&nlo=&nlr=&nls=&imp=t&sid=dacd92e53a1732d3f30ed4e48426dc27&sot=cite&sdt=cl&cluster=scosubtype%2c%22ar%22%2ct&sl=0&origin=resultslist&zone=leftSideBar&editSaveSearch=&txGid=9d3c2ae452ba1a73cc713ec009b5e33f][scopus citing]]
    - https://doi.org/10.1016/j.xcrm.2023.101349
    - https://doi.org/10.1016/j.annonc.2023.06.001
- https://www.frontiersin.org/articles/10.3389/fgene.2018.00006/full#T3
- https://www.nature.com/articles/cr2017121.pdf?origin=ppub
- https://clincancerres.aacrjournals.org/content/23/20/6305?ijkey=46368653e37c96739922e66f2f6ae51379b550f3&keytype2=tf_ipsecsha
- https://www.nature.com/articles/s41467-018-06159-4

-
- https://www.nejm.org/doi/10.1056/NEJMoa2024534?url_ver=Z39.88-2003&rfr_id=ori%3Arid%3Acrossref.org&rfr_dat=cr_pub++0pubmed
- duplication rate as a measure of lib complexity
-
- nonterminal mouse blood draws
  - cite:campbell2020
**** cfDNA methylation
:PROPERTIES:
:ID:       8c302b2c-2d4e-4819-b415-7f03826336e2
:END:
- https://cbiit.webex.com/recordingservice/sites/cbiit/recording/96c9253b7ffd103caf3f00505681c8fe/playback
- [[cite:&li2023cfdna]]
- TRACERx - https://www.nature.com/articles/s41586-023-05776-4
- https://mail.google.com/mail/u/0/#inbox/FMfcgzGtxKMwMFsxwrhWpKhfMNbKGtdK
- [[cite:&an2023]]
- https://www.annalsofoncology.org/article/S0923-7534(23)00087-X/fulltext
- https://academic.oup.com/nargab/article/5/2/lqad048/7188752
- cite:shen2019cfmedip used in cite:shen2018
- [[id:d9b52bbd-ec6a-4b9e-af4b-17f6efafdcf6][methylation sequencing]]
- https://jhoonline.biomedcentral.com/articles/10.1186/s13045-020-00933-y
- cite:barefoot2022rads
- cite:liu2020
- [[id:0f1f4aa4-c755-42ff-8f81-8a32c14293a0][Cell-free DNA (cfDNA) and circulating-tumor DNA (ctDNA)]]
- cfDNA methylation
  - cite:liu2020
    - https://www.dana-farber.org/newsroom/news-releases/2020/new-blood-test-can-detect-wide-range-of-cancers--now-available-to-at-risk-individuals-in-clinical-study-at-dana-farber/
  - ct methylation
    - cite:widschwendter2017
    - cite:xu2017a
    - cite:heitzer2017
  - cite:guo2017
  - meth for early detection
    - https://www.biorxiv.org/content/10.1101/422675v1
    - https://www.pnas.org/content/113/16/4338.long
    - https://www.nature.com/articles/cr2017106
- https://www.jci.org/articles/view/145973
**** cfDNA methylation marker PCR
:PROPERTIES:
:ID:       8e0aa543-7033-478b-b66c-bea395db35c8
:END:
https://www.pnas.org/doi/abs/10.1073/pnas.1519286113
**** cfDNA nucleosome profiling
:PROPERTIES:
:ID:       c4dde8d6-1a02-42c7-a6b6-786b757fcad1
:END:
- [[id:2d0d13d9-857a-4285-89e6-4614f749afd3][cfDNA topology]]
- https://www.nature.com/articles/ng.3648
- cite:foda2022
- Plasma nucleosome capture and antibody binding [[cite:&fedyuk2022]]
- OCRDetector, for detecting OCRs from whole-genome cfDNA sequencing data   [[cite:&wang2021ocr]]
- nucleosome profiling with griffin
  - [cite:@doebley2022griffin]
  - https://github.com/adoebley/Griffin/wiki
  - https://www.medrxiv.org/content/10.1101/2021.08.31.21262867v1.full-text
  - https://github.com/alexcpan/Griffin
- tissue-specific nucleosome depleted regions cite:zhu2021
- inferred gene expression and regulation
  - w/ Griffin, Gavin Ha method cite:sarkar2022
  - cite:ulz2016
- https://github.com/alexcpan/Griffin
**** cfDNA small variant calling
:PROPERTIES:
:ID:       0b43e09e-52f7-49fb-8796-87168fe57706
:END:
- a sv caller https://academic.oup.com/bioinformatics/article/39/8/btad489/7238210
- [[https://www.nature.com/articles/s41591-023-02598-9#:~:text=The%20trial%20met%20its%20primary,CI%3A%2056.5%E2%80%9388.5%25).][ctDNA response after pembrolizumab in non-small cell lung cancer: phase 2 adaptive trial results]]

- [[id:55b77210-fcb6-438d-a546-0c3605f6f5c4][Integrated hybrid capture and genome-wide- MAESTRO]]
- SEQC2 analytical validity [[cite:&deveson2021]]
https://mail.google.com/mail/u/0/#inbox/FMfcgzGpFWNbSMxNkbQTTtVwBpvBltDq
- PhasED-seq- https://www.nature.com/articles/s41587-021-00981-w
  - - phased seq https://www.sciencedirect.com/science/article/pii/S2666634021003202
- cite:cohen2021
- cfDNA and ctDNA sequence variant calling
  - cite:razavi2019
  - cite:chabon2020
    - https://www.theguardian.com/society/2020/mar/25/ai-program-could-check-blood-for-signs-of-lung-cancer
  - tumor mutational burden
    - https://ascopubs.org/doi/full/10.1200/PO.19.00204
**** cfDNA tissue of origin discovery
:PROPERTIES:
:ID:       47c4ed56-1dea-48dc-bb25-ddbb0a4cd359
:END:
- https://www.frontiersin.org/articles/10.3389/fgene.2021.671057/full
- https://onlinelibrary.wiley.com/doi/10.1002/ctm2.177
- https://insight.jci.org/articles/view/153559#SEC4
**** cfDNA window protection score
:PROPERTIES:
:ID:       2b5a4f91-873a-4c79-a265-f528c52f06bc
:END:
- [[file:~/data/career/golkaram2022.pdf]]

**** Compare gene expression across species
:PROPERTIES:
:ID:       ed773c0e-4cb4-42f9-a488-5510f44c83e9
:END:
https://www.google.com/search?q=biostars+mouse+human+homology+match+genes&oq=biostars+mouse+human+homology+match+genes&aqs=chrome..69i57.9457j0j1&sourceid=chrome&ie=UTF-8
**** Copy-neutral loss of heterozygosity
:PROPERTIES:
:ID:       290d7be0-d47b-4055-9180-373ed6f3fce5
:END:
https://www.biostars.org/p/254848/#:~:text=%22The%20B%2DAllele%20Frequency%20is,alleles%20(e.g.%20AB).%22
**** ctDNA burden by cfDNA degragation
:PROPERTIES:
:ID:       1c8be64c-2579-4e7b-95bf-578d9c38af3c
:END:
https://www.nature.com/articles/s41467-021-22463-y#Sec2
**** CUT&Tag
:PROPERTIES:
:ID:       1e4e06c2-84cd-4b5f-ba02-9b2a7d69d152
:END:
[[cite:&kayaokur2019]]
https://www.protocols.io/view/bench-top-cut-amp-tag-kqdg34qdpl25/v3
**** design matrix
:PROPERTIES:
:ID:       b5fa3623-0fa7-4402-bf73-80fce6634552
:END:
https://seqqc.wordpress.com/2020/11/28/10-tips-tricks-for-complex-model-matrix-designs-in-dge-analysis/
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7873980/
https://stackoverflow.com/questions/59701903/what-does-0-mean-in-the-r-model-matrix

**** Determine sequencing coverage
:PROPERTIES:
:ID:       7ec3083a-b152-4ab2-b4f8-5fb9bb5ba068
:END:
https://chatgpt.com/c/8648af42-5e94-4eb7-aa89-90712de0e095
- https://support.illumina.com/downloads/sequencing_coverage_calculator.html
- idea- manual w/ R, awk
  - https://www.biostars.org/p/104063/
  - https://sarahpenir.github.io/bioinformatics/awk/calculating-mapping-stats-from-a-bam-file-using-samtools-and-awk/
- expected
  - [[mu4e:msgid:33C61570-8F28-4ED8-B061-60E315F153D8@wustl.edu][Coverage for WGS]]
- need depth plots depth (y) vs. 10kb bin x smooth across genome
  - https://www.biostars.org/p/104063/

***** Fusion calling
:PROPERTIES:
:ID:       b116aaae-d31c-4ce2-ae02-3c4bbab31f34
:END:
- https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-021-08094-z
***** Machine learning of whole genome sequencing data
:PROPERTIES:
:ID:       cf33a283-23e5-41bb-9d64-f70f71451071
:END:

**** Differential chromatin accessibility
:PROPERTIES:
:ID:       17f978bc-f2f2-497d-a8f1-b1d47927380f
:END:
- Reske
  - https://github.com/reskejak/ATAC-seq/blob/a7c3ba9a024030eb985e1a7d17ddb4d089446041/ATACseq_workflow.txt
  - cite:reske2020
- [[id:22e31d06-f5df-427e-bd70-3a2ccd3f47ec][ATAC-seq]]
- Run macs2 with a set q value?
- https://www.biostars.org/p/308976/
- cite:gontarz2020
- https://support.bioconductor.org/p/61604/
- cite:reske2020
- Homer
  - http://homer.ucsd.edu/homer/ngs/mergePeaks.html
- Diffbind
  - https://www.cruk.cam.ac.uk/core-facilities/bioinformatics-core/software/diffbind-tool-for-chip-seq-and-atac-seq-analysis
  - https://bioinformatics-core-shared-training.github.io/Quantitative-ChIPseq-Workshop/articles/Quantitative-ChIPseq-Workshop.html#loading-an-experiment-into-diffbind-1
  - https://rdrr.io/bioc/DiffBind/f/inst/doc/DiffBind.pdf
  - https://bioconductor.org/packages/release/bioc/vignettes/DiffBind/inst/doc/DiffBind.pdf
- csaw
  - http://bioconductor.org/books/3.14/csawBook/counting-reads-into-windows.html#
  - https://www.biostars.org/p/320394/
- [[id:ae0363f3-379e-4521-9184-cbc0d46501cd][Chromatin accessibility profiling]]
- General reference
  - cite:minnoye2021
  - Complete list of bulk methods in cite:minnoye2021 box 1
- https://github.com/macs3-project/MACS/blob/master/docs/callpeak.md
**** [[id:ee030cef-74d4-435d-8228-b85f0e6203db][Differential gene expression]]
**** DNA-seq pre-alignment processing and QC
:PROPERTIES:
:ID:       719b2017-4ec6-44dd-8e91-a677bc6654bd
:END:
- https://github.com/najoshi/sickle
**** Fusion calling
:PROPERTIES:
:ID:       98cb2e65-cf56-40eb-b563-146995379785
:END:
- https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-021-08094-z
**** Get TSS
:PROPERTIES:
:ID:       439986eb-c927-4395-ad28-b86d6ead9d29
:END:
get tss as annotation https://www.biostars.org/p/68883/
**** Loss of heterozygosity
:PROPERTIES:
:ID:       6b382553-966b-4f3c-903d-3d683eaec937
:END:
https://www.sciencedirect.com/science/article/pii/S0016508522010861?via%3Dihub
https://www.biostars.org/p/254848/#:~:text=%22The%20B%2DAllele%20Frequency%20is,alleles%20(e.g.%20AB).%22
**** Machine learning of whole genome sequencing data
:PROPERTIES:
:ID:       38c00ba1-299f-4a0d-959e-58845d12c712
:END:
- cite:mathios2021
- cite:widman2022
**** Make bwa index                                                :smk_rule:
:PROPERTIES:
:ID:       b33fa8d9-014a-4f8e-9f0d-e7bb6d72a48e
:END:
- [[id:794e1794-9219-4cf5-b140-03cfff4ef1ef][bwa tool header]]
- Snakemake
  #+begin_src snakemake
rule make_bwa_index_:
    input:
        fasta = config["data_dir"] + "/inputs/hg19.fa.gz",
    params:
        out_dir = config["data_dir"] + "/ref/hg19_bwa"
        prefix = config["data_dir"] + "/ref/hg19_bwa/hg19"
    output:
        config["data_dir"] + "/ref/hg19_bwa/hg19.amb"
    shell:
        """
        scripts/make_bwa_index_.sh {params.out_dir} {params.prefix} {input.fasta}
        """
#+end_src
- [[file:./workflow/scripts/make_bwa_index_.sh][Base script]]
  #+begin_src bash :tangle ./workflow/scripts/make_bwa_index_.sh
mkdir -p $1
bwa index -p $2 -a bwtsw $3
# Snakemake variables
# Function
# Run command
#+end_src

**** Mappability
:PROPERTIES:
:ID:       347d4cc0-a25d-4636-96d4-65e6319022df
:END:
- http://hgdownload.soe.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeMapability/wgEncodeCrgMapabilityAlign100mer.bigWig
- cite:derrien2012

***** Mappability
:PROPERTIES:
:ID:       725d6aa5-9bbc-404b-aa2a-d97206a2d2ed
:END:
=======
**** methylation sequencing
:PROPERTIES:
:ID:       d9b52bbd-ec6a-4b9e-af4b-17f6efafdcf6
:END:
- Bisulfite-free approaches
  - [[id:85e691cc-ebb3-4d74-825b-1c9204fb9c96][EM-seq]]
  - Six letter [cite:@fullgrabe2023six]
- https://nf-co.re/methylseq/output
- https://clinicalepigeneticsjournal.biomedcentral.com/articles/10.1186/s13148-019-0795-x#Sec8
- https://www.biostars.org/p/164929/
- https://academic.oup.com/gigascience/article/10/5/giab033/6272610
[[file:~/repos/biotools/biotools.org::*cfDNA methylation][cfDNA methylation]]
https://www.nature.com/articles/nature23891
**** Multiome ATAC + gene expression
:PROPERTIES:
:ID:       122a3764-01e0-457f-aa50-919142822cc4
:END:
https://www.10xgenomics.com/products/single-cell-multiome-atac-plus-gene-expression
**** Multiome ATAC + gene expression
:PROPERTIES:
:ID:       8859ad56-d367-4000-9895-7dc9baf41756
:END:
https://cdn.10xgenomics.com/image/upload/v1660261285/support-documents/CG000375_DemonstratedProtocol_NucleiIsolationComplexSample_ATAC_GEX_Sequencing_Rev_C.pdf
https://www.10xgenomics.com/products/single-cell-multiome-atac-plus-gene-expression
**** Mutation and expression signatures
:PROPERTIES:
:ID:       89b998c1-db24-4e59-b248-f4e5fc246fec
:END:
[[cite:&alexandrov2020]]
https://aacrjournals.org/cancerdiscovery/article/10/4/552/2575/Impaired-Death-Receptor-Signaling-in-Leukemia
https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-022-01050-w#Sec25
https://www.nature.com/articles/nature12477

https://www.cell.com/cell-genomics/pdfExtended/S2666-979X(22)00124-0
https://www.nature.com/articles/s41467-022-32598-1#Sec11
https://www.nature.com/articles/s41586-020-1943-3
https://aacrjournals.org/cancerdiscovery/article/10/4/552/2575/Impaired-Death-Receptor-Signaling-in-Leukemia
https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-022-01050-w#Sec25
https://www.nature.com/articles/nature12477
**** NEBNext Enzymatic Methyl-seq kit
:PROPERTIES:
:ID:       0544a998-3be1-4ab7-ad67-72b8007aed71
:END:
https://www.neb.com/products/e7120-nebnext-enzymatic-methyl-seq-kit#Product%20Information
https://www.neb.com/-/media/nebus/files/application-notes/technote_nebnext_enzymatic_methyl-seq.pdf?rev=015e017f782a4bc9b50b61f1b0f3c807&hash=E23FFED5E02C7A282E753B6B8F555A30

**** Nucleic acid sequence alignment
:PROPERTIES:
:ID:       326ecd60-8cd4-4815-a389-967b2c3fef0a
:END:
- fastas for sequence alignment
  - https://lh3.github.io/2017/11/13/which-human-reference-genome-to-use
  - https://hgdownload.soe.ucsc.edu/goldenPath/mm10/bigZips/ "The initial/ subdirectory contains files for the initial release of GRCm38, which has 66 sequences, and no original alternate sequences and no fix sequences. It is the same as the parent download directory. This is probably the best genome file for aligners and most analysis tasks, a version called "analysisSet" for the human genome."
- https://www.biostars.org/p/352354/
- https://www.biostars.org/p/342482/
- https://www.biostars.org/p/388935/

https://www.illumina.com/science/genomics-research/articles/dragen-demystifying-reference-genomes.html

https://gatk.broadinstitute.org/hc/en-us/articles/360041155232-Reference-Genome-Components

73. Li,H. and Homer,N. (2010) A survey of sequence alignment
algorithms for next-generation sequencing. Brief. Bioinform., 11,
473–483.
174. Bao,S., Jiang,R., Kwan,W., Wang,B., Ma,X. and Song,Y.-Q. (2011)
Evaluation of next-generation sequencing software in mapping and
assembly. J. Hum. Genet., 56, 406–414.

- hash table like BLAST or suffic/prefix like Burrows-Wheeler Transform
- https://davetang.org/muse/2017/10/25/getting-started-hisat-stringtie-ballgown/
- prerequisites
  - adaptor identification and trimming

**** Omics integration
:PROPERTIES:
:ID:       00e4056a-e9b7-48e2-ba0e-3b37e8e36c69
:END:
https://www-nature-com-s.caas.cn/articles/s41568-021-00408-3?error=cookies_not_supported&code=ad37411b-42f4-4689-9a3b-1605f1f40eaf
https://www.sciencedirect.com/science/article/pii/S2666379122000258?via%3Dihub
https://www.nature.com/articles/s41421-021-00366-y
https://www.nature.com/articles/s41568-021-00408-3
cite:bakhoum2021
https://www.nature.com/articles/s41591-018-0323-0
https://pubmed.ncbi.nlm.nih.gov/34172972/ https://umgear.org/
https://www.nature.com/articles/d41586-021-01994-w
- cite:tarazona2020
- https://www.sciencedirect.com/science/article/pii/S2001037020302816#s0030
- https://workflows.omnipathdb.org/
- https://academic.oup.com/bioinformatics/article/36/8/2632/5689817
- cite:higdon2015
- https://jme.bioscientifica.com/view/journals/jme/62/1/JME-18-0055.xml
- http://mixomics.org/webinar-pls-methods/
- http://europepmc.org/backend/ptpmcrender.fcgi?accid=PMC3618897&blobtype=pdf
- https://danielhomola.com/assets/DanielHomola_PhD.pdf
- cite:bersanelli2016
- cite:rappoport2018
- cite:subramanian2020
- cite:wu2019
- https://link.springer.com/protocol/10.1007%2F978-1-0716-0849-4_12
***** example papers
:PROPERTIES:
:ID:       2f988662-9368-436d-8bf7-8d072eccfb48
:END:
- https://www.sciencedirect.com/science/article/pii/S2666379122000258?via%3Dihub
- https://academic.oup.com/nar/article/47/19/10010/5573547
***** Omics integration
:PROPERTIES:
:ID:       00e4056a-e9b7-48e2-ba0e-3b37e8e36c69
:END:
https://www-nature-com-s.caas.cn/articles/s41568-021-00408-3?error=cookies_not_supported&code=ad37411b-42f4-4689-9a3b-1605f1f40eaf
https://www.sciencedirect.com/science/article/pii/S2666379122000258?via%3Dihub
https://www.nature.com/articles/s41421-021-00366-y
https://www.nature.com/articles/s41568-021-00408-3
cite:bakhoum2021
https://www.nature.com/articles/s41591-018-0323-0
https://pubmed.ncbi.nlm.nih.gov/34172972/ https://umgear.org/
https://www.nature.com/articles/d41586-021-01994-w
- cite:tarazona2020
- https://www.sciencedirect.com/science/article/pii/S2001037020302816#s0030
- https://workflows.omnipathdb.org/
- https://academic.oup.com/bioinformatics/article/36/8/2632/5689817
- cite:higdon2015
- https://jme.bioscientifica.com/view/journals/jme/62/1/JME-18-0055.xml
- http://mixomics.org/webinar-pls-methods/
- http://europepmc.org/backend/ptpmcrender.fcgi?accid=PMC3618897&blobtype=pdf
- https://danielhomola.com/assets/DanielHomola_PhD.pdf
- cite:bersanelli2016
- cite:rappoport2018
- cite:subramanian2020
- cite:wu2019
- https://link.springer.com/protocol/10.1007%2F978-1-0716-0849-4_12
****** example papers
:PROPERTIES:
:ID:       2ccd35f7-9b02-43fe-b16b-5368607d6b27
:END:
- https://www.sciencedirect.com/science/article/pii/S2666379122000258?via%3Dihub
- https://academic.oup.com/nar/article/47/19/10010/5573547
**** Pathway encoding and diagramming
:PROPERTIES:
:ID:       a145b61d-7cd8-476f-899f-3314dca872fe
:END:

:PROPERTIES:
:ID:       d84cf649-32f4-46e6-b041-4a8a76b31ffc
:END:
:LOGBOOK:
CLOCK: [2022-02-22 Tue 10:11]--[2022-02-22 Tue 11:59] =>  1:48
CLOCK: [2022-02-22 Tue 08:00]--[2022-02-22 Tue 09:45] =>  1:45

:END:
- https://www.nature.com/articles/nrg3885
- SBGN
  - https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005740
  - https://sbgn.github.io/
  - https://www.cls.uni-konstanz.de/software/vanted/
- https://new.wikipathways.org/academy/
- https://github.com/gladstone-institutes/Bioinformatics-Workshops/wiki/Introduction-to-Pathway-Modeling
- 25 years of pathways
  - https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-02181-2#:~:text=In%20the%20end%2C%2065k%20pathway,in%20WikiPathways%20or%20Reactome%20databases.
  - https://gladstone-bioinformatics.shinyapps.io/shiny-25years/
- [[id:784895e5-0c94-4458-9cfb-f52759718ab3][NDEx]]
- cite:wikipathways
- [[id:69bfa728-e149-4b8a-9863-347630f86bc4][wikipathways biotool]]
- [[id:17c865dc-765c-496d-b5c7-60d3d3439de3][pathvisio biotool]]
**** RNA-seq for mitochondrial transcripts
:PROPERTIES:
:ID:       d9c23a89-d738-4427-805e-01679de57d79
:END:

**** Send-out sequencing services
:PROPERTIES:
:ID:       eed1938c-ea0a-433e-8ed0-1696931644b5
:END:
- https://www.reddit.com/r/bioinformatics/comments/13py5j8/folks_who_send_their_samples_out_for_sequencing/
- [[file:~/repos/org/science.org::#e9f3ca18-6066-414e-92a6-268ee5858407][GTAC]]
**** Sequence reverse compliment in shell
:PROPERTIES:
:ID:       ff147ecc-dd7b-4ac8-8df5-7ee5b5c9e021
:END:
https://bioinformatics.stackexchange.com/questions/7458/what-is-a-quick-way-to-find-the-reverse-complement-in-bash
**** Sequencing depth
:PROPERTIES:
:ID:       36750e4f-4b92-4b4a-ac82-80088f853b7e
:END:
https://www.google.com/search?q=%22samtools+depth%22+%22wgs%22&oq=%22samtools+depth%22+%22wgs%22&aqs=chrome..69i57.25710j0j4&sourceid=chrome-mobile&ie=UTF-8

- samtools for depth https://www.biostars.org/p/356937/
**** Sequencing testing, modeling, and read simulation
:PROPERTIES:
:ID:       f44b9dce-d7fa-4b6a-9949-49ff3c02547c
:END:
- Read simulation
  - https://medium.com/computational-biology/a-simple-introduction-to-read-simulators-bbeff4f0c0c6
  - RNA-seq reads https://rdrr.io/bioc/polyester/
  - https://github.com/lh3/wgsim
- variant simulator http://bioinform.github.io/varsim/
- Downsample
  - at fastq
    - https://www.biostars.org/p/6544/
  - at bam
    - subsample function for reads instead of fraction
- Reference
  - [[https://www.reddit.com/r/bioinformatics/comments/c313uk/what_are_some_common_tasks_that_i_should_brush_up/][reddit: What are some common tasks that I should brush up on, that pertain to NGS?]]
# #https://www.biostars.org/p/76791/
# function SubSample {
# FACTOR=$(samtools idxstats $1 | cut -f3 | awk -v COUNT=$2 'BEGIN {total=0} {total += $1} END {print COUNT/total}')
# }
# SubSample $localdata/bams/lib080.dedup.bam
# if [[ $FACTOR > 1 ]]
#   then
#   echo '[ERROR]: Requested number of reads exceeds total read count in' $1 '-- exiting' && exit 1
# fi

# sambamba view -s $FACTOR -t 2 -f bam -l 5 $1

# }

# export -f SubSample

# ls *.bam | parallel "SubSample {} 50000000 > {.}_subsampled.bam"

    - https://bioinformatics.stackexchange.com/questions/402/how-can-i-downsample-a-bam-file-while-keeping-both-reads-in-pairs
    - (no pair preservation) https://www.biostars.org/p/44527/#126428 https://www.biostars.org/p/145820/
    - w/ sambamba # bam_sample(){
#     base=`basename -s .bam $1`
#     sambamba view -f sam -t 30 $1 | shuf -n $2 > $3/${base}_${2}_sample
# }

***** modeling
:PROPERTIES:
:ID:       00983e26-ec16-4f68-be0d-2f59eb31def4
:END:
- http://www.nytimes.com/2012/07/21/science/in-a-first-an-entire-organism-is-simulated-by-software.html?_r=2
- https://www.ebi.ac.uk/biomodels-main/
- https://precision.fda.gov/challenges/
- Synthetic biology- cite:caschera2014
***** Generating Simulated Reads
:PROPERTIES:
:ID:       cc007fa5-7ff2-4847-b566-bc7268ab23c2
:END:
:PROPERTIES:
:ID:       8877C684-C217-4E7C-8E19-3D972A4015B2
=======
:END:
- https://www.nature.com/articles/nrg3885
- SBGN
  - https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005740
  - https://sbgn.github.io/
  - https://www.cls.uni-konstanz.de/software/vanted/
- https://new.wikipathways.org/academy/
- https://github.com/gladstone-institutes/Bioinformatics-Workshops/wiki/Introduction-to-Pathway-Modeling
- 25 years of pathways
  - https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-02181-2#:~:text=In%20the%20end%2C%2065k%20pathway,in%20WikiPathways%20or%20Reactome%20databases.
  - https://gladstone-bioinformatics.shinyapps.io/shiny-25years/
- [[id:784895e5-0c94-4458-9cfb-f52759718ab3][NDEx]]
- cite:wikipathways
- [[id:69bfa728-e149-4b8a-9863-347630f86bc4][wikipathways biotool]]
- [[id:17c865dc-765c-496d-b5c7-60d3d3439de3][pathvisio biotool]]
**** Simulate sequencing reads
:PROPERTIES:
:ID:       4f7a4e1e-967c-40e7-9baf-f85281ccf79b
:END:
#+begin_src bash
cd ~/data
source ~/repos/mpnst/bin/setup.sh
docker_interactive
bioinformatics-toolkit
which simNGS
cd /home/jeszyman/data
ls
mkdir -p /home/jeszyman/data/simNGS-runfiles
wget --directory-prefix=/home/jeszyman/data/ref/simNGS-runfiles \
     --no-check-certificate \
     --no-directories \
     --accept "*.runfile" \
     --recursive --level=3 \
     --no-clobber https://www.ebi.ac.uk/goldman-srv/simNGS/runfiles5/HiSeq/
cat /home/jeszyman/data/ref/hg19.fa | simNGS \
                                          --paired paired /home/jeszyman/data/ref/simNGS-runfiles/s_4_4x.runfile > test.fq


- http://www.blopig.com/blog/2018/03/running-jupyter-notebook-on-a-remote-server-via-ssh/
- https://www.reddit.com/r/bioinformatics/comments/7gxsk0/does_anyone_use_cwl_does_it_actually_help_you_get/
- https://cromwell.readthedocs.io/en/stable/
- nextflow
  - https://www.youtube.com/watch?v=jsxTC8pNPUc
    - workflows are fragile
  - https://www.nextflow.io/example1.html
  - https://github.com/nf-core/rnaseq
  - https://www.ncbi.nlm.nih.gov/pubmed/?term=nextflow
- [[https://software.broadinstitute.org/wdl/userguide/][widdle]]
- http://rabix.io/
- http://bioboxes.org/docs/example-biobox-use/
****** Computer clusters
:PROPERTIES:
:ID:       4a5e39d9-48f5-4542-b7bf-e44ac77ead41
:END:
=======
#+end_src
**** Spatial ATAC-seq
:PROPERTIES:
:ID:       4de39606-9232-4cfc-b444-f4a27e577862
:END:
https://www.nature.com/articles/s41587-022-01603-9
**** [[id:d21f49c7-7c4a-4126-aad8-3d4360ef84e2][Subsample (downsample) a bam file]]
**** Transcription factor binding site prediciton
:PROPERTIES:
:ID:       55be49c3-12ba-4bff-bd54-f35c140361ad
:END:
https://www.nature.com/articles/s41592-019-0511-y
**** Variant interpretation
:PROPERTIES:
:ID:       fcb52ad1-8f31-427e-8dd7-3f4c1588a8ec
:END:
https://pubmed.ncbi.nlm.nih.gov/36373660/
https://www.nature.com/articles/s43018-022-00379-w
**** Whole-genome sequencing
:PROPERTIES:
:ID:       ccab4617-0399-4ba3-828e-b5fbbb972ba1
:END:
https://singularity.lbl.gov/install-linux

*** Genomics language models
https://www.reddit.com/r/bioinformatics/comments/1nychxo/anyone_recommend_tutorials_on_fine_tuning/

** Snakemake demo                                                      :demo:
:PROPERTIES:
:ID:       e17bc34d-6bdb-44e2-b820-754dc042cf79
:END:
** Glossary
:PROPERTIES:
:ID:       e9629f93-81c0-47ca-84f9-f8629f7ad88c
:END:
-
** Bioinformatics software tools
:PROPERTIES:
:ID:       db5b3d18-d670-4ed8-9ba3-0a01032393c2
:END:
- https://arcinstitute.org/tools/evo/evo-designer

*** 0 Bioinformatics software flat list
:PROPERTIES:
:ID:       1b8bb7db-2622-47bd-bd6f-052cbd5d4fdb
:END:
**** Ecotyper
:PROPERTIES:
:ID:       8151ed0d-4b7b-4506-be44-9838291eec2f
:END:
https://www.nature.com/articles/s42003-023-05117-1#Sec2
**** bioanalyzeR                                                    :biotool:
:PROPERTIES:
:ID:       ea6092a7-8c57-4063-a5b5-64e88652c818
:END:
- https://jwfoley.com/bioanalyzeR.html#importing-data

**** pybedtools
:PROPERTIES:
:ID:       8ff1761e-908a-4db8-9b5e-fd553572d655
:END:
https://daler.github.io/pybedtools/autodocs/pybedtools.bedtool.BedTool.subtract.html#pybedtools.bedtool.BedTool.subtract
[[id:05f314e8-f402-45cb-ac1f-e3dece4f3114][bedtools]]
https://daler.github.io/pybedtools/index.html
https://daler.github.io/pybedtools/sh-comparison.html#shell-comparison
**** annotationDb
:PROPERTIES:
:ID:       788333a5-9808-4382-9598-d5e6ad67f122
:END:
|   |   | [[https://bioconductor.org/packages/release/bioc/vignettes/AnnotationDbi/inst/doc/IntroToAnnotationPackages.pdf][doc]] |   |   |
**** annovar
:PROPERTIES:
:ID:       bcc524b6-7540-49b2-80b3-90e8a1f54e6a
:END:
[[http://annovar.openbioinformatics.org/en/latest/][doc]]
**** ATACseqQC                                                      :biotool:
:PROPERTIES:
:ID:       a5b73c70-3f1f-4018-92b2-bfdcaed53cf5
:CREATED:  [2021-09-13 Mon 07:29]
:function: qc
:input: bam
:repo:
:doc:
:paper:
:END:
- ATAC fraction of reads in peaks
- http://biocworkshops2019.bioconductor.org.s3-website-us-east-1.amazonaws.com/page/ATACseqQCWorkshop__ATACseqQC_workshop/
- https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-018-4559-3#Sec15
- https://haibol2016.github.io/ATACseqQCWorkshop/articles/ATACseqQC_workshop.html
- https://bioinformatics-core-shared-training.github.io/cruk-summer-school-2019/ChIPSeq/Materials/Practicals/Day5/Practical01_ATAC-seq_analysis_SS.html
**** BBmap / BBSplit                                                :biotool:
:PROPERTIES:
:ID:       52363054-5138-419c-8d45-4ec9b0b02b24
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- http://seqanswers.com/forums/archive/index.php/t-87619.html
- https://jgi.doe.gov/data-and-tools/bbtools/bb-tools-user-guide/bbmap-guide/
- outu = unmapped reads
- snakemake example https://www.biostars.org/p/424706/
- http://seqanswers.com/forums/showthread.php?t=41288
- [ ] BBSplit in BBmap - [[https://mail.google.com/mail/u/0/#inbox/FMfcgxwJZJWQrGSPgdPGNfStWbxXkmhP][email]]]]
- https://www.google.com/search?q=bbmap+docker use bioconda
**** bcl2fastq
:PROPERTIES:
:ID:       587a9a86-5809-4eb4-a900-30d9aa7bf859
:END:
https://support.illumina.com/content/dam/illumina-support/documents/documentation/software_documentation/bcl2fastq/bcl2fastq2-v2-20-software-guide-15051736-03.pdf
**** bcl2fastq
:PROPERTIES:
:ID:       192aff60-cb32-41f6-ab9b-6ce3b7a75e56
:END:
https://support.illumina.com/content/dam/illumina-support/documents/documentation/software_documentation/bcl2fastq/bcl2fastq2-v2-20-software-guide-15051736-03.pdf
**** BEDOPS                                                         :biotool:
:PROPERTIES:
:ID:       0be280ad-47b6-42f4-8a65-4fadadf4940b
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- https://bedops.altius.org/forum/index.php?topic=20.0
- https://bedops.readthedocs.io/en/latest/index.html
**** bedtools                                                       :biotool:
:PROPERTIES:
:doc: [[http://bedtools.readthedocs.io/en/latest/][doc]]
:paper: cite:quinlan2010       |
:CREATED:  [2021-09-01 Wed 13:42]
:ID:       05f314e8-f402-45cb-ac1f-e3dece4f3114
:END:
[[id:8ff1761e-908a-4db8-9b5e-fd553572d655][pybedtools]]
**** BiocParallel                                                   :biotool:
:PROPERTIES:
:ID:       f9e1a60e-fe3c-4fd8-af73-3ce0167fbec7
:END:
https://bioconductor.org/packages/devel/bioc/vignettes/BiocParallel/inst/doc/Introduction_To_BiocParallel.pdf
**** BISulfite-seq CUI Toolkit (BISCUIT)
:PROPERTIES:
:doc: https://huishenlab.github.io/biscuit/
:paper: https://doi.org/10.1093/nar/gkae097
:repo: https://github.com/huishenlab/biscuit
:input:
:function:
:ID:       5e9e8bfa-ac9e-4103-9cc5-7123337b4e24
:END:
**** bismark
:PROPERTIES:
:ID:       b9fd11de-3064-40de-be3d-eae089c7316d
:END:
https://www.bioinformatics.babraham.ac.uk/projects/bismark/Bismark_User_Guide.pdf
- https://github.com/FelixKrueger/Bismark/issues/241
- https://github.com/FelixKrueger/Bismark
https://www.nature.com/articles/nmeth.1828
**** BLAT                                                           :biotool:
:PROPERTIES:
:ID:       6e44c130-0eaa-4e44-8c12-c7c8125ab9ec
:CREATED:  [2021-09-13 Mon 07:29]
:END:
  - https://www.youtube.com/watch?v=E6DDNGDXH8A
**** bowtie2                                                        :biotool:
:PROPERTIES:
:ID:       8883a37b-867c-4c19-8e9c-2b46004125a1
:CREATED:  [2021-09-13 Mon 07:29]
:END:
| bowtie2 |   |   | [[https://sourceforge.net/projects/bowtie-bio/files/][src]] | [[http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#the-bowtie2-build-indexer][doc]] |   |   |
- [[https://currentprotocols.onlinelibrary.wiley.com/doi/10.1002/0471250953.bi1107s32][protocol paper]]
- [[http://bowtie-bio.sourceforge.net/index.shtml][doc]]
**** bwa                                                           :biotools:
:PROPERTIES:
:ID:       794e1794-9219-4cf5-b140-03cfff4ef1ef
:END:
https://www.biostars.org/p/270090/
| bwa | align | fastq |   | [[http://bio-bwa.sourceforge.net/bwa.shtml][site]] |   |   |

For the correct reference, see https://lh3.github.io/2017/11/13/which-human-reference-genome-to-use
#+begin_src bash
wget ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/001/405/GCA_000001405.15_GRCh38/seqs_for_alignment_pipelines.ucsc_ids/GCA_000001405.15_GRCh38_no_alt_analysis_set.fna.gz
#+end_src

[[id:e9e201b5-4a94-4861-8de8-803676c3a37f][Genome reference builds and associated sequences]]
**** canvas                                                         :biotool:
:PROPERTIES:
:ID:       74ef57cd-c44a-4f28-b4a1-5a54a82ce5a3
:CREATED:  [2021-09-13 Mon 07:29]
:END:
https://github.com/Illumina/canvas


  - https://github.com/chrisamiller/copyCat
  - for cah https://bioconductor.org/packages/release/bioc/html/DNAcopy.html


**** cappSeq
:PROPERTIES:
:ID:       772e6173-9dee-42ec-8604-4ff77a55bc77
:END:
- cappseq https://mail.google.com/mail/u/0/?ui=2&ik=ff50768eb7&view=lg&permmsgid=msg-f:1658523263188957345
**** ChIPseeker                                                     :biotool:
:PROPERTIES:
:ID:       a4cf29e3-7fa6-4ea2-a538-f59ec450cc7b
:END:
- [[https://rdrr.io/bioc/ChIPseeker/man/annotatePeak.html][rdrr ChIPseeker]]
- [[https://bioconductor.org/packages/devel/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html#:~:text=ChIPseeker%20is%20an%20R%20package,peaks%20binding%20to%20TSS%20regions.&text=Moreover%2C%20it%20supports%20evaluating%20significant%20overlap%20among%20ChIP%2Dseq%20datasets][ChIPseeker vignette]].

**** CIBERSORTx and cytotrace                                       :biotool:
:PROPERTIES:
:ID:       6fdb7ece-efbb-4523-a7a5-7dd594d199dd
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- https://www.cell.com/cell/fulltext/S0092-8674(21)01061-8?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS0092867421010618%3Fshowall%3Dtrue
- https://ecotyper.stanford.edu/
- https://cytotrace.stanford.edu/
**** clusterProfiler
:PROPERTIES:
:ID:       8e4c1fb8-cd52-4fac-900a-4b6e6eb5a28a
:END:
- https://learn.gencore.bio.nyu.edu/rna-seq-analysis/gene-set-enrichment-analysis/
- https://yulab-smu.top/biomedical-knowledge-mining-book/enrichment-overview.html
**** cnvkit                                                         :biotool:
:PROPERTIES:
:ID:       b471102b-2e5a-4d67-97e6-b03cf4d923b9
:CREATED:  [2021-09-13 Mon 07:29]
:END:


| CNVkit | copy# | bam | [[https://github.com/etal/cnvkit/tree/fd3555256d2a5aa3978c475d19c88065be68c6c4][repo]] | [[https://cnvkit.readthedocs.io/en/stable/index.html][doc]] | [[https://doi.org/10.1371/journal.pcbi.1004873][paper]] |   |
- modify autobin https://github.com/etal/cnvkit/blob/fa86632a5731ebbefb0092069c8031f806c8b611/cnvlib/autobin.py
oldcode from mpnst

# tumor_bam="/duo4/capp-runs/HiSeqW11/demultiplexed/Sample_PC3-N1_Normal/Sample_PC3-N1_Normal.sorted.samtools-deduped.sorted.bam"
# normal_bam="/duo4/capp-runs/HiSeqW11/demultiplexed/Sample_69-C1_cfDNA/Sample_69-C1_cfDNA.sorted.samtools-deduped.sorted.bam"
# bait_bed="/duo4/users/jszymanski/projects/mpnst/170907_HG38_CCDS1X_REZ_capture_targets.bed"
# fasta="/duo4/users/jszymanski/data/ref/hg19.fa"

# cd $workdir/analysis/


# nohup cnvkit.py batch \
# 	  $tumor_bam \
# 	  --normal $normal_bam \
# 	  --targets $bait_bed \
#           --fasta $fasta \
#           --output-reference my_reference.cnn \
# 	  --output-dir results/ \
#           --diagram --scatter

# # Reusing a reference for additional samples
# cnvkit.py batch *Tumor.bam -r Reference.cnn -d results/

# # Reusing targets and antitargets to build a new reference, but no analysis
# cnvkit.py batch -n *Normal.bam --output-reference new_reference.cnn \
#     -t my_targets.bed -a my_antitargets.bed \
#     -f hg19.fasta -g data/access-5kb-mappable.hg19.bed
# https://cnvkit.readthedocs.io/en/stable/nonhybrid.html
## considers WGS as jsut no off-target regions
## so no target file
## NEED TO ANNOTATE
#wget http://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/refFlat.txt.gz
#mv refFlat.txt.gz /duo4/users/jszymanski/data/ref/
#cd /duo4/users/jszymanski/data/ref/
#gunzip refFlat.txt.gz

source ~/repos/mpnst/bin/local-setup.sh
docker_interactive
biotools
mkdir -p /duo4/mpnst/downsample-cnn
cd /duo4/mpnst/downsample-cnn


cnvkit.py batch /duo4/mpnst/downsample-bam/pn*.sorted.bam /duo4/mpnst/downsample-bam/mp*.sorted.bam\
          -n /duo4/mpnst/downsample-bam/nm*.sorted.bam \
          -m wgs -f /drive3/users/jszymanski/data/ref/bwa-hg19/hg19.fa \
          --annotate /drive3/users/jszymanski/data/ref/refFlat.txt -p 32

- https://www.biostars.org/p/247903/
- https://gatkforums.broadinstitute.org/gatk/discussion/2909/how-to-fix-a-badly-formatted-bam
- [[https://github.com/lh3/seqtk][seqtk]]
- sequence file manipulation
  - https://gist.github.com/davfre/8596159
  - [[https://www.biostars.org/p/6544/][look at all the ways to split a bam file!]]
**** complexheatmap                                                 :biotool:
:PROPERTIES:
:ID:       af78e4e0-a184-480f-95ac-ce9a0db35246
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- https://www.biostars.org/p/286187/#286507
**** Cytoscape                                                      :biotool:
:PROPERTIES:
:ID:       46cf789e-d185-46da-bb32-8cf6113f3425
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- [[http://manual.cytoscape.org/en/stable/index.html][documentation]]
- https://stackoverflow.com/questions/tagged/cytoscape
**** deeptools
:PROPERTIES:
:ID:       eed87e1e-c18e-4dec-a283-8d2d878e48ae
:END:
| deepTools |   |   |   | [[https://deeptools.readthedocs.io/en/latest/content/example_usage.html][site]] |   |   |
**** DEGreport
:PROPERTIES:
:ID:       90e250dd-5b76-41f1-96f8-117e21132ca0
:END:
https://hbctraining.github.io/DGE_workshop/lessons/08_DGE_LRT.html
https://bioconductor.org/packages/release/bioc/vignettes/DEGreport/inst/doc/DEGreport.html
https://www.biostars.org/p/497108/
**** DESeq2                                                         :biotool:
:PROPERTIES:
:ID:       2F642F69-A9C8-46DA-BE31-783AC8D4F4B6
:CREATED:  [2021-01-27 Wed 07:00]
:END:
- https://rstudio-pubs-static.s3.amazonaws.com/329027_593046fb6d7a427da6b2c538caf601e1.html
- remove factor levels https://support.bioconductor.org/p/61875/
| DESeq2 | diff express |   |   |   |   | cite:love2014 |
- Notes
  - a negative binomial GLM
- https://genviz.org/module-04-expression/0004/02/01/DifferentialExpression/

- https://bioc.ism.ac.jp/packages/2.14/bioc/vignettes/DESeq2/inst/doc/beginner.pdf
- [[file:~/Box%20Sync/library/Love,14%20Moderated%20estimation%20of%20fold%20change%20and%20dispersion%20for%20RNA%20seq%20data%20with%20DESeq2.pdf][Love,14 Moderated estimation of fold change and dispersion for RNA seq data with DESeq2]]
- http://www.nathalievilla.org/doc/html/solution-DESeq2-rnaseq.html


***** [[https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html][documentation]]
:PROPERTIES:
:ID:       3d14248a-38cf-4715-93f8-8c415fc60575
:END:
***** Processes
:PROPERTIES:
:ID:       f15ffa0e-3e26-4bee-9aef-70f8c0e12b2f
:END:
- Statistical design
  - https://support.bioconductor.org/p/110163/
  - handling nested designs https://support.bioconductor.org/p/64480/
  - LRT
    - https://hbctraining.github.io/DGE_workshop/lessons/08_DGE_LRT.html
  - Methods writeup
    - LRT is evaluated akin to ANOVA with Wald tests serving as post-hoc significance of specific group comparisons.
- import functions
  | function          | package           | framework | output               | DESeq2 input function    |
  | summarizeOverlaps | GenomicAlignments | R         | SummarizedExperiment | DESeqDataSet             |
  | featureCounts     | Rsubread          | R         | matrix               | DESeqDataSetFromMatrix   |
  | tximport          | tximport          | R         | list of matrices     | DESeqDataSetFromTximport |
  | htseq-count       | HTSeq             | Python    | files                | DESeqDataSetFromHTSeq    |
- reset design https://support.bioconductor.org/p/9135927/
- Subset https://www.google.com/search?q=subset+deseqdataset
  - https://www.biostars.org/p/442188/
***** Examples- see [[file:~/Box%20Sync/comp_bio/deseq2_template/][deseq2_template]]
:PROPERTIES:
:ID:       5C8E2A3B-2C16-4FB3-9F86-5A1D8AD4802F
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- vignettes
  - [[https://bioconductor.org/packages/release/workflows/vignettes/rnaseqGene/inst/doc/rnaseqGene.html#exploratory-analysis-and-visualization][gene workflow 19]]
  - [[http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#using-parallelization][package vignette]]
****** DONE Example 1: [[file:~/Box%20Sync/comp_bio/deseq2_template/Love,15%20RNA%20seq%20workflow%20gene%20level%20exploratory%20analysis%20and%20differential%20expression.pdf][Love,15 Airway]]
CLOSED: [2016-06-27 Mon 14:45]
:PROPERTIES:
:ID:       791A1ABC-4138-4CD2-82AE-63905C053571
:CREATED:  [2021-09-13 Mon 07:29]
:END:
:LOGBOOK:
CLOCK: [2016-06-27 Mon 10:22]--[2016-06-27 Mon 10:37] =>  0:15
CLOCK: [2016-06-23 Thu 09:22]--[2016-06-23 Thu 10:19] =>  0:57
CLOCK: [2016-06-22 Wed 17:56]--[2016-06-22 Wed 18:30] =>  0:34
CLOCK: [2016-06-22 Wed 14:50]--[2016-06-22 Wed 16:02] =>  1:12
CLOCK: [2016-06-22 Wed 12:09]--[2016-06-22 Wed 12:57] =>  0:48
CLOCK: [2016-06-22 Wed 11:40]--[2016-06-22 Wed 11:46] =>  0:06
:END:

****** DONE Example 2: [[file:~/Box%20Sync/comp_bio/deseq2_template/https___software.rc.fas.harvard.edu_ngsdata_workshops_2015_March_DESeq2_fruitfly.pdf][Drosophila]]
CLOSED: [2016-06-27 Mon 14:45]
:PROPERTIES:
:ID:       CC047BA0-35A3-420B-BB60-CA1AA7AE275B
:CREATED:  [2021-09-13 Mon 07:29]
:END:

https://software.rc.fas.harvard.edu/ngsdata/workshops/2015_March/DESeq2_fruitfly.html

****** DONE Example 3: Hox
CLOSED: [2016-06-28 Tue 13:48]
:PROPERTIES:
:ID:       97126EA4-E1CD-4CD5-9746-A7C9393DF712
:CREATED:  [2021-09-13 Mon 07:29]
:END:

http://www.gettinggeneticsdone.com/2015/12/tutorial-rna-seq-differential.html

****** Example 4 [[file:~/Box%20Sync/comp_bio/Love,16%20Differential%20analysis%20of%20RNA%20seq%20data%20using%20the%20DESeq2%20package.pdf][Love,16 Differential analysis of RNA seq data the DESeq2 package]]
:PROPERTIES:
:ID:       61BDAC0E-3F02-482A-868E-93AC26B33361
:CREATED:  [2021-09-13 Mon 07:29]
:END:
:LOGBOOK:
CLOCK: [2016-06-22 Wed 11:15]--[2016-06-22 Wed 11:40] =>  0:25
CLOCK: [2016-06-21 Tue 16:41]--[2016-06-21 Tue 16:59] =>  0:18
CLOCK: [2016-06-21 Tue 15:33]--[2016-06-21 Tue 16:31] =>  0:58
CLOCK: [2016-06-20 Mon 13:48]--[2016-06-20 Mon 14:21] =>  0:33
CLOCK: [2016-06-20 Mon 12:21]--[2016-06-20 Mon 12:23] =>  0:02
:END:

******* Standard workflow
:PROPERTIES:
:ID:       ABBDC255-8B16-4598-AA75-6D0ADAD3E48E
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Input data
:PROPERTIES:
:ID:       71704A3E-FEE2-4363-BA67-4CA68D516375
:CREATED:  [2021-09-13 Mon 07:29]
:END:

********* SummarizedExperiment input
:PROPERTIES:
:ID:       F4CCA76E-3FBE-4E20-B6DE-69FB848D7123
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- DESeqDataSet
  - is an extension of the RangedSummarizedExperiment class
  - requires design formula
    - ~ followed by variables w/ plus sign between
    - put variable of interest at end of formula
- Preferred count algorithm is summarizedOverlaps w/ mode="Union"

********* Pre-filtering
:PROPERTIES:
:ID:       1D88E488-4AFA-4A0F-A994-3C1664B5D156
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- by DESeq2
  - on mean of normalized counts per gene- maximized genes w/ adjusted p value below a FDR of alpha
- (by user)
  - increases processing speed and reduces memory
  - b/ not necessary for DESeq2 function

******** Exploring and exporting results
:PROPERTIES:
:ID:       B87063F9-4578-440B-BF94-9DF134AF438A
:CREATED:  [2021-09-13 Mon 07:29]
:END:

********* MA-plot
:PROPERTIES:
:ID:       BBEB1ADB-F328-4B7B-807D-F8C158D60083
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- useful to look at how the DESeq2 function shrinkage performed
- after calling plotMA, the identify function can interactively select dots
- for unshrunken results, add addMLE=T to get a column called lfcMLE

********* Plot counts
:PROPERTIES:
:ID:       CB3647FE-90B2-47AD-8E89-AA206A6C207F
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- plotCounts will give counts normalized by sequencing depth for a specific gene

********* p values set to NA
:PROPERTIES:
:ID:       F28D686F-0E61-42C9-81DB-6BD581223377
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- all samples w/ zero counts
- rows w/ extreme count outlier by Cook's distance
- low mean normalized count (here only the p value will be NA)

********* Rich visualization and reporting of results- checkout Bioconductor packages [[http://bioconductor.org/packages/release/bioc/html/ReportingTools.html][ReportingTools]], regionReport, [[http://bioconductor.org/packages/release/bioc/html/Glimma.html][Glimma]], and pcaExplorer
:PROPERTIES:
:ID:       8CE69F91-1AFB-477A-996A-95212336AD6D
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******* Data transformations and visualization
:PROPERTIES:
:ID:       99C0CCAA-43A0-4E37-8C72-98617C51D928
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Count data transformations
:PROPERTIES:
:ID:       3E7192A1-175C-4D3A-A5E7-08D6CC64DCEC
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- transformations for EDA
  - pseudocounts: y=log2(N+No)
  - log2-based alternatives
    - find experiment-wide trend in variabnce/mean and remove dependnece of variance on mean
    - rlog
    - VST (variance stabilizing transformations)

********* Blind dispersion estimation
:PROPERTIES:
:ID:       BFA60D58-A2E6-49F4-9912-2CF15D0BD356
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- blind to sample information is default
- change if many/most genes will have large differences- can be checked with MA over-shrinking

******* Variations to the standard workflow
:PROPERTIES:
:ID:       7A2DB9FE-8DE5-481A-9C1A-4F26DC867582
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Contrasts
:PROPERTIES:
:ID:       A6AC8C5D-8828-4B96-BDB4-760B1F0DE0BA
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- Contrast
  - i.e. w/ levels A,B,C, test all possible differences of A vs B, A vs C, B vs C, ...
  - linear combination of estimated log2 fold changes

******** Interactions- tests whether log2 fold change attributable to one condition is different based on another condition
:PROPERTIES:
:ID:       E2EE7973-FFB1-4842-83E8-665DCCA8F2C9
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Likelihood ratio test
:PROPERTIES:
:ID:       F15FCEE5-B88F-4712-B3B1-03C576F8E44F
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- Wald test asks if log2 fold change b/w groups is zero based on mean and SE
- LR
  - asks whether full model (w/ groups) and reduced model (w/ some terms removed) are different
  - like a ANOVA except this is analysis of deviance

******** Approach to count outliers
:PROPERTIES:
:ID:       682697F8-D316-4A04-9B6D-8BCB0261DE15
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- Cook's distance- for how much single sample is influencing fitting coefficients
  - automatic in results function
  - requires at least 3 replicates
  - @ >6 samples, instead of eliminating gene, the outlier is replaced w/ the trimmed mean over all samples
  - not run when continuous variables are in the design

******** Independent filtering of results
:PROPERTIES:
:ID:       0778E394-2A3A-4952-9126-668AC8162D3A
:CREATED:  [2021-09-13 Mon 07:29]
:END:

results function maximizes p values less than * over quantiles of mean normalized counts

******** Tests of log2 fold change above or below a threshold
:PROPERTIES:
:ID:       70E0F04B-9D6B-4C11-A34E-6EE2FB008185
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Access to all calculated values
:PROPERTIES:
:ID:       60580A3B-7A73-45A0-984F-0E83E5B6F2EC
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Sample-/gene-dependent normalization factors
:PROPERTIES:
:ID:       BB95C4F2-763B-447D-A840-372588D43C79
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** “Model matrix not full rank”
:PROPERTIES:
:ID:       7F14D356-858D-46DD-9044-C1A6CD2F8A08
:CREATED:  [2021-09-13 Mon 07:29]
:END:

********* Linear combinations
:PROPERTIES:
:ID:       D9625DD4-D506-4E43-836D-9E0CDDCB9A79
:CREATED:  [2021-09-13 Mon 07:29]
:END:

********* Levels without samples
:PROPERTIES:
:ID:       E65BA44B-FBA9-4A05-93B0-1246608C3754
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******* Theory behind DESeq2
:PROPERTIES:
:ID:       C0765E52-718B-4771-9ECC-3689EE7CAA21
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** The DESeq2 model
:PROPERTIES:
:ID:       08949A97-2A7C-4D21-A9EB-811440E003A8
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Changes compared to the DESeq package
:PROPERTIES:
:ID:       41E50955-4ADF-4560-ACD0-86F58F544033
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Methods changes since the 2014 DESeq2 paper
:PROPERTIES:
:ID:       1D28C489-FF28-4112-B9B9-70C09D382608
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Count outlier detection
:PROPERTIES:
:ID:       14989EE3-4903-4FCB-A270-E3BAFFCD6EFA
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Contrasts
:PROPERTIES:
:ID:       45C7C99A-DC18-4293-9381-878DE892D84A
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Expanded model matrices
:PROPERTIES:
:ID:       FBAAB9AE-7D25-43A5-9363-766F84F32198
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Independent filtering and multiple testing
:PROPERTIES:
:ID:       EB54BD27-FD99-45DD-B671-8BBEB06857FE
:CREATED:  [2021-09-13 Mon 07:29]
:END:

********* Filtering criteria
:PROPERTIES:
:ID:       4705CA0F-C007-4503-A898-74E946304812
:CREATED:  [2021-09-13 Mon 07:29]
:END:

********* Why does it work?
:PROPERTIES:
:ID:       BA1FC087-AAF6-4116-9B86-0B0B4BBC5FDB
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******* Frequently asked questions
:PROPERTIES:
:ID:       7A2CF9E1-0C06-45FF-9637-C085CC6F15A0
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** How can I get support for DESeq2?
:PROPERTIES:
:ID:       B5ADEA5D-15C6-4449-B15F-908E63118B76
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Why are some pvalues set to NA?
:PROPERTIES:
:ID:       3D889B88-07E4-4D2C-91F1-58CCF54C9C2C
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** How can I get unfiltered DESeq results?
:PROPERTIES:
:ID:       A4107221-A74A-4E79-AC6E-057F5CAB86DF
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** How do I use the variance stabilized or rlog transformed data for differential testing?
:PROPERTIES:
:ID:       F6C4F4CE-03E9-46FC-8F9A-EF915DF7FEF2
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Can I use DESeq2 to analyze paired samples?
:PROPERTIES:
:ID:       DA9671DE-23CE-4603-9077-0F8576CEECBF
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** If I have multiple groups, should I run all together or split into pairs of groups?
:PROPERTIES:
:ID:       5384671F-9FF2-4589-80E4-7B6E7AA681FF
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Can I run DESeq2 to contrast the levels of 100 groups?
:PROPERTIES:
:ID:       355A5DC0-1A35-4315-8DEB-4C2275EA9A7C
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Can I use DESeq2 to analyze a dataset without replicates?
:PROPERTIES:
:ID:       4AF6174D-0E98-4139-89B6-2E2AB1B13BA4
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** How can I include a continuous covariate in the design formula?
:PROPERTIES:
:ID:       BBFFFE10-B8CF-4E66-9BA9-B78B0DA2FAF9
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Will the log fold change shrinkage “overshrink” large differences?
:PROPERTIES:
:ID:       01210C6E-221E-403D-AE9C-63946B83F9A4
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** I ran a likelihood ratio test, but results() only gives me one comparison
:PROPERTIES:
:ID:       76AC2A68-59B8-4E92-B384-822B8CE0DD7B
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** What are the exact steps performed by DESeq()?
:PROPERTIES:
:ID:       74C55B19-7DAA-4357-8F15-179AF2645CFF
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Is there an official Galaxy tool for DESeq2
:PROPERTIES:
:ID:       5A4CB62B-A91F-467F-AA52-B8D1C66D9D28
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** I want to benchmark DESeq2 comparing to other DE tools.
:PROPERTIES:
:ID:       9B564504-8E91-4921-87D8-3AE89F5F6E2F
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******* SessionInfo
:PROPERTIES:
:ID:       626CE66C-E3D7-4D09-BEDC-27812DB3689B
:CREATED:  [2021-09-13 Mon 07:29]
:END:

[[file:~/Box%20Sync/comp_bio/Love,14%20Beginners%20guide%20to%20using%20the%20DESeq2%20package.pdf][Love,14 Beginners guide to using the DESeq2 package]]
[[file:~/Box%20Sync/comp_bio/Love,15%20DESeq2%20User%20Guide.pdf][User Guide]]
[[https://support.bioconductor.org/local/search/page/?q=deseq2][Bioconductor Support]]
[[file:~/Box%20Sync/library/Love,16%20DESeq2%20manual.pdf][Manual]]
A negative binomial GLM
[[https://www.youtube.com/results?search_query=deseq2&page=&utm_source=opensearch][Youtube]]
[[file:~/Box%20Sync/library/Love,14%20Moderated%20estimation%20of%20fold%20change%20and%20dispersion%20for%20RNA%20seq%20data%20with%20DESeq2.pdf][Love,14 Moderated estimation of fold change and dispersion for RNA seq data with DESeq2]]
[[ftp://ftp.jax.org/dgatti/ShortCourse2015/tutorials/Differential-Expression.html][Workflow example]]
[[http://www.sthda.com/english/wiki/rna-seq-differential-expression-work-flow-using-deseq2][Another workflow example]]
[[https://dwheelerau.com/2014/02/17/how-to-use-deseq2-to-analyse-rnaseq-data/][And another workflow example]]


**** DRIMSeq                                                        :biotool:
:PROPERTIES:
:CREATED:  [2021-09-13 Mon 07:29]
:ID:       7cbebba6-1707-41ea-aad4-ca697b99b03a
:END:
https://bioconductor.org/packages/release/bioc/vignettes/DRIMSeq/inst/doc/DRIMSeq.pdf
**** edgeR                                                          :biotool:
:PROPERTIES:
:ID:       32BB77F2-0283-4A52-86AC-CDF2CB6A7315
:CREATED:  [2021-09-13 Mon 07:29]
:END:
| edgeR | diff express |   |   | [[https://www.bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeRUsersGuide.pdf][vignette]] |   | cite:robinson2010 |
https://academic.oup.com/nar/article/40/10/4288/2411520?login=true
- GLM asking whether exons are used proportionally across experiment conditions
- DEXSeq is an extension to exons
- [[file:~/Box%20Sync/comp_bio/RNA-seq/Rueda,15%20Differential%20expression%20analysis%20using%20edgeR.pdf][Rueda,15 Differential expression analysis using edgeR]]
- [[file:~/Box%20Sync/comp_bio/RNA-seq/edgeRUsersGuide.pdf][User Guide]]
- [[file:~/Box%20Sync/comp_bio/RNA-seq/edgeR_manual.pdf][Manual]]
- cite:robinson2010
- [[file:~/Box%20Sync/library/Robinson,09%20edgeR%20a%20Bioconductor%20package%20for%20differential%20expression%20analysis%20of%20digitial%20gene%20expression%20data.pdf][Robinson,09 edgeR a Bioconductor package for differential expression analysis of digitial gene expression data]]


**** epicseq                                                       :biotools:
:PROPERTIES:
:ID:       5fd68583-174f-49b0-82b5-67e1a2f23498
:END:
https://mail.google.com/mail/u/0/#inbox/FMfcgzGpFgtGDXpvjWgzHdQjhXHVlSvf
**** exceRpt                                                        :biotool:
:PROPERTIES:
:ID:       1db0ffb6-25b7-4c97-9aa0-263b8c96373b
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- [[https://www.scopus.com/results/citedbyresults.uri?sort=cp-f&cite=2-s2.0-85063257542&src=s&nlo=&nlr=&nls=&imp=t&sid=f566de7056a65b814af39a1c988abbfb&sot=cite&sdt=a&sl=0&origin=resultslist&offset=21&txGid=1f850b1319595ca2e1efdc578c6f60bb&isValidNewDocSearchRedirection=false][scopus citing exceRpt]]
- cite:rozowsky2019
- http://github.gersteinlab.org/exceRpt/
- used in
  - cite:godoy2019
  - cite:giraldez2018
**** faSplit
:PROPERTIES:
:ID:       05969880-e00b-4c38-9ae8-77dddf2ef628
:END:
https://www.biostars.org/p/13270/
**** fastp
:PROPERTIES:
:ID:       ab74a5ca-9cdf-48b6-8050-e48dc1d7eef3
:END:
| fastp | [[id:1EE731A3-83DD-46AF-B988-2311307C335F][seq qc]] | fastq | [[https://github.com/OpenGene/fastp][repo]] |   | [[https://watermark.silverchair.com/bty560.pdf?token=AQECAHi208BE49Ooan9kkhW_Ercy7Dm3ZL_9Cf3qfKAc485ysgAAAuEwggLdBgkqhkiG9w0BBwagggLOMIICygIBADCCAsMGCSqGSIb3DQEHATAeBglghkgBZQMEAS4wEQQMUQnq5IYxgkrFnt0WAgEQgIIClChzxtpO28QYuBn1woUVAMnQOwkPRZWSY20cwnzbVuF3DlOcpwjeNjNrO_ixNp6csW5pOdBZ81CHjV65BMcqsZmP9KOT-yVGy4r_7mWKLuzm7Siid24pM9-xF3k7y1RoBK4-PrnZgzp-J1svrUvOZAphbBPmsezuOowSuj9o9EZyTciDJbUQ2klUbYSRDO_InWNOVu23eOzGpJQwer81BL2iS8TsCfeWF-eZtzNBRuZZr1UZ2PhX_mVQGu4bHvKn1Bmoe64CFYkEJGLoka87zVVfo--J_hAledjiW1_-wEj8kZSyb2diZoP9ABDGOJA6aQ7fzx8qNGgNAb_oK-uAmEdfAfepI_0LECDdlk9EIxIJITC-Z59gk_vNVophJOydBimGZHFK0iACl-N-nZNALjIqRXeRmqOxcEdRFmNy6onzLalfCV0wyqFae42JIVzEYFSLW1oQVC0ugMfKTTmOfysRZ8-4bboBo1UbskpGVlKvrSBTFuDyvuBlPoUTECbOrO6bsdeNk8yfTMTeMQzNzOzZYZ1mQVCULZtuE_YDCuKmwukT3EeUy8iOJbp7pD2Ew5kphJ9q0sV-_io3h0jBZEdJmUr6dTPSRcv56pLP6gtqso6ZdB9bWk3sFNt--tBwIGhQvnLXgyV7xGqRYNPrDeMbs2tPLlK-v4D8XKj-BHGi1sOVuzL1rCvFve0knpL4btsqw_BDp8P2XuFDyp0OOXtmE3dKJktLR0QyQZ3u4-aKksDMfkqrglbPoBjEhInpdpfiDQbEDTFO9qiaL9iajdsV8T636x_KHXpdGkFqO3GpcFyJv1QJyPW2qhAXuneiqWx6t60pJ8f0IyAzRV9BIUoQ4B3soV9TXIuSP171Tf0JYmcY5Q][paper]] | cite:chen2018b |

**** fastqc                                                         :biotool:
:PROPERTIES:
:CREATED:  [2021-09-13 Mon 07:29]
:ID:       96281891-d1df-46ec-8e55-f82a0ef225cf
:END:
| [[id:0a319950-3215-4846-a020-a08b78f3323d][FastQC]] | [[id:1EE731A3-83DD-46AF-B988-2311307C335F][seq qc]] |   |   | [[https://www.bioinformatics.babraham.ac.uk/projects/fastqc/INSTALL.txt][site]] |   |   |
- [[https://www.youtube.com/watch?v=bz93ReOv87Y][Intro video]]
- Only non-truncated fastqs can be processed by fastqc.
- Interpretation
  - Per sequence GC content- spikes mean contaminants
  - will only track first 200000
  - base quality
    - Phred vs. read position (goal is >20 or 1 error in 100 bases)
    - Phred histogram- look for single population or filter second population
    - Base position vs. frequency of nucleotide
  - per nucleotide
    - [[http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/5%20Per%20Sequence%20GC%20Content.html][Per sequence GC content]]
    - Secondary peak = contamination- see overrepresent sequences
  - [[http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/8%20Duplicate%20Sequences.html][Duplicate sequences]]
    - Broad oversequencing -> high flat line
    - Specific enrichments - spikes
      - Possible reasons
        - Technical (PCR) duplication
        - Biological duplication- common in RNA-seq where you are re-sequencing the common sequences
    - Warning at 20%, failure @ 50%
  - [[http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/11%20Kmer%20Content.html][Kmer content]]
    - for partial sequences in a variety of longer sequences
  - https://sequencing.qcfail.com/software/fastqc/
  - https://rtsf.natsci.msu.edu/genomics/tech-notes/fastqc-tutorial-and-faq/#:~:text=The%20output%20from%20FastQC%2C%20after,or%20%E2%80%9CFail%E2%80%9D%20is%20assigned.
- cite:williams2014 for a FastQC aggregator Perl script
- [[https://www.biostars.org/p/56088/#56102][Fastq Quality Read And Score Length Check]]
-
**** fastx
:PROPERTIES:
:ID:       3ee8331b-097a-4bfe-a33a-583aa876564a
:END:
| [[http://hannonlab.cshl.edu/fastx_toolkit/commandline.html][FASTX-Toolkit]] |   |   |   |   |   |   |
**** featureCounts
:PROPERTIES:
:ID:       50748304-a99d-422e-ab07-9da187b65721
:END:
| featureCounts |   |   |   |   | [[https://watermark.silverchair.com/btt656.pdf?token=AQECAHi208BE49Ooan9kkhW_Ercy7Dm3ZL_9Cf3qfKAc485ysgAAApgwggKUBgkqhkiG9w0BBwagggKFMIICgQIBADCCAnoGCSqGSIb3DQEHATAeBglghkgBZQMEAS4wEQQMofurkoV2NWsQqlelAgEQgIICS7iktDnfv1X3fe1vdQQcXCS09zT549UGvBjDCLHoNebBGfiQi_Eo7ZjUHVH_Yay_p1DlFd4eDeXU4WEX6HTQ-MzPqmtZ6RMGegyEptsqxaLnvr3QfpGO6WRT01dViqp6xya9-CqCRGV3E7F37VruIYzZEFjr-2svIgoRydPyF4pkSzA2hkvwV_g-JT2YSnqboZ5DOGtwZXeMaLKf48_aEpuYemRUx8VqOfM8xnOm4_jumLGd_BBqCCv6brLX8z3WVJpWfJ4YfpJXhemFRt8mSvIsAe9pYXV52W7-psxHlM2ocXzdD_7vLSD7iy1NocDXWLFT5HRH_Cq8NyiRq1s4Mq-QYuvQJFlTxWArVC6vdpE40bDr9slGD6KTJ0DpUQeC52q-aoKJXr9Y7Pi2SDo881eFuJxTWuSuMjxcXStn9MkPKZfcKa10Vu4CdJSSnvJAKAvd4GsshsfCVGCvkgy4ZfEabo5nOZaB82UYC-8AZEpdbD3RtJg1FUQJHDz0tlY-2gZYf2VB3KU1JK4wZcHzn8T8R5BSChB6MjFrRdTZeo3M8-ZIK3eWQGH2vLj8_bPsYlBF-wfj2JzSG3zJGgUUa_rSBzoK8Vvw8k_BPxCq63h6u-k49l-X0o-MO6f8mOdm_YliTT0dWu_ujvlbXMw9AIBrKjwBJncq27EwMOX0shm8nnzPMoPTfOzoekZR2nYTDPayGjHhqkAs6haFAQrI8XAAd0PfbMtW4l54ArULWEH6hCVxzDX8_h8F8oWgOc_3h2ktpbTLNsiX6Bxj][paper]] |   |
**** fgsea                                                          :biotool:
:PROPERTIES:
:ID:       09af17f3-c5d4-4f03-8082-2e159cb7c92b
:END:
- https://www.reddit.com/r/bioinformatics/comments/1703dz0/gsea_are_authors_just_cherry_picking_enriched/
- https://www.sciencedirect.com/science/article/pii/S1874939919302287?via%3Dihub#s0110
- scoreType
  - https://github.com/ctlab/fgsea/issues/87
- ranking metric
  - https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1674-0#Sec8
- time course data
  - https://bioconductor.org/packages/release/bioc/vignettes/fgsea/inst/doc/geseca-tutorial.html#analysis-of-time-course-data
- documentation
  - tutorial https://bioconductor.org/packages/release/bioc/vignettes/fgsea/inst/doc/fgsea-tutorial.html
- Gene set enrichment analysis :: coexpression method that determines enrichment of gene sets by the set's genes ranked differential expression positions
- Historical development
  - Developed in cite:mootha2003
  - Proposed in cite:subramanian2005
- Outputs
  - ES (enrichment score)- maximum deviantion from zero in random walk of running sums of genes in a list. Corresponds to Kolmogorov-Smirnov
  - p-value of ES- versus null of permutated gene labels
  - Leading edge analysis :: "A subset of genes found in the ranking at or just before the maximal ES in a GSEA analysis. This subset of genes often accounts for a pathway being defined as enriched." cite:reimand2019
- Used in
  - [[id:91d46e60-eec3-48c7-97f1-b53eb1559b3f][Used in Co-expression / pathway enrichment process]]
  - Used in [[id:8e4c1fb8-cd52-4fac-900a-4b6e6eb5a28a][clusterProfiler]]
- fgsea
  - https://bioconductor.org/packages/devel/bioc/vignettes/fgsea/inst/doc/fgsea-tutorial.html
- Ranking metric
  - -log10(p-value)
    - https://bioinformatics.stackexchange.com/questions/13443/ranking-metric-in-gsea
  - sign(logFC) * -log10(pval)
    - https://support.bioconductor.org/p/85681/
- [[https://www.gsea-msigdb.org/gsea/doc/GSEAUserGuideTEXT.htm#_Consistent_Feature_Identifiers_Acro][documentation]]
  - [[http://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/FAQ#Why_does_GSEA_use_a_false_discovery_rate_.28FDR.29_of_0.25_rather_than_the_more_classic_0.05.3F][FDR discussion]]
  - FAQ
    - [[http://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/FAQ#What_array_platforms_and_organism_species_does_GSEA_support.3F][using for mouse data]]
  - [[http://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Using_RNA-seq_Datasets_with_GSEA][RNA-seq data]]
    - with RNA-seq, use TMM
  - [[http://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats][file formats]]
    - GMT: gene matrix transposed file (*.gmt)
    - chip files ftp://ftp.broadinstitute.org/pub/gsea/annotations (use ENSEMBL)
  - [[https://www.gsea-msigdb.org/gsea/msigdb/search.jsp][gene sets]]
- [[id:f7eed3be-f505-451c-b191-1a58373fb180][Co-expression gene set databases]]
  - [[id:c79bfe84-0f15-474e-8a22-1f210605ed5a][MSigDB]]
- file creation and formatting
  - see to create .rnk file https://github.com/BaderLab/EM-tutorials-docker/blob/master/R_scripts/supplemental_protocol2_rnaseq.R
- [[http://software.broadinstitute.org/cancer/software/genepattern/modules/docs/ssGSEAProjection/4][ssGSEA]] calculates enrichment for each sample-gene set pair
- https://academic.oup.com/bib/article/17/3/393/1744776

**** flexbar                                                        :biotool:
:PROPERTIES:
:doc: https://github.com/seqan/flexbar/wiki/Manual
:ID:       5c20daf7-d02e-4447-bd1e-f991e1366c48
:END:
| flexbar |   |   |   | [[https://github.com/seqan/flexbar/wiki/Manual][doc]] |   | cite:roehr2017 |

- [[https://github.com/seqan/flexbar/wiki/Manual][Documentation]]
- https://www.google.com/search?q=flexbar+sequencing+manual
**** gage                                                           :biotool:
:PROPERTIES:
:ID:       9b222d1c-ab61-450c-8b77-a98ec3213867
:CREATED:  [2021-09-13 Mon 07:29]
:END:
#+begin_src R
#########1#########2#########3#########4#########5#########6#########7#########8
#
library(gage)
library(gageData)

data(kegg.sets.rn)
data(go.sets.rn)
data(sigmet.idx.rn)
data(go.subs.rn)

# Subset gene set data to biological processes (BP) and molecular functions, without disease states
kg_rat = kegg.sets.rn[sigmet.idx.rn]
go_rat = do.call(c, list(go.sets.rn[go.subs.rn$MF],go.sets.rn[go.subs.rn$BP]))

rat = useMart("ensembl", dataset = "rnorvegicus_gene_ensembl")
rat_entrez =
  getBM(attributes = c("ensembl_gene_id", "entrezgene_id"),
        values = rownames(res_BN3_IW_sham),
        mart = rat)

#########1#########2#########3#########4#########5#########6#########7#########8
#
# Functions
##
##
make_gage_object = function(deseq_res, biomat){
  df = as.data.frame(deseq_res) %>%
    rownames_to_column(var = "ensembl_gene_id") %>%
    left_join(biomat, by = "ensembl_gene_id") %>%
    filter(!is.na(entrezgene_id))
  df2 = df %>% pull(log2FoldChange)
  names(df2) = df$entrezgene_id
  return(df2)
  }

run_gage = function(gage_object){
  go = gage(gage_object,
            gsets = go_rat,
            ref = NULL,
            sample = NULL,
            same.dir = TRUE,
            rank.test = TRUE)
  go_up = as.data.frame(go$greater)
  go_down = as.data.frame(go$less)
  #
  kegg = gage(gage_object,
              gsets = kg_rat,
              ref = NULL,
              sample = NULL,
              same.dir = FALSE,
              rank.test = TRUE)
  kegg = as.data.frame(kegg$greater)
  #
  gage_all = list(go_up, go_down, kegg)
  return(gage_all)
}

#
deseq_res_ch3_enrich_list = list(res_BN3_tx_sham, res_SS_tx_sham, res_BN3_SS_sham, res_BN3_SS_tx)
gage_objects = lapply(deseq_res_ch3_enrich_list, make_gage_object, biomat = rat_entrez)
gage_results = lapply(gage_objects, run_gage)
names(gage_results) = c("gage_BN3_tx_sham", "gage_SS_tx_sham", "gage_BN3_SS_sham", "gage_BN3_SS_tx")

save(gage_results,
     file = "./data/gage_results.RData")
#+end_src
| GAGE | enrichment | express |   |   | [[https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-10-161][paper]] |   |
- https://bioconductor.org/packages/release/bioc/vignettes/gage/inst/doc/RNA-seqWorkflow.pdf
- https://genviz.org/module-04-expression/0004/03/01/pathwayAnalysis/
- https://www.bioconductor.org/packages/devel/data/experiment/manuals/gageData/man/gageData.pdf
- https://bioconductor.org/packages/release/bioc/vignettes/gage/inst/doc/RNA-seqWorkflow.pdf
- cite:luo2009
**** GATK
:PROPERTIES:
:ID:       479aaa09-f483-4a0d-b593-0cd157954668
:END:
         |   |   |   | [[https://software.broadinstitute.org/gatk/documentation/][doc]] |   |   |
**** Genomic Alignments
:PROPERTIES:
:ID:       608b8cb2-4c77-4a9b-bc6a-24470bb572b0
:END:
- see [[id:78b22803-f843-41f2-9390-d621caae82c0][Genomic Ranges]]
- summarizeOverlaps https://bioconductor.org/packages/release/bioc/vignettes/GenomicAlignments/inst/doc/summarizeOverlaps.pdf
**** Genomic Ranges                                                 :biotool:
:PROPERTIES:
:CREATED:  [2021-09-13 Mon 07:29]
:ID:       78b22803-f843-41f2-9390-d621caae82c0
:END:
- https://bioconductor.github.io/BiocWorkshops/solving-common-bioinformatic-challenges-using-genomicranges.html
- https://rstudio-pubs-static.s3.amazonaws.com/142838_0374b144401c449eb17ed5c2c70cb513.html#grangeslist-multiple-interval-range-features
- see [[id:608b8cb2-4c77-4a9b-bc6a-24470bb572b0][Genomic Alignments]]
- https://seandavi.github.io/ITR/RangesAndSignal.html
- https://rdrr.io/bioc/GenomicRanges/
- https://kasperdanielhansen.github.io/genbioconductor/html/GenomicRanges_Lists.html
- https://bioconductor.riken.jp/packages/3.8/bioc/vignettes/GenomicRanges/inst/doc/GenomicRangesIntroduction.html
- https://www.google.com/search?q=convert+bed+to+granges
- Granges manipulations https://rockefelleruniversity.github.io/Bioconductor_Introduction/exercises/answers/GenomicFeatures_answers.html

**** giggle
:PROPERTIES:
:ID:       a4e2adcd-f921-4aef-a808-866147b6db8a
:END:
- https://github.com/ryanlayer/giggle
- https://www.nature.com/articles/nmeth.4556
-
**** gistic2                                                        :biotool:
:PROPERTIES:
:doc:  [[http://portals.broadinstitute.org/cgi-bin/cancer/publications/pub_paper.cgi?mode=view&paper_id=216&p=t][site]]
:ID:       4f0b84ab-1dec-45c9-a7d4-bdce41e13150
:CREATED:  [2021-09-13 Mon 07:29]
:END:
https://www.genepattern.org/file-formats-guide

segmentation file column 6 is log2(x)-1 of the copy number, so
| interp  | copy number |   log2(x)-1 |
|---------+-------------+-------------|
| neutral |           2 |           0 |
| gain    |           3 |        0.58 |
| amp     |           4 |           1 |
| loss    |           1 |          -1 |
| del     |           0 | - inf -> NA |
|         |             |             |

- https://docs.cbioportal.org/5.1-data-loading/data-loading/file-formats#gistic-2-0-data
- https://blindwith.science/2018/10/442.html/
- http://crazyhottommy.blogspot.com/2017/11/run-gistic2-with-sequenza-segmentation.html
**** GSEA                                                           :biotool:
:PROPERTIES:
:ID:       D68E1182-1F7B-4160-A6DD-BD2635F8085F
:CREATED:  [2021-09-13 Mon 07:29]
:END:
-
- see [[*fgsea][fgsea]]
**** Gviz
:PROPERTIES:
:ID:       49edb4b2-4f08-44b6-af11-0a20b777e216
:END:
https://rdrr.io/bioc/Gviz/man/DataTrack-class.html
https://bioconductor.org/packages/release/bioc/vignettes/Gviz/inst/doc/Gviz.html#7_Composite_plots_for_multiple_chromosomes
**** histat2
:PROPERTIES:
:doc: |         |              | fastq   |      | [[https://ccb.jhu.edu/software/hisat2/manual.html][doc]]      |       |                        |
:ID:       6ac43372-1e8d-47bb-b916-ad708f482f9b
:END:

**** homer                                                          :biotool:
:PROPERTIES:
:ID:       33a4b4a6-f22f-4e12-8c27-7170bb1e1a9e
:END:
- Reference
  - [[https://www.biostars.org/tag/homer/?order=views][homer on Biostars]]
- Processes
  - Motifs in genomic regions
    - http://homer.ucsd.edu/homer/ngs/peakMotifs.html
    - https://www.biostars.org/p/138407/
  - Results interpretation
    - http://homer.ucsd.edu/homer/motif/index.html
  - Gene-based promoter motif enrichment
    - http://homer.ucsd.edu/homer/microarray/index.html
**** ichorcna                                                       :biotool:
:PROPERTIES:
:use: genome-wide copy number alteration detection
:substrate: bam
:repo: [[https://github.com/broadinstitute/ichorCNA][repo]]
:doc:  [[https://github.com/broadinstitute/ichorCNA/wiki][doc]]
:paper: | [[https://www.nature.com/articles/s41467-017-00965-y][paper]] | cite:adalsteinsson2017 |
:ID:       8c535c38-9310-4fd0-a8fe-c300639493da
:CREATED:  [2021-09-13 Mon 07:29]
:END:
"Briefly, the genome was divided into T non-overlapping windows, or bins, of 1 Mb. Aligned reads were counted based on overlap within each bin using the tools in HMMcopy Suite (http://compbio.bccrc.ca/software/hmmcopy/). The read counts were then normalized to correct for GC content and mappability biases, and then CNAs and tumor fraction were estimated using HMMcopy R package18. "


- https://github.com/gavinha/TitanCNA/issues/86
  - [X] does hmmcopy need blacklist? - no mappability score part of hmmcopy The mappability file, which was generated using ENCODE Duke Uniqueness of 35bp sequences track from UCSC (http://genome.ucsc.edu/cgi-bin/hgTrackUi?db=hg18&g=wgEncodeMapability), provides scores indicating how mappable the reference sequence at each bin is to aligners; the higher the score, the more mappable the sequence.

- https://www.google.com/search?q=viterbi+algorithm&oq=Viterbi+algorithm&aqs=chrome.0.0l8.356j0j7&client=ubuntu&sourceid=chrome&ie=UTF-8

https://www.google.com/search?q=ichorcna&sxsrf=ALeKk02zeu_rSdEZVMYYCyip37Gt2XFzEg:1617895629440&source=lnms&tbm=vid&sa=X&ved=2ahUKEwjZx5ry-u7vAhVJbs0KHXyIAGkQ_AUoAnoECAEQBA&biw=1596&bih=789
- cite:guo2018
- cite:klega2018
- cite:manier2018
- cite:mouliere2018
- cite:stover2018
- cite:adalsteinsson2017
- [[https://github.com/broadinstitute/ichorCNA/wiki][documentation]]
  - https://github.com/broadinstitute/ichorCNA/wiki/Parameter-tuning-and-settings
- [[https://mail.google.com/mail/u/0/#inbox/FMfcgxwGDDjrSfkvnNDnxMlVJNFgfnfk][email from:Sundby re:ichor method]]
- https://www.biostars.org/local/search/page/?q=ichorcna
- for install see [[file:/ssh:chaudhuri-roche:/home/jszymanski/repos/biotools/Dockerfile][biotools Dockerfile]]
**** INTEGRATE                                                      :biotool:
:PROPERTIES:
:use: detect rna fusions
:substrate: bam
:paper:  cite:zhang2014a        |
:ID:       7519d47f-18e8-4a28-be11-9d081b68b52d
:CREATED:  [2021-09-13 Mon 07:29]
:END:
  - cite:zhang2016
    - [[http://apps.webofknowledge.com/summary.do?product=WOS&parentProduct=WOS&search_mode=CitingArticles&qid=2&SID=6ERcSCYD7iSBCZMtAM7&&page=1&action=changePageSize&pageSize=50][WOS citing]]- no cfRNA yet
  - integrate
    - cite:zhang2017c
    - cite:zhang2016
    - cite:zhang2016a
    - cite:zhang2016a
    - - cite:zhang2014a
    - https://github.com/ChrisMaherLab/INTEGRATE-Vis/blob/master/README.md
    for integrate, see - cite:li2020
**** liftover                                                       :biotool:
:PROPERTIES:
:ID:       1b64ef53-604b-4991-8365-5206d2052d24
:END:
https://genome.ucsc.edu/cgi-bin/hgLiftOver
**** limma                                                          :biotool:
:PROPERTIES:
:ID:       3283b8b2-fc42-4a71-a8e9-7dbdd7ab62ce
:CREATED:  [2021-09-13 Mon 07:29]
:use: differential expression
:paper:  | count   |      |          | [[https://dx.doi.org/10.1093%2Fnar%2Fgkv007][paper]] |                        |
:END:
- https://www.coursera.org/lecture/bioconductor/limma-aoNwW
- [[file:~/Box%20Sync/comp_bio/RNA-seq/Ritchie,15%20limma%20powers%20differential%20expression%20analysis%20for%20RNA%20sequencing%20and%20microarray%20results.pdf][Ritchie,15 limma powers differential expression analysis for RNA sequencing and microarray results]]
- raw counts transformed to continuous values w/ confidence weight
- [[file:~/Box%20Sync/comp_bio/RNA-seq/limma%20Manual.pdf][manual]]
- Math, concept- [[file:~/Box%20Sync/comp_bio/RNA-seq/Law,14%20voom%20precision%20weights%20unlock%20linear%20model%20analysis%20tools%20for%20RNA%20seq.pdf][Law,14 voom precision weights unlock linear model analysis tools for RNA seq]]
- voom transformation- from counts to log-counts per million w/ associated weight (just think of it as if microarray data)
***** [[file:~/Box%20Sync/comp_bio/RNA-seq/limma%20User%20Guide.pdf][User Guide]]
:PROPERTIES:
:ID:       15C1AE68-19D2-4FBD-B51E-DA37C605F0D7
:CREATED:  [2021-09-13 Mon 07:29]
:END:

- concepts
  - borrows information across genes for emperical Bayes
  - read counts -> continuous expression data like microarray
  - required matrices for linear models approach
    - design- which RNA to which sample (i.e. specify groups)
    - contrast- which group comparions to make

***** [[file:~/Box%20Sync/comp_bio/limma_voom_template/][Examples and Template]]
:PROPERTIES:
:ID:       D1B28C0A-9AAD-4245-BE85-61300CE4A02B
:CREATED:  [2021-09-13 Mon 07:29]
:END:

****** WEHI example ([[file:~/Box%20Sync/comp_bio/RNA-seq/wehi_limma_example/wehi_limma_example.Rproj][Rproject]], [[file:~/Box%20Sync/comp_bio/RNA-seq/wehi_limma_example/wehi_limma_example.R][Rscript]]), [[http://bioinf.wehi.edu.au/RNAseqCaseStudy/][link]]
:PROPERTIES:
:ID:       1E96E985-8BD2-4D8F-AC88-FB509B99F513
:CREATED:  [2021-09-13 Mon 07:29]
:END:
:LOGBOOK:
CLOCK: [2016-05-10 Tue 15:46]--[2016-05-10 Tue 16:05] =>  0:19
CLOCK: [2016-05-10 Tue 15:07]--[2016-05-10 Tue 15:20] =>  0:13
CLOCK: [2016-05-09 Mon 12:25]--[2016-05-09 Mon 13:13] =>  0:48
:END:

****** User Guide Chapter 18
:PROPERTIES:
:ID:       817998EF-31AD-4A22-BF91-ACF72A1C29E5
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******* 18.1 [[file:~/Box%20Sync/comp_bio/limma_voom_template/yoruba_hapmap/][Profiles of Yoruba HapMap]]
:PROPERTIES:
:ID:       1E8CAB25-19C2-4745-B157-FA46D84549CD
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** DONE Read
CLOSED: [2016-06-30 Thu 11:22]
:PROPERTIES:
:ID:       91CBDFB8-17EB-4F2D-B2A4-58F656C64332
:CREATED:  [2021-09-13 Mon 07:29]
:END:

******** Work through code
:PROPERTIES:
:ID:       374ef56d-7a1a-4c40-ade8-f4acafd37602
:END:

:PROPERTIES:
:ID:       05EC5C9D-CE60-4DD5-9F5D-6EED8C229478
:CREATED:  [2021-09-13 Mon 07:29]
:END:


Venn diagrams with limma]]

Another use of the voom plot-  what you are failing to do completely in the voom analysis is to remove the rows of your count matrix that are lowly expressed, because these hose the mean/variance estimation, which you can see/diagnose on the plot generated with you call to voom(..., plot=TRUE). In brief, you want to ensure that the red fit line doesn't "slope/hook back down" (I'm talking as if you are "reading" the graph from right to left here) due to the drop/discretization in the observed variance from the black dots on the left side of the plot.

[[https://www.biostars.org/p/131488/][subsetting from topTable]]
**** MACS2                                                          :biotool:
:PROPERTIES:
:CREATED:  [2021-09-13 Mon 07:29]
:ID:       75ca7513-8f01-4819-a813-f9459f447483
:END:
- google
- macs2 shift - https://www.biostars.org/p/207318/
- https://github.com/macs3-project/MACS/blob/master/docs/callpeak.md
- https://hbctraining.github.io/Intro-to-ChIPseq/lessons/05_peak_calling_macs.html
- https://ucdavis-bioinformatics-training.github.io/2020-Epigenetics_Workshop/data_reduction/chip_atac/04-peaks

a _peaks.xls file looks like
# This file is generated by MACS version 2.2.6
# Command line: callpeak --treatment /mnt/ris/jschwarz/cardiac-radiobiology/bam/ct01_aut_blk_ddp_open.bam --format BAMPE --gsize mm --keep-dup all --outdir /mnt/ris/jschwarz/cardiac-radiobiology/macs2 --name ct01_aut_blk_ddp_open.bam --bdg --SPMR --extsize 150 --nomodel --call-summits --nolambda
# ARGUMENTS LIST:
# name = ct01_aut_blk_ddp_open.bam
# format = BAMPE
# ChIP-seq file = ['/mnt/ris/jschwarz/cardiac-radiobiology/bam/ct01_aut_blk_ddp_open.bam']
# control file = None
# effective genome size = 1.87e+09
# band width = 300
# model fold = [5
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length "d".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is on
# Searching for subpeak summits is on
# MACS will save fragment pileup signal per million reads

# fragment size is determined as 90 bps
# total fragments in treatment: 5942028
# d = 90
# local lambda is disabled!
chr start end length abs_summit pileup -log10(pvalue) fold_enrichment -log10(qvalue) name
chr1 3120443 3120560 118 3120499 6.00 7.58942 5.43209 5.03290 ct01_aut_blk_ddp_open.bam_peak_1
- https://www.google.com/search?q=macs2
- https://hbctraining.github.io/Intro-to-ChIPseq/lessons/05_peak_calling_macs.html
***** Published MACS2 commands for ATAC-seq
:PROPERTIES:
:ID:       496e62cd-3138-4120-a499-a10246ce77b5
:END:
- cite:corces2017 macs2 callpeak --nomodel --nolambda --keep-dup all --call-summits
- cite:corces2018 macs2 callpeak --shift -75--extsize 150 --nomodel --call-summits --nolambda --keep-dup all -p 0.01
- cite:hendrickson2017 macs2 callpeak --f BAMPE --B --SPMR
- cite:scott-browne2016 macs2 callpeak --nomodel -q 0.01 --keep-dup all --call-summits
**** msigdbr
:PROPERTIES:
:ID:       edf39ef6-df91-40c2-a71a-c612d60b5582
:END:
[[id:c79bfe84-0f15-474e-8a22-1f210605ed5a][MSigDB]]
https://cran.r-project.org/web/packages/msigdbr/vignettes/msigdbr-intro.html

**** multiqc                                                        :biotool:
:PROPERTIES:
:ID:       066d50fc-5407-4c80-a6ca-2534f37ae043
:CREATED:  [2021-09-13 Mon 07:29]
:use: sequencing QC
:repo: [[https://github.com/ewels/MultiQC][github]]
:doc: | [[https://multiqc.info/docs/][doc]]      |       |                        |
:END:
https://cran.r-project.org/web/packages/TidyMultiqc/index.html
**** NCBI Genome Workbench
:PROPERTIES:
:ID:       a63e62d9-38ee-4d5c-8010-cd47e237bd9b
:END:
https://www.ncbi.nlm.nih.gov/tools/gbench/
**** NCBI Genome Workbench
:PROPERTIES:
:ID:       b62c6657-7aa6-4535-b697-d92757f836d9
:END:
https://www.ncbi.nlm.nih.gov/tools/gbench/
**** NDEx                                                           :biotool:
:PROPERTIES:
:ID:       784895e5-0c94-4458-9cfb-f52759718ab3
:END:
- [[id:d84cf649-32f4-46e6-b041-4a8a76b31ffc][Pathway encoding]]
- https://www.ndexbio.org/#/
- https://www.ndexbio.org/iquery/
**** nextflow                                                       :biotool:
:PROPERTIES:
:CREATED:  [2019-12-27 Fri 14:48]
:ID:       6116d262-9ca8-430b-b385-65e1a7fc0a70
:END:
:LOGBOOK:
CLOCK: [2020-01-30 Thu 13:00]--[2020-01-30 Thu 14:04] =>  1:04
CLOCK: [2020-01-30 Thu 09:35]--[2020-01-30 Thu 12:45] =>  3:10
CLOCK: [2020-01-21 Tue 12:45]--[2020-01-21 Tue 14:30] =>  1:45
CLOCK: [2020-01-15 Wed 14:47]--[2020-01-15 Wed 15:39] =>  0:52
CLOCK: [2020-01-14 Tue 18:38]--[2020-01-14 Tue 19:04] =>  0:26
CLOCK: [2020-01-14 Tue 16:24]--[2020-01-14 Tue 16:44] =>  0:20
CLOCK: [2020-01-14 Tue 13:49]--[2020-01-14 Tue 15:52] =>  2:03
CLOCK: [2020-01-14 Tue 11:11]--[2020-01-14 Tue 12:42] =>  1:31
CLOCK: [2020-01-13 Mon 21:10]--[2020-01-13 Mon 22:00] =>  0:50
CLOCK: [2020-01-10 Fri 17:51]--[2020-01-10 Fri 18:51] =>  1:00
CLOCK: [2020-01-08 Wed 13:06]--[2020-01-08 Wed 14:12] =>  1:06
CLOCK: [2020-01-08 Wed 11:19]--[2020-01-08 Wed 12:31] =>  1:12
CLOCK: [2020-01-07 Tue 17:27]--[2020-01-07 Tue 18:27] =>  1:00
CLOCK: [2020-01-02 Thu 13:32]--[2020-01-02 Thu 14:32] =>  1:00
CLOCK: [2019-12-27 Fri 19:15]--[2019-12-27 Fri 21:20] =>  2:05
CLOCK: [2019-12-27 Fri 14:50]--[2019-12-27 Fri 15:12] =>  0:22
:END:
https://github.com/NYU-Molecular-Pathology
https://www.pnas.org/content/115/4/E743.long
- github searhing e.g. https://github.com/search?utf8=%E2%9C%93&q=followLinks++extension%3A.nf&type=Code&ref=advsearch&l=&l=
- see for inputs from csv- https://github.com/nf-core/atacseq/blob/master/main.nf
- raw data should reside in protected dirs
- https://www.reddit.com/search?q=nextflow
- cite federico2019
- useful tutorials
  - https://nextflow-io.github.io/hack17-varcall/#_input_parameters associated github at radonc-cancerbio:~/data/tmp
- https://sciwiki.fredhutch.org/compdemos/nextflow/
- https://learn.gencore.bio.nyu.edu/nextflow/
- https://www.ebi.ac.uk/goldman-srv/simNGS/runfiles5/HiSeq/
- https://github.com/genome/gms/wiki/HCC1395-WGS-Exome-RNA-Seq-Data
- http://nextflow-io.github.io/patterns/index.html#_process_per_file_pairs
- [[https://stackoverflow.com/questions/tagged/nextflow][nextflow stack questions]]
- https://github.com/nextflow-io/patterns
- [[https://github.com/nextflow-io/nf-hack18][2018 workshop github]]
- [[https://nextflow-io.github.io/nf-hack18/training.html][2018 workshop course]]
- [[https://github.com/search?utf8=%25E2%259C%2593&q=language%253Anextflow+&type=][github repos using nextflow]]
- https://github.com/cbcrg/piper-nf/blob/master/piper.nf
- [[https://github.com/search?utf8=%25E2%259C%2593&q=language%253Anextflow+&type=][github nextflow repositories]]
- https://groups.google.com/forum/m/#!forum/nextflow
- https://www.nextflow.io/presentations.html
- http://groovy-lang.org/single-page-documentation.html
- https://dzone.com/refcardz/groovy?chapter=10
- https://www.manning.com/books/groovy-in-action-second-edition
- https://github.com/MaxUlysse/compile-latex
- https://nextflow-io.github.io/nf-hack18/training.html
- https://github.com/nextflow-io/patterns
- https://nextflow-io.github.io/hack17-varcall/
- [[https://medium.com/@alaincoletta/how-to-create-a-nextflow-pipeline-with-all-necessary-tools-for-a-series-of-repetitive-35cf5b3b19a8][Coletta tutorial]]
- processes
  - check if file exists
- commands
  |----------+---------|
  | function | command |
  |----------+---------|
  | <35>     | <35>    |
  |          |         |
- standards and best practice
- [[https://www.nextflow.io/docs/latest/index.html][documentation]]
- applications
- reference
  - [[file:~/.emacs.d/snippets/org-mode/software]]
**** oligocalc
:PROPERTIES:
:doc:  [[http://www.basic.northwestern.edu/biotools/oligocalc.html][site]]
:ID:       2c1b467b-8795-414f-a9e6-798f6cac8c0a
:END:
**** pathvisio                                                      :biotool:
:PROPERTIES:
:ID:       17c865dc-765c-496d-b5c7-60d3d3439de3
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1004085
- [[id:d84cf649-32f4-46e6-b041-4a8a76b31ffc][Pathway encoding]]
- https://github.com/PathVisio/GPML
- https://github.com/PathVisio
- cite:wikipathways
- used in [[id:69bfa728-e149-4b8a-9863-347630f86bc4][wikipathways]]
- https://pathvisio.github.io/
- to switch to java 8 https://askubuntu.com/questions/1133216/downgrading-java-11-to-java-8
**** picard                                                         :biotool:
:PROPERTIES:
:ID:       9e48626d-47e1-477a-8b79-eff41f7974b8
:CREATED:  [2021-09-13 Mon 07:29]
:doc:  [[https://broadinstitute.github.io/picard/index.html][doc]]
:END:
**** polyester                                                      :biotool:
:PROPERTIES:
:ID:       065725b4-43d3-48d4-a4e2-3ca5c1e1e6fd
:CREATED:  [2021-09-13 Mon 07:29]
:substrate: fasta,gtf
:use: rna-seq simulation
:doc:  [[http://bioconductor.org/packages/release/bioc/vignettes/polyester/inst/doc/polyester.html][vignette]]
:END:
  - https://www.bioconductor.org/packages/release/bioc/vignettes/polyester/inst/doc/polyester.html

**** preseq                                                         :biotool:
:PROPERTIES:
:ID:       6d8cbcc0-2651-4c51-991e-639dbc81ea66
:END:
- http://smithlabresearch.org/manuals/preseqmanual.pdf
- library complexity- preseqr http://smithlabresearch.org/manuals/preseqmanual.pdf

**** rGREAT
:PROPERTIES:
:ID:       035310e5-9f99-4288-a521-bf2343260b4a
:END:
https://www.bioconductor.org/packages/release/bioc/vignettes/rGREAT/inst/doc/local-GREAT.html
**** rnaseqc
:PROPERTIES:
:use: rna-seq qc
:substrate: bam
:repo:  [[https://github.com/broadinstitute/rnaseqc][repo]]
:doc: [[https://github.com/broadinstitute/rnaseqc][repo]]
:ID:       d21d95cd-d781-4b5e-b55a-5386d45b4589
:END:
**** rsem                                                           :biotool:
:PROPERTIES:
:ID:       85db5c34-b5fd-4b6c-bdb7-88263e553ba3
:CREATED:  [2021-09-13 Mon 07:29]
:paper:  cite:li2011
:use: transcript quantification
:substrate: bam
:repo: [[https://github.com/deweylab/RSEM][repo]]
:paper: |          | [[https://doi.org/10.1186/1471-2105-12-323][paper]] | cite:li2011            |
:END:
-
- https://bioconductor.org/packages/release/bioc/vignettes/tximport/inst/doc/tximport.html#rsem
- documentation
  - https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-323
  - https://github.com/ENCODE-DCC/long-rna-seq-pipeline/blob/master/DAC/STAR_RSEM.sh
  - http://deweylab.biostat.wisc.edu/rsem/rsem-calculate-expression.html
  - http://deweylab.biostat.wisc.edu/rsem/rsem-prepare-reference.html
  - https://deweylab.github.io/RSEM/rsem-calculate-expression.html
  - https://bioconductor.org/packages/release/bioc/vignettes/tximport/inst/doc/tximport.html#rsem
**** RSeQC
:PROPERTIES:
:use: rna-seq qc
:substrate: bam
:doc:  [[http://rseqc.sourceforge.net/][repo]]
:paper:  [[https://doi.org/10.1093/bioinformatics/bts356][paper]] | cite:wang2012
:ID:       72b60889-8b03-4b30-b893-3c61886342a6
:END:
**** salmon                                                         :biotool:
:PROPERTIES:
:substrate: fastq
:use: RNA-seq pseudoalignment
:repo:  [[https://github.com/COMBINE-lab/salmon][repo]]
:doc:    [[https://salmon.readthedocs.io/en/latest/][doc]]
:paper:    [[https://doi.org/10.1038/nmeth.4197][paper]] | cite:patro2017
:ID:       c0d79be1-f887-460e-9142-4d43c6632126
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- see [[id:a0923938-4021-44cd-a8f3-94c0eb10cdb5][table of tools]]
- https://support.bioconductor.org/p/9140398/
- https://www.biostars.org/p/397086/
- https://www.scopus.com/results/citedbyresults.uri?sort=cp-f&cite=2-s2.0-85014549629&src=s&nlo=&nlr=&nls=&imp=t&sid=b3adb06908021bf68bd2e4cbb741bd78&sot=cite&sdt=a&sl=0&origin=resultslist&offset=1&txGid=8f3b391583118470ef66b945cc173d58
**** sambamba
:PROPERTIES:
:use: bam processing
:substrate: bam
:doc:  [[http://lomereiter.github.io/sambamba/docs/sambamba-view.html][online]]
:ID:       b4ce98cf-41da-43ca-9a52-ca78fadeabe3
:END:
**** samblaster
:PROPERTIES:
:doc:  [[https://github.com/GregoryFaust/samblaster][repo]]
:paper:   [[https://academic.oup.com/bioinformatics/article/30/17/2503/2748175][paper]]
:repo: [[https://github.com/GregoryFaust/samblaster][repo]]
:substrate: bam
:utility: single-pass dedup
:ID:       db8890a3-ba7c-4512-bf7c-dba6f6fb69ff
:END:
**** samtools                                                       :biotool:
:PROPERTIES:
:ID:       0a3acec7-f4d1-4cd1-b3c8-7ec769715cc1
:CREATED:  [2021-09-13 Mon 07:29]
:doc:  [[http://www.htslib.org/doc/samtools.html][online]]
:END:
- https://bioinformatics.stackexchange.com/questions/18538/samtools-sort-most-efficient-memory-and-thread-settings-for-many-samples-on-a-c
- [[http://barcwiki.wi.mit.edu/wiki/SOPs/miningSAMBAM][some common Samtools tasks]]
- [[http://davetang.org/wiki/tiki-index.php?page=SAMTools][a Samtools tutorial]]
- [[http://biobits.org/samtools_primer.html][another Samtools tutorial]]
- [[http://broadinstitute.github.io/picard/explain-flags.html][SAM flags]]
- https://github.com/merenlab/anvio/issues/1479
- [[http://biobits.org/samtools_primer.html][another Samtools tutorial]]
- [[http://www.htslib.org/workflow/#mapping_to_cram][using cram]]
- [[https://www.samformat.info/sam-format-header][header tool]]
- commands
  - sequence inspection and quality
    | function                              | command                                       |
    |---------------------------------------+-----------------------------------------------|
    | <35>                                  | <35>                                          |
    | see     bam header                    | view -H                                       |
    | see bam header and top seq in sam/bam | samtools view -h <FILE.bam> \vert head -n 100 |
    | see ?                                 | idxstats                                      |
    |                                       |                                               |
  - sequence file manipulations
    |-------------------+---------------------------------------------------|
    | function          | command                                           |
    |-------------------+---------------------------------------------------|
    | check bam EOF     | samtools quickcheck <.bam>                        |
    | merge bams        | samtools merge all.bam *.bam                      |
    | random sample bam | samtools view -s 0.5 -b file.bam >random_half.bam |
    | split by chrom    | samtools view -b <FULL.bam> chr1 > chr1.bam       |
    | merge             | samtools merge <OUT.bam> <IN1.bam> <IN2.bam>      |
    | trim by quality   | -q INT                                            |
    | bam to sam        | samtools view -h -o out.sam in.bam                |
    | sam to bam        | samtools view -bS test.sam > test.bam             |
    | remove unmapped   | samtools view -h -F 4 file.bam                    |
**** Scythe
:PROPERTIES:
:ID:       e03c83e4-5c62-44a4-b746-cca9c0515007
:END:
 [[https://github.com/vsbuffalo/scythe][Scythe]]
**** SeqKit
:PROPERTIES:
:ID:       0ad6d41d-fac8-4f9f-9ff1-c5c73db9c44d
:END:

https://bioinf.shenwei.me/seqkit/usage/#fx2tab-tab2fx
https://www.biostars.org/p/9465609/
**** seqtk
:PROPERTIES:
:ID:       0f99c58c-97c1-4fe8-990f-2d333ce58ced
:END:
:PROPERTIES:
:repo:  [[https://github.com/lh3/seqtk][github]]
:doc: [[https://github.com/lh3/seqtk/blob/master/README.md][README]]

:END:
**** seqTools
:PROPERTIES:
:function:  [[id:1EE731A3-83DD-46AF-B988-2311307C335F][seq qc]]
:doc:  [[https://www.bioconductor.org/packages/release/bioc/vignettes/seqTools/inst/doc/seqTools.pdf][seqTools]]
:ID:       7ddc84f8-443d-4c8a-980a-af6db286e733
:END:
**** simNGS
:PROPERTIES:
:ID:       8fdb3c6c-fbab-4850-a9de-2af9b3643a54
:END:
:PROPERTIES:
:doc: [[https://www.ebi.ac.uk/goldman-srv/simNGS/][website]]

:END:
**** [[id:a8b27140-4b9e-40c5-86ab-ee5afeae723f][snakemake]]
:PROPERTIES:
:ID:       723ab6ce-97c4-464b-ab7e-232379ff6ed8
:END:
**** SRA toolkit                                                    :biotool:
:PROPERTIES:
:ID:       43142b0d-ad38-450d-bdf4-da1f3a17ac79
:END:
#+begin_src bash
conda activate biotools

sra_dir="/mnt/ris/szymanski/Active/tmp/sra"

# Using sra toolkit to fetch "Airway" experiment used as an example in DESeq-related tools

mkdir -p $sra_dir
cd $sra_dir

# Prefetch
# This will create subdirectories within $sra_dir, and each subdirectory will contain a single SRA file.
# E.g.
# --sra_dir
#   |-- SRR1039508
#       |-- SRR1039508.sra
#   |-- SRR1039509
#       |-- SRR1039509.sra
# etc...

prefetch SRP033351

# Fastq-dump to convert the SRA files to fastq:

find "${sra_dir}" -type d | parallel 'fastq-dump --split-files {}'

# Zip up the fastqs



#+end_src
**** STAR                                                           :biotool:
:PROPERTIES:
:ID:       d1d5d554-57c4-4b9c-8385-2bb72369375e
:CREATED:  [2021-09-13 Mon 07:29]
:paper:  cite:dobin2019
:doc:  [[https://github.com/alexdobin/STAR/blob/master/doc/STARmanual.pdf][doc]]
:END:
 UPDATE- STAR should handle adaptors (and maybe low quality reads as well, although there aren't many of those).
 see- https://groups.google.com/forum/#!searchin/rna-star/adaptor/rna-star/T8zBqtlxopU/8kVi17eDGAAJ

- used in [[id:326ecd60-8cd4-4815-a389-967b2c3fef0a][alignment]]
- star-rsem pipeline
  - cite:djebali2017
**** tophat2                                                        :biotool:
:PROPERTIES:
:doc:  [[https://ccb.jhu.edu/software/tophat/manual.html][doc]]
:ID:       db678422-a644-4298-b962-33657a5dee7e
:CREATED:  [2021-09-13 Mon 07:29]
:END:
notes- https://www.biostars.org/p/251018/
**** Trim Galore                                                    :biotool:
:PROPERTIES:
:ID:       3e4ca528-a604-4bfe-b235-2052e6d2d4a9
:CREATED:  [2021-09-13 Mon 07:29]
:END:
-
  - wrapper for Cutadapt and FastQC
  - [[https://github.com/FelixKrueger/TrimGalore][github]]
    - [[https://github.com/FelixKrueger/TrimGalore/blob/master/Docs/Trim_Galore_User_Guide.md][user guide]]
  - on CHPC cluster - http://mgt2.chpc.wustl.edu/wiki119/index.php/Software
- https://github.com/FelixKrueger/TrimGalore
**** trimmomatic                                                    :biotool:
:PROPERTIES:
:ID:       132a953c-e3c3-441a-8aac-28846625959b
:END:
http://www.usadellab.org/cms/?page=trimmomatic
https://www.biostars.org/p/478810/
**** trimmomatic                                                    :biotool:
:PROPERTIES:
:ID:       823dcbac-d38c-4c56-a848-d5f2f931adf0
:END:
http://www.usadellab.org/cms/?page=trimmomatic
https://www.biostars.org/p/478810/
**** tximport                                                       :biotool:
:PROPERTIES:
:doi:  [[http://dx.doi.org/10.12688/f1000research.7563.1][paper]]
:ID:       a5d4a32f-764b-4930-80e9-2a6e8d562ae8
:CREATED:  [2021-09-13 Mon 07:29]
:END:
#+begin_src R
saveDb()
#+end_src
- offsets handled directly in DESeq2 command - https://bioconductor.org/packages/devel/bioc/vignettes/tximport/inst/doc/tximport.html#Downstream_DGE_in_Bioconductor
"tximport can alternatively produce a matrix of data that is roughly on the scale of counts, by scaling transcript-per-million (TPM) abundances to add up to the total number of mapped reads. This counts-from-abundance approach directly corrects for technical biases and differential transcript usage across samples, obviating the need for the accompanying offset matrix"
**** wgcna                                                          :biotool:
:PROPERTIES:
:paper: [[https://doi.org/10.1186/1471-2105-9-559][paper]]
:ID:       948289d8-3a77-471a-b068-0507285e0bac
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- visualization
  - example
    - https://www.nature.com/articles/s41467-018-08126-5#Sec2
- https://www.nature.com/articles/nature16965#Sec1
- [[https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/Tutorials/][Horvath tutorials]]
  #+name:tutorial1-input
  #+begin_src R
#=====================================================================================
#
#  Code chunk 1
#
#=====================================================================================


# Display the current working directory
getwd();
# If necessary, change the path below to the directory where the data files are stored.
# "." means current directory. On Windows use a forward slash / instead of the usual \.
workingDir = ".";
setwd(workingDir);
# Load the package
library(WGCNA);
# The following setting is important, do not omit.
options(stringsAsFactors = FALSE);
#Read in the female liver data set
femData = read.csv("LiverFemale3600.csv");
# Read in the male liver data set
maleData = read.csv("LiverMale3600.csv");
# Take a quick look at what is in the data sets (caution, longish output):
dim(femData)
names(femData)
dim(maleData)
names(maleData)


#=====================================================================================
#
#  Code chunk 2
#
#=====================================================================================


# We work with two sets:
nSets = 2;
# For easier labeling of plots, create a vector holding descriptive names of the two sets.
setLabels = c("Female liver", "Male liver")
shortLabels = c("Female", "Male")
# Form multi-set expression data: columns starting from 9 contain actual expression data.
multiExpr = vector(mode = "list", length = nSets)

multiExpr[[1]] = list(data = as.data.frame(t(femData[-c(1:8)])));
names(multiExpr[[1]]$data) = femData$substanceBXH;
rownames(multiExpr[[1]]$data) = names(femData)[-c(1:8)];
multiExpr[[2]] = list(data = as.data.frame(t(maleData[-c(1:8)])));
names(multiExpr[[2]]$data) = maleData$substanceBXH;
rownames(multiExpr[[2]]$data) = names(maleData)[-c(1:8)];
# Check that the data has the correct format for many functions operating on multiple sets:
exprSize = checkSets(multiExpr)


#=====================================================================================
#
#  Code chunk 3
#
#=====================================================================================


# Check that all genes and samples have sufficiently low numbers of missing values.
gsg = goodSamplesGenesMS(multiExpr, verbose = 3);
gsg$allOK


#=====================================================================================
#
#  Code chunk 4
#
#=====================================================================================


if (!gsg$allOK)
{
  # Print information about the removed genes:
  if (sum(!gsg$goodGenes) > 0)
    printFlush(paste("Removing genes:", paste(names(multiExpr[[1]]$data)[!gsg$goodGenes],
                                              collapse = ", ")))
  for (set in 1:exprSize$nSets)
  {
    if (sum(!gsg$goodSamples[[set]]))
      printFlush(paste("In set", setLabels[set], "removing samples",
                       paste(rownames(multiExpr[[set]]$data)[!gsg$goodSamples[[set]]], collapse = ", ")))
    # Remove the offending genes and samples
    multiExpr[[set]]$data = multiExpr[[set]]$data[gsg$goodSamples[[set]], gsg$goodGenes];
  }
  # Update exprSize
  exprSize = checkSets(multiExpr)
}


#=====================================================================================
#
#  Code chunk 5
#
#=====================================================================================


sampleTrees = list()
for (set in 1:nSets)
{
  sampleTrees[[set]] = hclust(dist(multiExpr[[set]]$data), method = "average")
}


#=====================================================================================
#
#  Code chunk 6
#
## #=====================================================================================



#=====================================================================================
#
#  Code chunk 7
#
#=====================================================================================


# Choose the "base" cut height for the female data set
baseHeight = 16
# Adjust the cut height for the male data set for the number of samples
cutHeights = c(16, 16*exprSize$nSamples[2]/exprSize$nSamples[1]);
# Re-plot the dendrograms including the cut lines
## pdf(file = "Plots/SampleClustering.pdf", width = 12, height = 12);
## par(mfrow=c(2,1))
## par(mar = c(0, 4, 2, 0))
## for (set in 1:nSets)
## {
##   plot(sampleTrees[[set]], main = paste("Sample clustering on all genes in", setLabels[set]),
##        xlab="", sub="", cex = 0.7);
##   abline(h=cutHeights[set], col = "red");
## }
## dev.off();


#=====================================================================================
#
#  Code chunk 8
#
#=====================================================================================


for (set in 1:nSets)
{
  # Find clusters cut by the line
  labels = cutreeStatic(sampleTrees[[set]], cutHeight = cutHeights[set])
  # Keep the largest one (labeled by the number 1)
  keep = (labels==1)
  multiExpr[[set]]$data = multiExpr[[set]]$data[keep, ]
}
collectGarbage();
# Check the size of the leftover data
exprSize = checkSets(multiExpr)
exprSize


#=====================================================================================
#
#  Code chunk 9
#
#=====================================================================================


traitData = read.csv("ClinicalTraits.csv");
dim(traitData)
names(traitData)
# remove columns that hold information we do not need.
allTraits = traitData[, -c(31, 16)];
allTraits = allTraits[, c(2, 11:36) ];
# See how big the traits are and what are the trait and sample names
dim(allTraits)
names(allTraits)
allTraits$Mice
# Form a multi-set structure that will hold the clinical traits.
Traits = vector(mode="list", length = nSets);
for (set in 1:nSets)
{
  setSamples = rownames(multiExpr[[set]]$data);
  traitRows = match(setSamples, allTraits$Mice);
  Traits[[set]] = list(data = allTraits[traitRows, -1]);
  rownames(Traits[[set]]$data) = allTraits[traitRows, 1];
}
collectGarbage();
# Define data set dimensions
nGenes = exprSize$nGenes;
nSamples = exprSize$nSamples;


#=====================================================================================
#
#  Code chunk 10
#
#=====================================================================================


save(multiExpr, Traits, nGenes, nSamples, setLabels, shortLabels, exprSize,
     file = "Consensus-dataInput.RData");


#+end_src

  #+name:tutorial2-auto-network-construct
  #+begin_src R
#=====================================================================================
#
#  Code chunk 1
#
#=====================================================================================


# Display the current working directory
getwd();
# If necessary, change the path below to the directory where the data files are stored.
# "." means current directory. On Windows use a forward slash / instead of the usual \.
workingDir = ".";
setwd(workingDir);
# Load the WGCNA package
library(WGCNA)
# The following setting is important, do not omit.
options(stringsAsFactors = FALSE);
# Allow multi-threading within WGCNA.
# Caution: skip this line if you run RStudio or other third-party R environments.
# See note above.
enableWGCNAThreads()
# Load the data saved in the first part
lnames = load(file = "Consensus-dataInput.RData");
# The variable lnames contains the names of loaded variables.
lnames
# Get the number of sets in the multiExpr structure.
nSets = checkSets(multiExpr)$nSets


#=====================================================================================
#
#  Code chunk 2
#
#=====================================================================================


# Choose a set of soft-thresholding powers
powers = c(seq(4,10,by=1), seq(12,20, by=2));
# Initialize a list to hold the results of scale-free analysis
powerTables = vector(mode = "list", length = nSets);
# Call the network topology analysis function for each set in turn
for (set in 1:nSets)
  powerTables[[set]] = list(data = pickSoftThreshold(multiExpr[[set]]$data, powerVector=powers,
                                                     verbose = 2)[[2]]);
collectGarbage();
# Plot the results:
colors = c("black", "red")
# Will plot these columns of the returned scale free analysis tables
plotCols = c(2,5,6,7)
colNames = c("Scale Free Topology Model Fit", "Mean connectivity", "Median connectivity",
"Max connectivity");
# Get the minima and maxima of the plotted points
ylim = matrix(NA, nrow = 2, ncol = 4);
for (set in 1:nSets)
{
  for (col in 1:length(plotCols))
  {
    ylim[1, col] = min(ylim[1, col], powerTables[[set]]$data[, plotCols[col]], na.rm = TRUE);
    ylim[2, col] = max(ylim[2, col], powerTables[[set]]$data[, plotCols[col]], na.rm = TRUE);
  }
}
# Plot the quantities in the chosen columns vs. the soft thresholding power
## sizeGrWindow(8, 6)
## pdf(file = "Plots/scaleFreeAnalysis.pdf", wi = 8, he = 6)
## par(mfcol = c(2,2));
## par(mar = c(4.2, 4.2 , 2.2, 0.5))
## cex1 = 0.7;
## for (col in 1:length(plotCols)) for (set in 1:nSets)
## {
##   if (set==1)
##   {
##     plot(powerTables[[set]]$data[,1], -sign(powerTables[[set]]$data[,3])*powerTables[[set]]$data[,2],
##          xlab="Soft Threshold (power)",ylab=colNames[col],type="n", ylim = ylim[, col],
##          main = colNames[col]);
##     addGrid();
##   }
##   if (col==1)
##   {
##     text(powerTables[[set]]$data[,1], -sign(powerTables[[set]]$data[,3])*powerTables[[set]]$data[,2],
##          labels=powers,cex=cex1,col=colors[set]);
##   } else
##     text(powerTables[[set]]$data[,1], powerTables[[set]]$data[,plotCols[col]],
##          labels=powers,cex=cex1,col=colors[set]);
##   if (col==1)
##   {
##     legend("bottomright", legend = setLabels, col = colors, pch = 20) ;
##   } else
##     legend("topright", legend = setLabels, col = colors, pch = 20) ;
## }
## dev.off();


#=====================================================================================
#
#  Code chunk 3
#
#=====================================================================================


net = blockwiseConsensusModules(
        multiExpr, power = 6, minModuleSize = 30, deepSplit = 2,
        pamRespectsDendro = FALSE,
        mergeCutHeight = 0.25, numericLabels = TRUE,
        minKMEtoStay = 0,
        saveTOMs = TRUE, verbose = 5)


#=====================================================================================
#
#  Code chunk 4
#
#=====================================================================================
#+end_src

************* NEXT HCC1395 straight align and integrate and compare to published
:PROPERTIES:
:CREATED:  [2019-03-13 Wed 10:11]
:ID:       58F7BED2-DED1-4911-9E8C-104E12126A73
:END:
:LOGBOOK:
CLOCK: [2019-03-14 Thu 07:49]--[2019-03-14 Thu 08:45] =>  0:56
CLOCK: [2019-03-13 Wed 18:18]--[2019-03-13 Wed 19:54] =>  1:36
CLOCK: [2019-03-13 Wed 11:30]--[2019-03-13 Wed 12:00] =>  0:30
CLOCK: [2019-03-13 Wed 11:00]--[2019-03-13 Wed 11:01] =>  0:01
CLOCK: [2019-03-13 Wed 10:12]--[2019-03-13 Wed 10:47] =>  0:35
:END:
- log
  - from bam to fastq
    - by sample
      - tumor
        - ./sambamba-0.6.8-linux-static sort -n -o /gscmnt/gc2555/spencer/jeff/data/HCC1395-anmesort.bam /gscmnt/gc2555/spencer/jeff/data/gerald_C1TD1ACXX_8_ACAGTG.bam
        - samtools fastq -1 /gscmnt/gc2555/spencer/jeff/data/HCC1395_1.fastq -2 /gscmnt/gc2555/spencer/jeff/data/HCC1395_2.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395-anmesort.bam
      - moved all this to ~data/HCC1395/
      - normal
        - (integrate image, 64gb) sambamba sort -n -o /gscmnt/gc2555/spencer/jeff/data/HCC1395/normal-namesort.bam /gscmnt/gc2555/spencer/jeff/data/HCC1395/gerald_C2DBEACXX_3.bam
        - samtools fastq -1 /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_1.fastq -2 /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_2.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/normal.namesort.bam
        -
  - alignment
    - bsub -Is -q docker-interactive -R "select[ncpus >=4 && mem>64000] span[hosts=1] rusage[mem=64000]" -a 'docker(jeszyman/startest)' /bin/bash
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395_2.fastq --outSAMunmapped Within
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-bl_2.fastq --outSAMunmapped Within
      - STAR --runThreadN 4 --genomeDir /gscmnt/gc2555/spencer/jeff/data/reference/star-index/ --readFilesIn /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-all_1.fastq /gscmnt/gc2555/spencer/jeff/data/HCC1395/HCC1395-all_2.fastq --outSAMunmapped Within
  - integrate
    - bsub -q research-hpc -R "select[ncpus >=4 && mem>64000] span[hosts=1] rusage[mem=64000]" -a 'docker(jeszyman/integrate)' /bin/bash
    - prep each star output:
      -
      - sambamba view -S -o Aligned.out.bam Aligned.out.sam
      - sambamba sort Aligned.out.bam
      - sambamba index Aligned.out.sorted.bam
    - Integrate fusion /gscmnt/gc2555/spencer/jeff/data/reference/Homo_sapiens.GRCh38.dna.primary_assembly.fa /gscmnt/gc2555/spencer/jeff/data/reference/annot-hg38-refeseq.txt /gscmnt/gc2555/spencer/jeff/data/reference/Integrate/bwts /gscmnt/gc2555/spencer/jeff/dev/starhcc/Aligned.out.sorted.bam /gscmnt/gc2555/spencer/jeff/dev/starhcc/Aligned.out.sorted.bam
      -
**** wikipathways                                                   :biotool:
:PROPERTIES:
:ID:       69bfa728-e149-4b8a-9863-347630f86bc4
:END:
- uses [[id:17c865dc-765c-496d-b5c7-60d3d3439de3][pathvisio]]
- cite:wikipathways
*** Table
:PROPERTIES:
:ID:       acd826b6-dad7-49df-9cc7-8f3eff2aa363
:END:
#+BEGIN: propview :id "1b8bb7db-2622-47bd-bd6f-052cbd5d4fdb" :cols (DOC)
|                                                                                                                   DOC |     |   |       |   |     |   |   |   |
|-----------------------------------------------------------------------------------------------------------------------+-----+---+-------+---+-----+---+---+---|
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                    "" |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                 [[http://bedtools\.readthedocs\.io/en/latest/] [doc]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                        "https://github.com/seqan/flexbar/wiki/Manual" |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
| [[http://portals\.broadinstitute\.org/cgi-bin/cancer/publications/pub_paper\.cgi\?mode=view&paper_id=216&p=t] [site]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     " |     |   | fastq |   | [[https://ccb.jhu.edu/software/hisat2/manual.html][doc]] |   |   | " |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                            [[https://github\.com/broadinstitute/ichorCNA/wiki] [doc]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     " | [[https://multiqc.info/docs/][doc]] |   |       | " |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                              [[http://www\.basic\.northwestern\.edu/biotools/oligocalc\.html] [site]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                       [[https://broadinstitute\.github\.io/picard/index\.html] [doc]] |     |   |       |   |     |   |   |   |
|            [[http://bioconductor\.org/packages/release/bioc/vignettes/polyester/inst/doc/polyester\.html] [vignette]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                 [[https://github\.com/broadinstitute/rnaseqc] [repo]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                            [[http://rseqc\.sourceforge\.net/] [repo]] |     |   |       |   |     |   |   |   |
|                                                                  [[https://salmon\.readthedocs\.io/en/latest/] [doc]] |     |   |       |   |     |   |   |   |
|                                          [[http://lomereiter\.github\.io/sambamba/docs/sambamba-view\.html] [online]] |     |   |       |   |     |   |   |   |
|                                                                [[https://github\.com/GregoryFaust/samblaster] [repo]] |     |   |       |   |     |   |   |   |
|                                                               [[http://www\.htslib\.org/doc/samtools\.html] [online]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|         [[https://www\.bioconductor\.org/packages/release/bioc/vignettes/seqTools/inst/doc/seqTools\.pdf] [seqTools]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                          [[https://github\.com/alexdobin/STAR/blob/master/doc/STARmanual\.pdf] [doc]] |     |   |       |   |     |   |   |   |
|                                                          [[https://ccb\.jhu\.edu/software/tophat/manual\.html] [doc]] |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|                                                                                                                     0 |     |   |       |   |     |   |   |   |
|-----------------------------------------------------------------------------------------------------------------------+-----+---+-------+---+-----+---+---+---|
|                                                                                                                       |     |   |       |   |     |   |   |   |
#+END:
*** tool collections
:PROPERTIES:
:ID:       7cce7be9-b3ac-4127-9a92-71559617588e
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- [[https://www.ebi.ac.uk/services][EMBL-EBI Tools]]
**** UCSC tools                                                     :biotool:
:PROPERTIES:
:ID:       be612cfb-2a75-4935-92fd-85620dcabf92
:CREATED:  [2021-09-13 Mon 07:29]
:END:
- hosting track hubs- try cyverse
  - https://cyverse.org/about
  - https://genome.ucsc.edu/goldenPath/help/hgTrackHubHelp.html#Hosting
  - https://genome.ucsc.edu/goldenPath/help/hubQuickStart.html
  - https://genome.ucsc.edu/goldenPath/help/hgTrackHubHelp.html#Hosting
- ucsc
  - table browser
    - https://genomebrowser.wustl.edu/goldenPath/help/hgTextHelp.html#Introduction
  - https://www.biostars.org/p/19029/
  - http://genome.ucsc.edu/FAQ/FAQreleases.html
  - cite:karolchik2011
*** <<<Integrated Genomics Viewer>>> (<<<IGV>>>)
:PROPERTIES:
:ID:       917062AC-32E8-41F5-A511-84AA7B1504B0
:END:

- cite:robinson2017
https://www.france-bioinformatique.fr/sites/default/files/EBA/V3-2014/Elodie_Giraud_visualisation-IGV_TP_EBA-2014-10.pdf
[[http://software.broadinstitute.org/software/igv/UserGuide][User Guide]]
*** Reference
https://www.reddit.com/r/bioinformatics/comments/1i1hs1q/whats_your_this_program_is_a_thing_of_beauty/
** Biotools dockerfiles
:PROPERTIES:
:ID:       62331122-a12d-4cfa-a1f6-1b86574f6be5
:END:
:LOGBOOK:
CLOCK: [2021-12-09 Thu 16:19]--[2021-12-09 Thu 17:19] =>  1:00
CLOCK: [2022-01-04 Tue 09:15]--[2022-01-04 Tue 09:16] =>  0:01
CLOCK: [2021-12-09 Thu 16:19]--[2021-12-09 Thu 17:15] =>  0:56
CLOCK: [2021-03-03 Wed 19:56]--[2021-03-03 Wed 21:25] =>  1:29
:END:
*** [[id:79e01a67-5ba1-4257-8353-8c5cf1ac8c4a][Basecamp docker]]
:PROPERTIES:
:ID:       8bee9931-e8cd-42d1-be58-2ce626146e6c
:END:
*** [[file:docker/biotools_Dockerfile][Biotools docker]]
:PROPERTIES:
:ID:       7ed344ce-373c-4f9e-b24f-87b57374e1a0
:header-args:bash: :tangle ./docker/biotools_Dockerfile
:END:
:LOGBOOK:
CLOCK: [2021-12-09 Thu 16:19]--[2021-12-09 Thu 17:19] =>  1:00
CLOCK: [2022-01-04 Tue 09:15]--[2022-01-04 Tue 09:16] =>  0:01
CLOCK: [2021-12-09 Thu 16:19]--[2021-12-09 Thu 17:15] =>  0:56
CLOCK: [2021-03-03 Wed 19:56]--[2021-03-03 Wed 21:25] =>  1:29
:END:
***** Preamble
:PROPERTIES:
:ID:       85dd4e86-83e1-43b4-8fd2-4caec5f93013
:END:

***** Conda
:PROPERTIES:
:ID:       aa79d1a0-f7b4-4cf2-8ba7-5b4edcd6615d
:END:
#+begin_src bash

#################
###   Conda   ###
#################

RUN conda install -c bioconda bbmap=39.00 \
    && conda install -c bioconda bcftools=1.15.1 \
    && conda install -c bioconda bedops=2.4.41 \
    && conda install -c bioconda bedtools=2.30.0 \
    && conda install -c bioconda bowtie=1.3.1 \
    && conda install -c bioconda bowtie2=2.4.5 \
    && conda install -c bioconda bwa=0.7.17 \
    && conda install -c bioconda cutadapt=4.1 \
    && conda install -c bioconda deeptools=3.5.1 --force \
    && conda install -c bioconda fastp=0.23.2 \
    && conda install -c bioconda fastqc=0.11.9 \
    && conda install -c bioconda gatk=4.2.6.0 \
    && conda install -c bioconda goleft=0.2.4 \
    && conda install -c bioconda htseq=2.0.2 \
    && conda install -c bioconda mosdepth=0.3.3 \
    && conda install -c bioconda preseq=3.2.0 \
    && conda install -c bioconda pysam=0.19.1 \
    && conda install -c bioconda qualimap=2.2.2d \
    && conda install -c bioconda sambamba=0.8.2 \
    && conda install -c bioconda samblaster=0.1.26 \
    && conda install -c bioconda samtools=1.7 \
    && conda install -c bioconda seqkit=2.3.1 \
    && conda install -c bioconda seqtk=1.3 \
    && conda install -c bioconda skewer=0.2.2 \
    && conda install -c bioconda trimmomatic=0.39 \
    && conda install -c bioconda vcftools=0.1.16-7
#+end_src
***** R and Bioconductor
:PROPERTIES:
:ID:       39c663d7-bcb0-4bd0-9015-bbf011e7ebc4
:END:
#+begin_src bash
# To avoid conflict with jeszyman/basecamp R install
#RUN conda uninstall r-base

##########################
###   R Bioconductor   ###
##########################

RUN R -e "install.packages('BiocManager', repos='http://cran.rstudio.com/')"

RUN R -e "BiocManager::install(version='3.15', update=TRUE, ask=FALSE)"

RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("AnnotationDbi",\
                                 "apeglm"
                                 "BiocParallel", \
                                 "biomaRt", \
                                 "BSgenome.Hsapiens.UCSC.hg38", \
                                 "BSgenome.Mmusculus.UCSC.mm10", \
                                 "ComplexHeatmap", \
                                 "DEGreport", \
                                 "DESeq2", \
                                 "edgeR", \
                                 "EnsDb.Mmusculus.v79", \
                                 "GenomicAlignments", \
                                 "org.Hs.eg.db", \
                                 "org.Mm.eg.db", \
                                 "readr", \
                                 "Rsamtools", \
                                 "TxDb.Hsapiens.UCSC.hg38.knownGene", \
                                 "TxDb.Hsapiens.UCSC.hg38.ensGene", \
                                 "TxDb.Mmusculus.UCSC.mm10.knownGene", \
                                 "TxDb.Mmusculus.UCSC.mm10.ensGene"));'

RUN R -e "install.packages(c('seqinr'), repos='http://cran.rstudio.com/')"

#+end_src
***** UCSC
:PROPERTIES:
:ID:       7af192c3-43a8-4c70-8a77-770e3399c56b
:END:
#+begin_src bash

##############################################
###   Select UCSC Command-line utilities   ###
##############################################

RUN mkdir /opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/liftOver --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedClip --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedCommonRegions --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedCoverage --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedExtendRanges --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGeneParts --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGraphPack --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGraphToBigWig --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedIntersect --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedItemOverlapCount --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedJoinTabOffset --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedJoinTabOffset.py --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedMergeAdjacent --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedPartition --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedPileUps --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedRemoveOverlap --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedRestrictToPositions --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedSort --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToBigBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToExons --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigBedSummary --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigBedToBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigAverageOverBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCat --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCluster --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCorrelate --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigInfo --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigMerge --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigSummary --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigToBedGraph --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigToWig --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/#+end_src --directory-prefix=/opt/ucsc \
    && chmod -R +x /opt/ucsc/

ENV PATH="/opt/ucsc:${PATH}"

#+end_src
***** Custom and manual installs
:PROPERTIES:
:ID:       39ea1f36-8644-4cb2-8b85-79dcb9c53b9b
:END:
#+begin_src bash

###########################
###   Custom Installs   ###
###########################

# Multiqc

RUN pip install multiqc

# Flexbar
RUN apt-get install -yq --no-install-recommends --allow-unauthenticated libtbb2
RUN wget https://github.com/seqan/flexbar/releases/download/v3.5.0/flexbar-3.5.0-linux.tar.gz && tar -xzf flexbar-3.5.0-linux.tar.gz && mv flexbar-3.5.0-linux/flexbar /usr/bin/ && mv flexbar-3.5.0-linux/libtbb.so.2 /usr/bin/

# samtools
# https://www.biostars.org/p/9480029/
RUN conda install -c bioconda samtools openssl=1.0

#+end_src
****** Picard
:PROPERTIES:
:ID:       7ccd4dd3-44ff-4796-a6bd-4226eeb482f6
:END:
#+begin_src bash

##################
###   Picard   ###
##################

RUN apt-get install -yq --no-install-recommends --allow-unauthenticated openjdk-8-jdk

#########1#########2#########3#########4#########5#########6#########7#########8
#https://github.com/genome/docker-picard-cwl/commit/639ad8e4d8e7bd7e6e10f193df8d5cd16260d2e2
RUN mkdir /opt/picard-2.18.1/ \
    && cd /tmp/ \
    && wget --no-check-certificate https://github.com/broadinstitute/picard/releases/download/2.18.1/picard.jar \
    && mv picard.jar /opt/picard-2.18.1/ \
    && ln -s /opt/picard-2.18.1 /opt/picard \
    && ln -s /opt/picard-2.18.1 /usr/picard
#########1#########2#########3#########4#########5#########6#########7#########8


#+end_src
***** Development                                                       :dev:
:PROPERTIES:
:header-args: :tangle no
:ID:       0d62ca28-1109-4216-b52a-fd2398462ff0
:END:
- give specific versions for all condas

*** [[file:docker/rna_Dockerfile][RNA docker]]
:PROPERTIES:
:header-args:bash: :tangle ./docker/rna_Dockerfile
:ID:       1338f10d-c3d0-4b29-9c4a-d3a01758a3d2
:END:
**** Preamble
:PROPERTIES:
:ID:       a0c24664-909d-4a9a-9969-dc0181fa478d
:END:
#+begin_src bash
FROM jeszyman/biotools:2.0.0
################################################################################
################################################################################
###                                                                          ###
###         Dockerfile to build an RNA-focused docker image                  ###
###                                                                          ###
################################################################################
################################################################################

#################
###   Notes   ###
#################
#
# After build, the image will be pushed to the dockerhub as
# jeszyman/rna
# (https://hub.docker.com/repository/docker/jeszyman/rna)

#+end_src
**** Conda
:PROPERTIES:
:ID:       39ef57e9-444e-4bf3-a725-c5993baba18f
:END:
#+begin_src bash
RUN conda install -c bioconda kallisto
RUN conda install -c bioconda rsem
RUN conda install -c bioconda star
RUN conda install -c bioconda subread
RUN conda install -c bioconda salmon
#+end_src
**** R and Bioconductor
:PROPERTIES:
:ID:       f8b3b802-b712-4fa8-825b-b1c46f6ae2db
:END:
#+begin_src bash
RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("DESeq2", \
                                 "edgeR", \
                                 "fgsea", \
                                 "limma", \
                                 "tximport"));'

#+end_src
#+begin_src bash
RUN R -e "install.packages(c('statmod', repos='http://cran.rstudio.com/'))"

#+end_src
**** Custom installs
:PROPERTIES:
:ID:       27532517-1a70-498d-85f1-998ef98eb72f
:END:
#+begin_src bash
RUN cd /opt && git clone https://github.com/rajewsky-lab/mirdeep2 && cd /opt/mirdeep2 && perl install.pl

RUN /bin/bash

RUN cd /opt/mirdeep2 && perl install.pl

ENV PATH="/opt/mirdeep2/bin:${PATH}"
#+end_src
*** [[file:docker/atac_Dockerfile][ATAC-seq docker]]
:PROPERTIES:
:header-args:bash: :tangle ./docker/atac_Dockerfile :tangle-mode (identity #o555)
:ID:       57458bd3-005f-4342-ada7-58c55a74d7d0
:END:
:LOGBOOK:
CLOCK: [2022-08-30 Tue 11:43]--[2022-08-30 Tue 11:57] =>  0:14
:END:
**** Preamble
:PROPERTIES:
:ID:       bd4c729f-9ddb-4006-89c9-21a93c9a055c
:END:
#+begin_src bash
FROM jeszyman/biotools:1.0.2
#########1#########2#########3#########4#########5#########6#########7#########8
###                                                                          ###
###                  Dockerfile for ATAC-seq Related Software                ###
###                                                                          ###
#########1#########2#########3#########4#########5#########6#########7#########8

#################
###   Notes   ###
#################

# After build, the image will be pushed to dockerhub as jeszyman/atac
# (https://hub.docker.com/repository/docker/jeszyman/atac)

#+end_src
**** Apt
:PROPERTIES:
:ID:       ed99ab4e-ac9d-4922-8740-b5e27f5aecc3
:END:
#+begin_src bash

###############
###   APT   ###
###############

# Update
RUN apt-get -y update && apt-get upgrade -y

# Linux prerequisites for ATACseqQC
RUN apt-get install -yq --no-install-recommends --allow-unauthenticated --fix-missing \
    libgsl-dev \
    libcurl4-openssl-dev
#+end_src
**** Conda
:PROPERTIES:
:ID:       4c6f0e77-2a6a-49a8-a8df-dbc8db3d95ae
:END:
#+begin_src bash
#################
###   Conda   ###
#################

RUN conda install -c bioconda macs2

#+end_src
**** R and bioconductor
:PROPERTIES:
:ID:       68797c07-6e37-4541-b165-259a9dfc0b73
:END:
#+begin_src bash
##############################
###   R and Bioconductor   ###
##############################

# CRAN
RUN R -e "install.packages(c('statmod', repos='http://cran.rstudio.com/'))"

# Bioconductor
RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("ATACseqQC", \
                                 "ChIPpeakAnno", \
                                 "ChIPseeker", \
                                 "clusterProfiler", \
                                 "csaw"));'

#+end_src
**** Custom installs
:PROPERTIES:
:ID:       01a1101b-2ab9-4f35-a4eb-e0ccc66d5f9f
:END:
#+begin_src bash
###########################
###   Custom Installs   ###
###########################

# Homer
RUN mkdir /opt/homer
RUN cd /opt/homer
RUN wget http://homer.ucsd.edu/homer/configureHomer.pl -O /opt/homer/configureHomer.pl
RUN perl /opt/homer/configureHomer.pl -install
ENV PATH="${PATH}:/opt/homer/bin/"
RUN perl /opt/homer/.//configureHomer.pl -install mouse-p

#+end_src
****                                                                    :dev:
:PROPERTIES:
:ID:       8ca09b94-1a93-4278-95c4-c5fc9b1f20e9
:END:
get updated bowtie 2 with multithread indexing (>2.2.6?)
https://www.biostars.org/p/219541/

*** Truseq small adapters
:PROPERTIES:
:ID:       64c20056-5f58-4996-8216-1815427a7bc9
:END:
- supercite:illumina2016truseq_small
** Technologies, kits, etc
:PROPERTIES:
:ID:       77578ae9-3d05-4971-b7f1-c278c75b5be3
:END:
*** Truseq RNA Exome
:PROPERTIES:
:ID:       5fe9c572-c692-4aad-bb48-8b2fb2b86760
:END:
- [[cite:&larson2021]]
- [[https://www.illumina.com/products/by-type/sequencing-kits/library-prep-kits/truseq-rna-access.html][Illumina link]]
  - TruSeq RNA Exome kit (Illumina, 20020189) 2x @ 2480
  - enrichments 2x @ 2995
  - indexes 2x @ 250
** Scripts                                                        :hierarchy:
:PROPERTIES:
:ID:       4a96e859-6175-4db4-a75b-6d35fbb37433
:END:
*** Bash helper scripts [[file:tools/shell/]]
:PROPERTIES:
:ID:       4f25b13b-9d9c-417c-9c5c-567caf3cae75
:END:
**** Built docker container
:PROPERTIES:
:ORDERED:  t
:ID:       ef485b0c-90af-4295-8e53-a4149cb179af
:END:
#+begin_src bash :tangle ./tools/shell/docker_build.sh
#!/usr/bin/env bash

set -o errexit   # abort on nonzero exitstatus
set -o nounset   # abort on unbound variable
set -o pipefail  # don't hide errors within pipes

print_usage(){
    cat <<- EOF

###################################################
###   Docker and Singularity Building Command   ###
###################################################

Steps
1) Builds docker container
2) Pushes container to dockerhub
3) Builds singularity file
4) Pushes singularity file to box

usage: docker_build.sh [options] <DOCKER FILE> <DOCKER TAG> [OPTIONAL - DOCKER BUILD LOC]
  options:
    -n  No cache, use for validation of full build
    -s  A sif directory location
    -v  Docker version, a version appended to docker and singularity tags
        Note: adding a version will push the singularity build to
        shared/singularity-containers/stable

example:

docker_build.sh -n -s ~/sing_containers -v 2.0.0 ~/dockerfiles/atac_Dockerfile jeszyman/atac ~/docker_bulid_dir

EOF
}

# Setup options
while getopts "nt:v:s:" options;
do
    case "${options}" in
        n) usecache="--no-cache" ;;
        v) version=${OPTARG} ;;
        s) sifdir=${OPTARG} ;;
        h | *) print_usage; exit 0 ;;
    esac
done

shift $((OPTIND -1))

[[ $# -eq 0 ]] && print_usage && exit 1

# Scipt variables
dockerfile=$1
tag=$2
if [ -z ${usecache+x} ]; then usecache="cache"; fi
dockerloc="${3:-.}"

main(){
    # Build and push docker container. Append version if provided.
    printf "\nBuilding Docker container now...\n "
    sleep 2s
    if [ -z ${version+x} ]
    then
        build_docker $dockerfile $tag $dockerloc $usecache
        printf "\nPushing docker container to dockerhub...\n "
        docker push $tag
    else
        build_docker $dockerfile "${tag}:${version}" $dockerloc $usecache
        printf "\nPushing docker container to dockerhub...\n "
        docker push $tag:$version
    fi

    # Build and push sif if provided.

    if [ -z ${sifdir+x} ];
    then
        sleep 2s
        printf "\n-s flag is unset, nothing more to do.\n "
    else
        dockertag="$tag"
        if [ -z ${version+x} ];
        then
            siftag=$(echo $tag | sed 's/^.*\///g')
            target="shared/singularity-containers/most-recent/"
        else
            presiftag=$(echo $tag | sed 's/^.*\///g')
            siftag="${presiftag}.${version}"
            target="shared/singularity-containers/stable/"
        fi

        printf "\nBuilding Singularity container now...\n"

        build_singularity $sifdir \
                          $siftag \
                          $dockertag

        sleep 2s
        echo "build_singularity $sifdir $siftag $dockertag"
        printf "\nLocal Singularity build complete.\nPushing singularity to box...\n"

        push_singularity $sifdir \
                         $siftag \
                         $target

    fi
}

# main(){


#     # Build and push sif if provided.

#     if [ -z ${sifdir+x} ];

#     then
#         sleep 2s
#         printf "\n-s flag is unset, nothing more to do.\n "
#     else
#         dockertag="$tag"
#         if [ -z ${version+x} ];
#         then
#             siftag="$tag"
#             target="shared/singularity-containers/most-recent"
#         else
#             siftag="${tag}.${version}"
#             target="shared/singularity-containers/stable"
#         fi
#         printf "\nBuilding Singularity container now...\n"
#         sleep 2s
#         build_singularity $sifdir \
#                           $siftag \
#                           $dockertag
#         printf "\nLocal Singularity build complete.\nPushing singularity to box...\n"
#         push_singularity $sifdir \
#                          $siftag \
#                          $target
#     fi
# }

build_docker(){
    local dockerfile="${1}"
    local dockertag="${2}"
    local dockerloc="${3}"
    if [ $4 == "--no-cache" ];
    then
        docker build \
               --file $dockerfile $4 \
               --pull \
               --tag $dockertag \
               $dockerloc
    else
        docker build \
               --file $dockerfile \
               --pull \
               --tag $dockertag \
               $dockerloc
    fi
}

push_docker(){
    local dockertag="${1}"
    docker push $dockertag
}

build_singularity(){
    local sifdir="${1}"
    local siftag="${2}"
    local dockertag="${3}"
    singularity pull \
                --force \
                "${sifdir}/${siftag}.sif" \
                "docker://${dockertag}"
}

push_singularity(){
    local sifdir="${1}"
    local siftag="${2}"
    local target="${3}"
    rclone copy \
           --update \
           --verbose \
           "${sifdir}/${siftag}.sif" remote:"${target}"
}

main "$@"

#+end_src

*****                                                                   :ref:
:PROPERTIES:
:ID:       8c3895c8-167b-48e9-8ab9-b47022147199
:END:
- https://github.com/orgs/genome/repositories?type=all
*****                                                                   :dev:
:PROPERTIES:
:ID:       6c5f1a6a-0cb5-4c23-9615-0c9cc480aea1
:END:
- old mpnst dockerfile
  #+begin_src bash
FROM jeszyman/biotools
#########1#########2#########3#########4#########5#########6#########7#########8

##############################################
###      Dockerfile for MPNST Projects     ###
##############################################

# After build, this image will be pushed to dockerhub as jeszyman/mpnst.
#  See (https://hub.docker.com/repository/docker/jeszyman/mpnst)

#
RUN cd /opt && \
    git clone https://github.com/shahcompbio/hmmcopy_utils.git && \
    cd hmmcopy_utils && \
    cmake . && \
    make

#
# ichorCNA
##
## linux dependencies
RUN apt-get update \
   && apt-get install -y \
   libcurl4-openssl-dev \
   libssl-dev \
   libxml2-dev
#RUN rm /usr/lib/x86_64-linux-gnu/libcurl.so.4
#RUN ln -s /usr/lib/x86_64-linux-gnu/libcurl.so.4.5.0 /usr/lib/x86_64-linux-gnu/libcurl.so.4
##
## R dependencies
RUN R -e 'install.packages("BiocManager"); BiocManager::install(); BiocManager::install("HMMcopy"); BiocManager::install("GenomeInfoDb"); BiocManager::install("GenomicRanges");'
##
## git clone install
RUN cd /opt \
    && git clone https://github.com/broadinstitute/ichorCNA.git \
    && cd ichorCNA \
    && R CMD INSTALL . \
    && cd /opt
##
#+end_src
- ...rebuild local sing and add checker
- [ ] sing builds to box
- [ ] move all docker to single repo

***:dev:
**** Run functions
:PROPERTIES:
:ID:       a18668ce-b704-4178-b465-63f22b511752
:END:
- run docker interactively
  #+name: docker_interactive
  #+begin_src bash
docker_interactive() {
    if [ -f /.dockerenv ]; then
        echo "shell already in docker, exiting"
        exit 1
    else
        account="USER INPUT"
        container="USER INPUT"
        read -p "docker account name: " account
        account="${account:=jeszyman}"
        read -p "container name: " container
        container="${container:=biotools}"
        case $HOSTNAME in
            (radonc-cancerbio) docker run -it \
                                      --env HOME=${HOME} \
                                      --hostname ${HOSTNAME} \
                                      --user $(id -u ${USER}) \
                                      --volume /home/:/home/ \
                                      --volume /mnt/:/mnt/ \
                                      --volume /tmp/:/tmp/ \
                                      $account/$container \
                                      /bin/bash;;
            (acl*) docker run -it \
                          --env HOME=${HOME} \
                          --hostname ${HOSTNAME} \
                          -v /drive3/:/drive3/ \
                          -v /duo4/:/duo4/ \
                          -v /home/:/home/ \
                          -v /tmp/:/tmp/ \
                          -u $(id -u ${USER}) \
                          $account/$container \
                          /bin/bash;;
            (ACL*) docker run -it \
                          --env HOME=${HOME} \
                          --hostname ${HOSTNAME} \
                          -v /home/:/home/ \
                          -v /duo4/:/duo4/ \
                          -u $(id -u ${USER}):$(id -g ${USER}) \
                          $account/$container \
                          /bin/bash;;
            (virtual-workstation*.gsc.wustl.edu) bsub -Is -q docker-interactive -a 'docker($account/'"$container"')' /bin/bash;;
            (*) docker run -it \
                       --env HOME=/home/${USER} \
                       --hostname ${HOSTNAME} \
                       --user $(id -u ${USER}) \
                       --volume /home/:/home/ \
                       --volume /mnt/:/mnt/ \
                       --volume /tmp/:/tmp/ \
                       $account/$container \
                       /bin/bash;;
        esac
    fi
}
#+end_src
**** [[*Built docker container][Built docker container]]
:PROPERTIES:
:ID:       187fbe7f-af38-449f-b2d6-3cb002abadc3
:END:
*** Make singularity container
:PROPERTIES:
:ID:       bacbf11a-5717-4af5-82b2-d12c70c94104
:END:
#+begin_src bash
#!/usr/bin/env bash
#
###   SCRIPT NAME   ###
#

# Notes
# ...

# Setup

set -e # enable exit on error
set -u # unset variables are errors
set -o pipefail # failures can occur anywhere in pipeline

# Variables

readonly blah=$1
blue=$(tput setaf 4)

# Functions

usage()
{
    printf "
           ${blue}Script to do blah \n
    usage:  blah\n
"
    exit 1
}

main()
{
    [[ $# -ne 2 ]] && usage
    echo "$blah"
    normal=$(tput sgr0)
    printf "%40s\n" "${blue}This text is bluenormal"
}

# Run

main "$@"
#+end_src

#+begin_src bash
singularity pull /mnt/ris/aadel/jeszyman/sing_containers/biotools.sif docker://jeszyman/biotools
#+end_src
https://pubs.rsc.org/en/content/articlelanding/2020/cs/d0cs00647e
*** Setup common reference files
:PROPERTIES:
:ID:       813ed980-1c55-44d7-84d8-67afdad2e5bc
:END:
  #+name: setup_common_references
  #+begin_src bash
#
# Setup
/bin/bash
alias wget_common=wget --noclobber
refdata=
#
# Download reference genomes
## Human
### UCSC Hg38
wget_common https://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz -O $refdata/hg38.fa.gz
### Ensembl
#### TopLevel
wget_common ftp://ftp.ensembl.org/pub/release-102/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.toplevel.fa.gz -O $refdata/Homo_sapiens.GRCh38.dna.toplevel.fa.gz
#### Primary assembly
wget --no-clobber ftp://ftp.ensembl.org/pub/release-102/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz -O $refdata/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
##
## Rattus norvegicus
### UCSC
wget_common ftp://hgdownload.cse.ucsc.edu/goldenPath/rn6/bigZips/rn6.fa.gz -O $refdata/rn6.fa.gz
### Ensembl
#### TopLevel
wget_common ftp://ftp.ensembl.org/pub/release-102/fasta/rattus_norvegicus/dna/Rattus_norvegicus.Rnor_6.0.dna.toplevel.fa.gz -O $refdata/Rattus_norvegicus.Rnor_6.0.dna.toplevel.fa.gz
#### NOTE: No Rattus primary assembly
#### cDNA
wget_common ftp://ftp.ensembl.org/pub/release-102/fasta/rattus_norvegicus/cdna/Rattus_norvegicus.Rnor_6.0.cdna.all.fa.gz -O /home/jeszyman/data/Rattus_norvegicus.Rnor_6.0.cdna.all.fa.gz
gunzip /home/jeszyman/data/Rattus_norvegicus.Rnor_6.0.cdna.all.fa.gz
#### GTF
wget_common ftp://ftp.ensembl.org/pub/release-102/gtf/rattus_norvegicus/Rattus_norvegicus.Rnor_6.0.102.gtf.gz -O /home/jeszyman/data/Rattus_norvegicus.Rnor_6.0.102.gtf.gz
#
# Unzip
for file in $refdata/*.fa.gz $refdata/*.gtf.gz;
do
    gunzip_common $file
done
#

#########1#########2#########3#########4#########5#########6#########7#########8
# ideas
#in/out from csv
# get readmes
#########1#########2#########3#########4#########5#########6#########7#########8
#+end_src
*** subsample_bam.py
:PROPERTIES:
:ID:       d21f49c7-7c4a-4126-aad8-3d4360ef84e2
:END:
[[file:scripts/subsample_bam.py]]

#+begin_src python :tangle ./scripts/subsample_bam.py :tangle-mode (identity #o755) :comments no
#!/usr/bin/env python3
"""
Script to use samtools to downsample a BAM file.

This script takes a BAM file and downsamples it to a specified target size in megabytes.
The downsampled BAM file will be saved in the specified target directory, with a name
indicating the original file name and the downsampled size.

If the target directory is not specified, the output will be saved in the directory
where the script is run.

A subsample seed is used to influence which subset of reads is kept. The seed is
randomly generated unless specified by the user. If subsampling data that has
previously been subsampled, be sure to use a different seed value from those used
previously to avoid retaining more reads than expected.

Example usage:
    python3 script.py --bam_file path/to/file.bam --target_mb 30 --target_dir /path/to/output/ --subsample_seed 42
"""

# ---   Load Packages   --- #
# ------------------------- #

import argparse
import os
import logging
import sh
import sys
import random

# ---   Load Inputs   --- #
# ----------------------- #

def load_inputs():
    parser = argparse.ArgumentParser(description=__doc__)
    parser.add_argument("--bam_file", type=str, required=True, help="Path to BAM file")
    parser.add_argument("--target_mb", type=int, required=True, help="Target size of the output BAM file in megabytes")
    parser.add_argument("--target_dir", type=str, required=False, help="Target directory to write downsampled BAM file to")
    parser.add_argument("--output_name", type=str, required=False, help="Custom name for the output BAM file")
    parser.add_argument("--subsample_seed", type=int, required=False, help="Subsampling seed used to influence which subset of reads is kept")

    args = parser.parse_args()

    if not os.path.exists(args.bam_file):
        raise FileNotFoundError(f"Input BAM file not found: {args.bam_file}")

    # Set target_dir to the directory where the script is run if not provided
    if args.target_dir is None:
        args.target_dir = os.getcwd()

    # Generate a random seed if not provided
    if args.subsample_seed is None:
        args.subsample_seed = random.randint(1, 1000000)

    return args

# ---   Main   --- #
# ---------------- #

def main():
    try:
        args = load_inputs()

        # Calculate fraction and confirm with the user if it's at the minimum
        fraction, actual_target_mb = calculate_fraction(args.bam_file, args.target_mb)

        if fraction == 0.01:
            print(f"Warning: The minimum allowed fraction is 0.01, which corresponds to {actual_target_mb} MB.")
            proceed = input("Do you want to proceed with this minimum allowed fraction? (yes/no): ")
            if proceed.lower() != 'yes':
                print("Operation aborted by the user.")
                return 1

        # Generate the target BAM file name
        target_bam = generate_target_bam_name(args.bam_file, actual_target_mb, args.target_dir, args.output_name)
        logging.info(f"Target BAM file path: {target_bam}")

        # Check if the target file already exists and confirm overwrite
        if os.path.exists(target_bam):
            overwrite = input(f"{target_bam} already exists. Overwrite? (yes/no): ")
            if overwrite.lower() != 'yes':
                print("Operation aborted by the user.")
                return 1

        # Perform the downsampling
        downsample_bam(args.bam_file, fraction, target_bam, args.subsample_seed)
        return 0
    except Exception as e:
        logging.error(f"An error occurred: {str(e)}")
        return 1

# ---   Functions   --- #
# --------------------- #

def calculate_fraction(original_bam, target_mb):
    logging.info(f"Calculating fraction for {original_bam} targeting {target_mb} MB.")
    # Get the original BAM file size in MB using sh package
    original_size_mb = int(sh.du("-m", original_bam).split()[0])
    logging.info(f"Original BAM file size: {original_size_mb} MB.")

    # Calculate the fraction to subsample
    fraction = round(target_mb / original_size_mb, 2)
    logging.info(f"Calculated fraction: {fraction}")

    # Ensure the fraction is not lower than 0.01
    if fraction < 0.01:
        fraction = 0.01
        logging.warning(f"Fraction adjusted to minimum allowed value: {fraction}")
    actual_target_mb = round(original_size_mb * fraction, 2)

    return fraction, actual_target_mb

def generate_target_bam_name(original_bam, target_mb, target_dir, custom_name=None):
    if custom_name:
        # Use the custom name, but ensure it has a .bam extension
        base_name = os.path.splitext(custom_name)[0]
        target_bam = os.path.join(target_dir, f"{base_name}.bam")
    else:
        # Use the original naming scheme
        bam_filename = os.path.basename(original_bam)
        base_filename = os.path.splitext(bam_filename)[0]
        target_bam = os.path.join(target_dir, f"{base_filename}_ds{int(target_mb)}mb.bam")

    logging.info(f"Generated target BAM name: {target_bam}")
    return target_bam

def downsample_bam(original_bam, fraction, target_bam, subsample_seed):
    logging.info(f"Starting downsampling with fraction {fraction} and seed {subsample_seed}.")

    # Run the samtools command to subsample using sh package
    with open(target_bam, 'wb') as f:
        try:
            sh.samtools.view("-bs", str(fraction), "--subsample-seed", str(subsample_seed), original_bam, _out=f)
            logging.info(f"Subsampling complete: {target_bam} created.")
        except Exception as e:
            logging.error(f"Error during downsampling: {str(e)}")
            raise

# ---   Main Guard   --- #
# ---------------------- #

if __name__ == "__main__":
    logging.basicConfig(level=logging.INFO)
    sys.exit(main())

#+end_src

#+begin_src bash
conda install -n biotools -c conda-forge sh

python3 ~/repos/biotools/scripts/subsample_bam.py -h

python3 /tmp/test.py --bam_file /mnt/data/projects/pnst/bams/lib180_ds10.bam --target_mb 1 --target_dir /tmp

python3 /tmp/test.py --bam_file /mnt/data/projects/pnst/bams/lib180_ds10.bam --target_mb 1 --target_dir /tmp --output_name test2.bam

python3 /tmp/test.py --bam_file /mnt/data/projects/pnst/bams/lib180_ds10.bam --target_mb 1 --target_dir /tmp --output_name test3.bam --subsample_seed 43
#+end_src

** My bioinformatics pipelines
:PROPERTIES:
:ID:       f7ffad85-74e4-4bc1-a720-2a1cc06ca135
:END:
*** meth seq
:PROPERTIES:
:ID:       3e29841f-53a2-4fdb-9f3b-66f6ce92efbd
:END:

****** Preamble
:PROPERTIES:
:ID:       0000d7a3-4d8f-41a9-be1b-83ff0edc16a4
:END:
#+begin_src bash
<<<<<<< HEAD
FROM jeszyman/basecamp
################################################################################
################################################################################
###                                                                          ###
###         Dockerfile to build a basic bioinformatics docker image          ###
###                                                                          ###
################################################################################
################################################################################

#################
###   Notes   ###
#################
#
# After build, the image will be pushed to the dockerhub as
# jeszyman/biotools
# (https://hub.docker.com/repository/docker/jeszyman/atac)

#+end_src
****** Conda
:PROPERTIES:
:ID:       e3541780-fdff-4972-89a2-1fe8b613a336
:END:
#+begin_src bash

#################
###   Conda   ###
#################

RUN conda install -c bioconda bbmap \
    && conda install -c bioconda bcftools \
    && conda install -c bioconda bedops \
    && conda install -c bioconda bedtools \
    && conda install -c bioconda bowtie \
    && conda install -c bioconda bowtie2 \
    && conda install -c bioconda bwa \
    && conda install -c bioconda cutadapt \
    && conda install -c bioconda deeptools=3.5.1 --force \
    && conda install -c bioconda fastp \
    && conda install -c bioconda fastqc \
    && conda install -c bioconda gatk \
    && conda install -c bioconda goleft \
    && conda install -c bioconda htseq \
    && conda install -c bioconda mosdepth \
    && conda install -c bioconda preseq \
    && conda install -c bioconda pysam \
    && conda install -c bioconda qualimap \
    && conda install -c bioconda sambamba \
    && conda install -c bioconda samblaster \
    && conda install -c bioconda samtools=1.7 \
    && conda install -c bioconda seqkit \
    && conda install -c bioconda seqtk \
    && conda install -c bioconda skewer \
    && conda install -c bioconda snakemake \
    && conda install -c bioconda trimmomatic=0.39 \
    && conda install -c bioconda vcftools

#+end_src
****** R and Bioconductor
:PROPERTIES:
:ID:       d2e83290-a47a-4531-a46c-f5ffdaeca88a
:END:
#+begin_src bash
# To avoid conflict with jeszyman/basecamp R install
#RUN conda uninstall r-base


##########################
###   R Bioconductor   ###
##########################

RUN R -e "install.packages('BiocManager', repos='http://cran.rstudio.com/')"

RUN R -e "BiocManager::install(version='3.15', update=TRUE, ask=FALSE)"

RUN R -e 'install.packages("BiocManager"); \
          BiocManager::install(); \
          BiocManager::install(c("AnnotationDbi",\
                                 "apeglm"
                                 "BiocParallel", \
                                 "BSgenome.Hsapiens.UCSC.hg19", \
                                 "ComplexHeatmap", \
                                 "EnsDb.Mmusculus.v79", \
                                 "org.Mm.eg.db", \
                                 "readr", \
                                 "Rsamtools", \
                                 "TxDb.Mmusculus.UCSC.mm10.ensGene"));'

#+end_src
****** UCSC
:PROPERTIES:
:ID:       b3ff92c8-4ad1-417e-849e-5763ae177705
:END:
#+begin_src bash

##############################################
###   Select UCSC Command-line utilities   ###
##############################################

RUN mkdir /opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/liftOver --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedClip --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedCommonRegions --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedCoverage --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedExtendRanges --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGeneParts --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGraphPack --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedGraphToBigWig --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedIntersect --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedItemOverlapCount --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedJoinTabOffset --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedJoinTabOffset.py --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedMergeAdjacent --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedPartition --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedPileUps --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedRemoveOverlap --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedRestrictToPositions --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedSort --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToBigBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToExons --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigBedSummary --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigBedToBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigAverageOverBed --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCat --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCluster --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigCorrelate --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigInfo --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigMerge --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigSummary --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigToBedGraph --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bigWigToWig --directory-prefix=/opt/ucsc \
    && wget --no-parent --no-directories https://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/#+end_src --directory-prefix=/opt/ucsc \
    && chmod -R +x /opt/ucsc/

ENV PATH="/opt/ucsc:${PATH}"

#+end_src
****** Custom and manual installs
:PROPERTIES:
:ID:       02a433eb-1789-4753-9fca-0d597f39e8ec
:END:
#+begin_src bash

###########################
###   Custom Installs   ###
###########################

# Multiqc

RUN pip install multiqc

# Flexbar
RUN apt-get install -yq --no-install-recommends --allow-unauthenticated libtbb2
RUN wget https://github.com/seqan/flexbar/releases/download/v3.5.0/flexbar-3.5.0-linux.tar.gz && tar -xzf flexbar-3.5.0-linux.tar.gz && mv flexbar-3.5.0-linux/flexbar /usr/bin/ && mv flexbar-3.5.0-linux/libtbb.so.2 /usr/bin/

# samtools
# https://www.biostars.org/p/9480029/
RUN conda install -c bioconda samtools openssl=1.0

#+end_src
******* Picard
:PROPERTIES:
:ID:       80b9ee62-0c96-4746-9ccc-71e13ef62683
:END:
#+begin_src bash

##################
###   Picard   ###
##################

RUN apt-get install -yq --no-install-recommends --allow-unauthenticated openjdk-8-jdk

#########1#########2#########3#########4#########5#########6#########7#########8
#https://github.com/genome/docker-picard-cwl/commit/639ad8e4d8e7bd7e6e10f193df8d5cd16260d2e2
RUN mkdir /opt/picard-2.18.1/ \
    && cd /tmp/ \
    && wget --no-check-certificate https://github.com/broadinstitute/picard/releases/download/2.18.1/picard.jar \
    && mv picard.jar /opt/picard-2.18.1/ \
    && ln -s /opt/picard-2.18.1 /opt/picard \
    && ln -s /opt/picard-2.18.1 /usr/picard
#########1#########2#########3#########4#########5#########6#########7#########8


#+end_src
****** Development                                                      :dev:
:PROPERTIES:
:ID:       78b43b10-8991-43f9-abba-b4a7f66ae0ce
:END:
:PROPERTIES:
:header-args: :tangle no

*** [[file:~/repos/exrna/exrna.org][exRNA]]
:PROPERTIES:
:ID:       0db7b19a-179e-4c3e-95b3-0bc47ffaf35a
:END:
:LOGBOOK:
CLOCK: [2022-06-08 Wed 14:22]--[2022-06-08 Wed 14:44] =>  0:22
CLOCK: [2022-06-08 Wed 13:41]--[2022-06-08 Wed 13:59] =>  0:18
:END:
*** [[file:~/repos/cappseq/cappseq.org][CAPP-seq]]
:PROPERTIES:
:ID:       6f38f1c8-6e61-42cb-8e78-634f1598a42e
:END:
:LOGBOOK:
CLOCK: [2022-06-07 Tue 08:19]--[2022-06-07 Tue 08:21] =>  0:02
CLOCK: [2022-04-29 Fri 09:12]--[2022-04-29 Fri 10:00] =>  0:48
CLOCK: [2022-04-26 Tue 08:34]--[2022-04-26 Tue 09:08] =>  0:34
CLOCK: [2022-04-26 Tue 12:00]--[2022-04-26 Tue 13:31] =>  1:31
CLOCK: [2022-04-26 Tue 09:51]--[2022-04-26 Tue 10:10] =>  0:19
:END:
*** [[file:~/repos/cfdna-wgs/cfdna-wgs.org][cfDNA WGS biopipe]]
:PROPERTIES:
:ID:       13120759-71db-497c-8ed3-1c58e47a7840
:END:
:LOGBOOK:
CLOCK: [2022-05-04 Wed 08:12]--[2022-05-04 Wed 08:16] =>  0:04
CLOCK: [2022-05-03 Tue 10:19]--[2022-05-03 Tue 11:04] =>  0:45
CLOCK: [2022-05-03 Tue 09:46]--[2022-05-03 Tue 10:15] =>  0:29
CLOCK: [2022-04-29 Fri 10:34]--[2022-04-29 Fri 10:56] =>  0:22
CLOCK: [2022-06-27 Mon 11:13]--[2022-06-27 Mon 13:40] =>  2:27
CLOCK: [2022-06-27 Mon 09:11]--[2022-06-27 Mon 10:47] =>  1:36
CLOCK: [2022-06-27 Mon 07:07]--[2022-06-27 Mon 09:11] =>  2:04
CLOCK: [2022-06-24 Fri 08:02]--[2022-06-24 Fri 10:19] =>  2:17
CLOCK: [2022-06-23 Thu 10:20]--[2022-06-23 Thu 11:18] =>  0:58
CLOCK: [2022-06-16 Thu 12:48]--[2022-06-16 Thu 13:42] =>  0:54
CLOCK: [2022-06-16 Thu 08:08]--[2022-06-16 Thu 08:39] =>  0:31
CLOCK: [2022-06-07 Tue 08:29]--[2022-06-07 Tue 10:56] =>  2:27
CLOCK: [2022-06-02 Thu 08:38]--[2022-06-02 Thu 08:40] =>  0:02
CLOCK: [2022-05-31 Tue 11:03]--[2022-05-31 Tue 12:44] =>  1:41
:END:
**** frag
:PROPERTIES:
:ID:       77a46d43-7ebe-403d-b004-a9689d1ed57f
:END:
:LOGBOOK:
CLOCK: [2022-04-29 Fri 13:52]--[2022-04-29 Fri 14:07] =>  0:15
CLOCK: [2022-04-29 Fri 11:17]--[2022-04-29 Fri 11:40] =>  0:23
CLOCK: [2021-12-07 Tue 08:55]--[2021-12-07 Tue 09:08] =>  0:13
:END:
*** [[file:~/repos/atac-seq/atac_seq.org][ATAC-seq biopipe]]
:PROPERTIES:
:ID:       d497b518-94d2-489a-a1f6-a602b8ca73af
:END:
:LOGBOOK:
CLOCK: [2022-08-29 Mon 12:18]--[2022-08-29 Mon 13:00] =>  0:42
CLOCK: [2022-05-01 Sun 12:17]--[2022-05-01 Sun 13:47] =>  1:30
CLOCK: [2021-12-09 Thu 12:47]--[2022-05-01 Sun 13:57] => 3432:10
:END:
*** cfDNA WGS fragmentomics biopipe
:PROPERTIES:
:ID:       fe0bdafc-8bdb-4c9a-9760-ea1242d6d14f
:END:
:LOGBOOK:
CLOCK: [2022-08-31 Wed 08:20]--[2022-08-31 Wed 09:11] =>  0:51
:END:
*** See [[id:271b4d5f-727e-496e-b835-8fe9f8655655][Bioinformatics project module]]
:PROPERTIES:
:ID:       da883d31-d1cb-44ef-b527-8b517a37ba52
:END:
** Organizations
*** National Cancer Institute (NCI)
:PROPERTIES:
:ID:       b6752449-050b-4349-a103-fde3a87b0fc1
:END:
**** NCI Cancer Research Data Commons
:PROPERTIES:
:ID:       8d60abc7-07e0-4263-8ec2-de3e810cb029
:END:
https://datacommons.cancer.gov/support-crdc-cloud-resources
https://datacommons.cancer.gov/
***** ISB Cancer Gateway in the Cloud (ISB-CGC)
:PROPERTIES:
:ID:       cc8ecad2-1a98-49bc-aeb8-6ce6658905bd
:END:
- https://cloud.google.com/customers/nci-nih
- https://isb-cgc.appspot.com/
***** Imaging Data Commons (IDC)
:PROPERTIES:
:ID:       f7651553-d983-4ff5-828d-339e32c9fda1
:END:
https://portal.imaging.datacommons.cancer.gov/about/
[[cite:&fedorov2021]]
https://github.com/ImagingDataCommons
***** Cancer Genomics Cloud (CGC)
:PROPERTIES:
:ID:       1c0828de-ce18-46d8-9303-7b2dc1ca93e7
:END:
[[cite:&reynolds2017]]
https://docs.cancergenomicscloud.org/docs/collaborating-on-the-cgc-a-guide-for-consortia

** Ideas
#+begin_src python :tangle no
import ssl
import urllib.request

# Create an unverified SSL context
ssl._create_default_https_context = ssl._create_unverified_context

url = "https://example.com"
response = urllib.request.urlopen(url)
html = response.read()
print(html)

from Bio import Entrez

# Function to get PMID from a title
def fetch_pmid(title):
    Entrez.email = "your_email@example.com"  # Always include your email when using Entrez API
    handle = Entrez.esearch(db="pubmed", term=title, retmax=1)
    record = Entrez.read(handle)
    handle.close()
    pmid_list = record.get("IdList", [])
    return pmid_list[0] if pmid_list else None

# Example list of titles
titles = [
    "Incidence and Mortality of Neurofibromatosis: A Total Population Study in Finland",
    "Susceptible Stages in Schwann Cells for NF1-Associated Plexiform Neurofibroma Development"
    # Add more titles here
]

titles = [
    "Incidence and Mortality of Neurofibromatosis: A Total Population Study in Finland",
    "Susceptible Stages in Schwann Cells for NF1-Associated Plexiform Neurofibroma Development",
    "Histopathologic evaluation of atypical neurofibromatous tumors and their transformation into malignant peripheral nerve sheath tumor in patients with neurofibromatosis 1—a consensus overview",
    "Malignant peripheral nerve sheath tumor: models, biology, and translation",
    "Low mutation burden and frequent loss of CDKN2A/B and SMARCA2, but not PRC2, define premalignant neurofibromatosis type 1–associated atypical neurofibromas",
    "International consensus statement on malignant peripheral nerve sheath tumors in neurofibromatosis",
    "Malignant peripheral nerve sheath tumor: analysis of treatment outcome",
    "Prognosis and risk factors for malignant peripheral nerve sheath tumor: a systematic review and meta-analysis",
    "Combined-modality treatment of localized soft tissue sarcomas of the extremities",
    "Current Treatment Options for Malignant Peripheral Nerve Sheath Tumors",
    "A nationwide cohort study on treatment and survival in patients with malignant peripheral nerve sheath tumours",
    "The role of radiotherapy in the management of malignant peripheral nerve sheath tumors: a single-center retrospective cohort study",
    "Chemotherapy for the treatment of malignant peripheral nerve sheath tumors in neurofibromatosis 1: a 10-year institutional review",
    "Longitudinal evaluation of peripheral nerve sheath tumors in neurofibromatosis type 1: growth analysis of plexiform neurofibromas and distinct nodular lesions",
    "Unmasking Intra-Tumoral Heterogeneity and Clonal Evolution in NF1-MPNST",
    "Integrative Analysis Identifies Candidate Tumor Microenvironment and Intracellular Signaling Pathways that Define Tumor Heterogeneity in NF1",
    "Strategies for monitoring and combating resistance to combination kinase inhibitors for cancer therapy",
    "Targeted therapy: resistance and re-sensitization",
    "How Compensatory Mechanisms and Adaptive Rewiring Have Shaped Our Understanding of Therapeutic Resistance in Cancer",
    "Dynamic Reprogramming of the Kinome in Response to Targeted MEK Inhibition in Triple-Negative Breast Cancer",
    "Kinome Profiling of NF1-Related MPNSTs in Response to Kinase Inhibition and Doxorubicin Reveals Therapeutic Vulnerabilities",
    "Chromosome 8 gain is associated with high-grade transformation in MPNST",
    "Cell-free DNA ultra-low-pass whole genome sequencing to distinguish malignant peripheral nerve sheath tumor (MPNST) from its benign precursor lesion: A cross-sectional study",
    "Enhanced detection of circulating tumor DNA by fragment size analysis",
    "Genome-wide cell-free DNA fragmentation in patients with cancer",
    "Detection and characterization of lung cancer using cell-free DNA fragmentomes",
    "Plasma DNA End-Motif Profiling as a Fragmentomic Marker in Cancer, Pregnancy, and Transplantation",
    "Fragmentation landscape of cell-free DNA revealed by deconvolutional analysis of end motifs",
    "Unsupervised detection of fragment length signatures of circulating tumor DNA using non-negative matrix factorization",
    "Early Detection of Malignant and Premalignant Peripheral Nerve Tumors Using Cell-Free DNA Fragmentomics",
    "Detection and discrimination of intracranial tumors using plasma cell-free DNA methylomes",
    "Comprehensive human cell-type methylation atlas reveals origins of circulating cell-free DNA in health and disease",
    "Cell-free DNA Comprises an In Vivo Nucleosome Footprint that Informs Its Tissues-Of-Origin",
    "Inference of transcription factor binding from cell-free DNA enables tumor subtype prediction and early detection",
    "Cell-free DNA from germline TP53 mutation carriers reflect cancer-like fragmentation patterns",
    "Multiplatform molecular profiling uncovers two subgroups of malignant peripheral nerve sheath tumors with distinct therapeutic vulnerabilities",
    "Genomic Patterns of Malignant Peripheral Nerve Sheath Tumor (MPNST) Evolution Correlate with Clinical Outcome and Are Detectable in Cell-Free DNA",
    "Genomic and epigenomic analysis of plasma cell-free DNA identifies stemness features associated with worse survival in lethal prostate cancer",
    "Circulating tumour DNA methylation markers for diagnosis and prognosis of hepatocellular carcinoma",
    "Fragment Length of Circulating Tumor DNA",
    "An improved ATAC-seq protocol reduces background and enables interrogation of frozen tissues",
    "Enzymatic methyl sequencing detects DNA methylation at single-base resolution from picograms of DNA",
    "A framework for clinical cancer subtyping from nucleosome profiling of cell-free DNA",
    "Transcription factor–nucleosome dynamics from plasma cfDNA identifies ER-driven states in breast cancer",
    "Ex vivo to in vivo model of malignant peripheral nerve sheath tumors for precision oncology"
]

# Loop through titles and fetch PMIDs
for title in titles:
    pmid = fetch_pmid(title)
    print(f"Title: {title}\nPMID: {pmid}\n")
#+end_src
https://nf-co.re/sarek/3.5.0/
*** Development                                                         :dev:
:PROPERTIES:
:ID:       ba6e2aa0-217b-46f8-a8c3-e7b5e774b952
:END:
**** v0.1.0
:PROPERTIES:
:ID:       7471f01b-fefb-4cc5-9eab-abf13a1b4d0a
:END:
***** sifs to szymanski RIS
:PROPERTIES:
:ID:       017e0e8e-af37-4365-ad9e-e4c71ee96a05
:END:
**** Ideas
:PROPERTIES:
:ID:       1a00532b-6854-48e5-9860-17d62fe1100e
:END:
- molecular disease signatures
- https://www.reddit.com/r/commandline/comments/vcs92o/scitopdf_quickly_fetch_science_from_scihub/
- https://slowkow.com/publications/
- Data dictionary
  #+name: biotools_docker_versions
  | cutadapt_version |    1.18 |
  | mirdeep2_version | 2.0.1.2 |
  | bowtie           |     1.2 |
  #+name: injest_biotools_docker_versions
- Ideas
   - make test data
** General Reference
:PROPERTIES:
:CREATED:  [2020-04-23 Thu 08:54]
:ID:       98f8c0e9-cdfc-4acb-b98c-5db1bd6bc3ca
:END:
- https://www.reddit.com/r/bioinformatics/comments/1n25lfn/exemplary_papers_on_multiomics_integration_with/
- https://www.reddit.com/r/bioinformatics/comments/1mi4hlp/most_influential_or_just_funtoread_papers/
- https://www.reddit.com/r/bioinformatics/comments/1i36e7s/a_step_by_step_tutorial_to_recreate_a_genomic/
- https://ngs101.com/how-to-analyze-rnaseq-data-for-absolute-beginners-part-13-circular-rnaseq-analysis/
- https://www.reddit.com/r/bioinformatics/comments/1go98kz/any_bioinformatics_blogs_out_there/
- CGC Webinars and Special Seminars https://www.cancergenomics.org/cgc_webinars_and_special_semin.php
- https://compgenomr.github.io/book/
- https://www.reddit.com/r/bioinformatics/comments/1dy4vxm/most_interesting_bioinformatics_papers_youve_come/

https://www.reddit.com/r/bioinformatics/comments/1d3ly2o/in_your_opinion_what_are_the_most_important/
https://www.reddit.com/r/bioinformatics/comments/1d3cz1j/remember_that_whole_cancer_microbiome_drama_the/
- https://www.reddit.com/r/bioinformatics/comments/1bal1ji/what_are_some_cancer_databases_that_yall_use/
- https://github.com/mikelove/awesome-multi-omics
- https://compgenomr.github.io/book/
- https://github.com/pachterlab/BI-BE-CS-183-2023
- https://hgserver1.amc.nl/cgi-bin/r2/main.cgi?open_page=login
- https://www.reddit.com/r/bioinformatics/comments/17svhsq/genome_in_a_bottle_just_released_hg002_v10_new/
- https://github.com/fgomez02
- https://ai.tinybio.cloud/chat?rdt_cid=3878222416981413620
- https://www.reddit.com/r/bioinformatics/comments/154v2k6/resources_for_learning_best_practices_for_writing/

- https://www.cancergenomics.org/cgc_webinars_and_special_semin.php
- https://cancergenomics.org/meetings/2022_annual_meeting_presentati.php
- https://www.reddit.com/r/bioinformatics/comments/12402xq/what_are_the_struggles_that_bioinformatician_face/
- https://www.reddit.com/r/bioinformatics/comments/13i5mgf/we_have_got_a_pin_up_board_in_our_bioinfo_lab_i/
- https://hpc.nih.gov/apps/
- https://wikis.utexas.edu/display/bioiteam/MultiQC+-+fastQC+summary+tool+--+GVA2021
- https://www.youtube.com/playlist?list=PLEEE2A91B09B77B4A
- https://www.reddit.com/r/bioinformatics/comments/11sx6vo/whats_the_best_way_to_catch_up_on_mathematics_for/
- https://mobile.twitter.com/jsantoyo/status/1139238326454669312
- [[https://www.cell.com/cancer-cell/fulltext/S1535-6108(22)]]
- https://www.cell.com/cell/fulltext/S0092-8674(22)01379-4
- https://rnnh.github.io/bioinfo-notebook/;
- https://yulab-smu.top/biomedical-knowledge-mining-book/index.html
- https://www.nature.com/articles/s43018-022-00467-x#Sec8
- https://bioinfocore.com/blog/
- https://www.reddit.com/r/bioinformatics/comments/ys65uy/lessons_learned_from_a_bioinformatics_msc/
https://www.reddit.com/r/bioinformatics/comments/xoltse/golden_rules_of_data_analysis/
https://www.nature.com/articles/s41588-022-01179-9
https://aacrjournals.org/cancerdiscovery/article/doi/10.1158/2159-8290.CD-22-0200/708156/Proteogenomic-markers-of-chemotherapy-resistance
- multi-omics population disease characterizations
  - https://www.frontiersin.org/articles/10.3389/fonc.2022.932337/full
https://www.reddit.com/r/bioinformatics/comments/wtnu0f/staying_up_to_date_with_processestechnology/
- https://www.omicsdi.org/
- https://hpc.nih.gov/training/gatk_tutorial/preproc.html
- https://www.ncbi.nlm.nih.gov/assembly/model/
- https://github.com/pfields8/Fields_et_al_2018
- https://darwinsark.org/forums/topic/open-source-database/
- https://www.reddit.com/r/bioinformatics/comments/uf4q2m/what_was_your_bioinformatics_success_story_of_the/
- https://www.reddit.com/r/bioinformatics/comments/rc9901/how_do_you_see_the_future_of_computational/
- https://www.reddit.com/r/bioinformatics/comments/r941br/does_this_learning_path_seem_good_to_become_a/
- https://docs.gdc.cancer.gov/Data/Introduction/
- https://www.reddit.com/r/bioinformatics/comments/u0ppfq/can_you_recommend_a_textbook_that_gives_a/
- https://bioinformatics.chat/
- http://labs.pathology.jhu.edu/halushka/science/
- https://www.reddit.com/r/ProgrammerHumor/comments/tpo157/after_every_scrum_meeting/
- https://www.nature.com/articles/s41592-022-01412-7
- [[https://bioinformaticsresourceportal.wustl.edu/][Washington University Computational Biology & Bioinformatics Resource Portal]]
- https://www.reddit.com/r/bioinformatics/comments/skiod8/whats_your_setup_like_to_make_your_life_easier/
- https://mail.google.com/mail/u/0/#inbox/FMfcgzGmtrSDsSwZKDbRkXhVfzJPStMW
- https://www.sciencedirect.com/science/article/pii/S2666979X21000367?via%3Dihub
- https://github.com/genome/bfx-workshop
- https://www.biostars.org/p/190366/
- https://wustl.app.box.com/s/00qniw32ng670650r1cz5bljq2uja4q1
- https://pubmed.ncbi.nlm.nih.gov/34935906/
- https://www.cancergenomicscloud.org/
- https://www.reddit.com/r/bioinformatics/comments/rkqci9/whats_something_cool_and_exiting_going_on_in/
- https://med.stanford.edu/dbds/education/workshops-in-biostatistics/workshop-archives.html
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5302158/
- https://www.reddit.com/r/bioinformatics/comments/pt7ecx/to_all_the_seasoned_bioinformaticians_out_there/
- https://github.com/genome/bfx-workshop/blob/master/README.md#communications
- https://rockefelleruniversity.github.io/Bioconductor_Introduction/
- https://github.com/Bioinformatics-Research-Network/training-requirements

- https://www.reddit.com/r/bioinformatics/comments/n2fwz4/what_is_something_that_you_realized_that_entirely/
- https://www.reddit.com/r/bioinformatics/comments/n2fwz4/what_is_something_that_you_realized_that_entirely/

- https://www.reddit.com/r/bioinformatics/comments/nawxng/bioinformaticianswhat_do_you_wish_wet_lab/?sort=controversial
- http://bioconductor.org/packages/stats/
  - top 75
    - http://bioconductor.org/packages/release/bioc/html/fgsea.html
    - http://bioconductor.org/packages/release/bioc/html/DOSE.html
- https://project-awesome.org/danielecook/Awesome-Bioinformatics
- [[https://www.youtube.com/channel/UCQqQpIx3zQPaifBj67ocv1w][BabrahamBioinf youtube]]
- https://www.freecodecamp.org/news/python-for-bioinformatics-use-machine-learning-and-data-analysis-for-drug-discovery/
- https://pages.10xgenomics.com/ugm-2020-10-event-ra_g-user-group-meeting-amr_on-demand.html?src=email&utm_medium=email&lss=internal&utm_source=internal&cnm=ugm-2020-10-event-ra_g-user-group-meeting-amr&utm_campaign=ugm-2020-10-event-ra_g-user-group-meeting-amr&useroffertype=event&userresearcharea=ra_g&userregion=multi&mktouserid=1629122
- https://slowkow.com/
- http://rafalab.github.io/pages/harvardx.html
- https://www.cancer.gov/about-nci/organization/ccg/research/structural-genomics/tcga/publications

- https://scilifelab.github.io/courses/
- https://www.reddit.com/r/bioinformatics/comments/m78kqb/what_are_the_best_book_i_could_get_for_a/

- https://www.reddit.com/r/bioinformatics/comments/m2o63g/best_courses_or_material_to_learn_bioinformatics/

- https://learn.gencore.bio.nyu.edu/
- cite:buffalo2015
- biotools bash functions in ./src
- https://www.reddit.com/r/bioinformatics/comments/lfusag/skills_required_for_being_a_proficient/
- cite:peters2018
- https://github.com/jdidion/biotools
- https://support.bioconductor.org/#search-anchor
- https://informatics.fas.harvard.edu/category/tutorials.html
- https://www.youtube.com/channel/UCv4IbnP9j9RC_aZAs8wqdeQ
- https://www.broadinstitute.org/genome-sequencing/broadillumina-genome-analyzer-boot-camp
- https://cloud.genepattern.org/gp/pages/login.jsf
- https://github.com/genome/analysis-workflows
- https://github.com/genome/bfx-workshop
https://github.com/seanken
http://genomewiki.ucsc.edu/index.php/Main_Page
https://genome.ucsc.edu/FAQ/index.html
  - https://basespace.illumina.com/dashboard
    - - dragon aligner
  - https://www.reddit.com/r/bioinformatics/comments/5wo75h/ben_ward_julia_for_bioinformatics_and/
  - https://platform.dnanexus.com/login
  - https://www.ecseq.com/
    - https://www.ecseq.com/workshops/ngs-data-analysis-courses
  - repos
    - https://github.com/Illumina
    - https://github.com/chrisamiller
  - https://www.reddit.com/r/bioinformatics/comments/cxlsh5/outdated_software_still_in_use/
  - https://github.com/pditommaso/awesome-pipeline
  - https://coding4medicine.com/cheatsheets/
  - https://github.com/genome/bfx-workshop
  - examples
    - papers
      - https://www.sciencedirect.com/science/article/pii/S009286741830309X#sec4
      - good github repos
        - https://github.com/ding-labrecip
        - https://github.com/pstew
  - https://www.rockefeller.edu/genomics/

  - https://www.reddit.com/r/bioinformatics/comments/iv7xjj/biologist_with_minimal_coding_background/
  - old docker setup code
  #########1#########2#########3#########4#########5#########6#########7#########8
  # DEV
  # check if inside docker
  # if [ -f /.dockerenv ];then
  #     dockercontainer=yes
  #     echo "Your are in a docker container"
  # else
  #     dockercontainer=no
  #     echo "Not in docker"
  #     # setup NON-docker variables
  #     shopt -s nocasematch
  #     case $HOSTNAME in
  #         (radonc-cancerbio) server_home="/home/jeszyman" ;;
  #         (jeszyman-*) server_home="/home/jeszyman" ;;
  #         (acl*) server_home="/home/jszymanski" ;;
  #         (virtual-workstation*.gsc.wustl.edu) server_home="/gscuser/szymanski" ;;
  #         (blade*.gsc.wustl.edu) server_home="/gscuser/szymanski" ;;
  #     esac
  #
  #     localdata="$server_home/data/$project/"
  #     unset $SERVER
  # fi
  #
  # case $dockercontainer in
  #     (yes) server_ask ;;
  #     (no) ;;
  # esac
  # #
  # case $SERVER in
  #     (chaudhuri-roche) projectdir=/drive3/users/jszymanski/repos/$project
  #                       localdata=/drive3/users/jszymanski/data/$project;;
  #     (NA) ;;
  # esac
  # #
  # # test data on cancerbio
  #NOT GENERAL
  #basedir=/media/jeszyman/4edbbc27-7e29-4667-9b24-f5a56d49d94e/users/jeszyman/data/mpnst
  #rm -rf $basedir/fastq-test
  #mkdir -p $basedir/fastq-test
  #zcat $basedir/fastq-nci/MPNST/14_JS0108CD040119_R1.fastq.gz | head -n 8000 > $basedir/fastq-test/short_14_JS0108CD040119_R1.fastq
  #zcat $basedir/fastq-nci/MPNST/14_JS0108CD040119_R2.fastq.gz | head -n 8000 > $basedir/fastq-test/short_14_JS0108CD040119_R2.fastq
  #zcat $basedir/fastq-washu/new_HiSeq-20_L007001_CTTC_R1.fastq.gz | head -n 8000 > $basedir/fastq-test/short_new_HiSeq-20_L007001_CTTC_R1.fastq.gz
  #gzip $basedir/fastq-test/*.fastq
  # setup project repo
- see gnu parallel in [[id:cd560390-aa1e-4c9e-8317-08610e5de42a][linux]]
- https://www.reddit.com/r/bioinformatics/comments/191ykr/resources_for_learning_bioinformatics/
*** education, tutorials, books, etc.
:PROPERTIES:
:CREATED:  [2019-04-26 Fri 10:36]
:ID:       374F30CA-2E80-4CC2-8FD3-5B9BC8083889
:END:
- https://www.reddit.com/r/bioinformatics/comments/rc9901/how_do_you_see_the_future_of_computational/
- https://www.reddit.com/r/bioinformatics/comments/r941br/does_this_learning_path_seem_good_to_become_a/
- https://www.reddit.com/r/bioinformatics/comments/esr5mw/any_good_books_about_bioinformatics/
- https://protocolexchange.researchsquare.com/browse?journal=protocol-exchange&subjectArea=Computational%20biology%20and%20bioinformatics

- https://www.melbournebioinformatics.org.au/tutorials/
- https://www.coursera.org/specializations/bioinformatics
- training, tutorials, etc.
  - https://bootcamp.biostars.io/
- https://jef.works/
- https://www.coursera.org/course/bioinformatics
- https://www.ebi.ac.uk/training/online/
- http://egtheory.wordpress.com/2013/06/09/toward-an-algorithmic-theory-of-biology/
- http://rosalind.info/problems/as-graph/
- https://www.nature.com/collections/vzsqzylnvx
- foundations
  - https://www.reddit.com/r/bioinformatics/comments/dckuuk/what_are_some_mathematically_rigorous_intro_books/
- https://wikis.utexas.edu/collector/pages.action?key=bioiteam
- https://www.sh-eahp.org/images/2017_Workshop/1_10ESHAP_2017.pdf
- https://www.reddit.com/r/bioinformatics/comments/bxgp0h/what_do_you_wish_someone_had_just_shown_you_early/
- https://girke.bioinformatics.ucr.edu/GEN242/mydoc_systemPipeRNAseq_06.html
- https://www.illumina.com/company/video-hub.html
- organizations and communities
  - http://www.scilifelab.se/
- [[id:2274F8F7-45D0-4F2F-BA32-4AF38C8A0F80][Molecular Pathology Compendium]]
- [[id:BDC42DA2-A632-4FB7-A586-E100B2A045DC][UNIX]]
- [[id:022FDD07-245F-4231-905E-ED18BE224889][Molecular Biology]]
- organizations
  - [[id:543E3788-28CC-4D16-943B-BC17523D66D9][McDonnell Genome Institute (MGI)]]
  - Broad
    - [[http://software.broadinstitute.org/software/cprg/?q=node/27][Broad ABSOLUTE]]
    - [[https://software.broadinstitute.org/gatk/documentation/topic?name=methods][Broad methods]]
  - [[http://www.sanger.ac.uk/science/tools][Wellcome Sanger]]
- education, tutorials, etc.
  - https://www.edx.org/learn/bioinformatics
  - https://www.coursera.org/learn/bioinformatics
  - http://bioinformaticsalgorithms.com/
  - https://www.reddit.com/r/bioinformatics/comments/ag7lc8/the_bible_of_bioinformatics/
  - https://bioinformatics.ca/workshops/workshops-2017/
  - [[http://bioinformatics.ucdavis.edu/training/documentation/][UC Davis Bioinformatics Core Workshops]]
  - http://rosalind.info/problems/locations/
  - https://www.reddit.com/r/bioinformatics/comments/6405tf/what_are_some_good_small_bioinformatics_projects/
  - [[http://userweb.eng.gla.ac.uk/umer.ijaz/bioinformatics/linux.html][Linux command line exercises for NGS data processing]]
  - https://biostar.myshopify.com/
  - https://www.reddit.com/r/bioinformatics/comments/7bntke/book_recommendations_to_be_a_better/
  - [[http://area51.stackexchange.com/proposals/109245/bioinformatics][StackExchange Bioinformatics]]
  - Well done sequencing papers http://www.nejm.org/doi/full/10.1056/NEJMoa1502214?rss=mostViewed&
  - http://seqanswers.com/
  - Training
    - https://collections.plos.org/compbiol-education
    - - https://docs.google.com/spreadsheets/d/1hIw66KCfdB0rowN7tJhyVjJv09Qv87r2B0sWLinVeS8/htmlview
    - https://www.broadinstitute.org/partnerships/education/broade/best-practices-variant-calling-gatk-1
    - - https://www.ebi.ac.uk/training/online/
    - - https://www.reddit.com/r/bioinformatics/comments/5miwnr/short_list_of_bioinformatics_skills/
    - https://bioinformatics.ca/workshops/2016
    - http://rosalind.info/problems/locations/
    - http://griffithlab.org/teaching/
    - http://evomics.org/workshops/2017-workshop-on-transcriptomics-harvard-university/
    - [[https://github.com/nekrut/BMMB554/wiki/7.-NGS-Processing:-QC,-Mapping,-etc][BMMB554 Introduction to data driven life sciences]].
  - https://satijalab.org/scgd/
  - https://www.genomeweb.com/resources/webinars
  - books
    - cite:low2017
    - cite:sinha2014

**** Notes
:PROPERTIES:
:ID:       90C0571F-2BB4-484B-8C2E-2385AD22A38C
:END:

[[http://onlinelibrary.wiley.com/book/10.1002/0471250953][Current Protocols in Bioinformatics]]

because computation removes redundancy, you will more frequently be at a new, tricky step

**** glossary
:PROPERTIES:
:CREATED:  [2019-05-14 Tue 10:25]
:ID:       80B5A347-33C6-4FC2-A691-FFAFF3C5D352
:END:

- https://software.broadinstitute.org/gatk/documentation/topic?name=dictionary&v=3
- [[http://useast.ensembl.org/info/genome/genebuild/biotypes.html][ensembl biotypes]]
- [[https://useast.ensembl.org/Help/Glossary][Ensembl glossary]]
- [[http://seqanswers.com/forums/showthread.php?t=13098][insert size]]: fragment size + length of both adapters
- [[http://seqanswers.com/forums/showthread.php?t=13098][fragment size]]: sequence between the paired-end adapters

*** ENCODE
:PROPERTIES:
:ID:       585e27b3-3c79-46d5-aeab-9430251d4318
:END:
- cite:becker2011
- https://www.annualreviews.org/doi/10.1146/annurev-genom-090413-025448#_i21
*** General reference                                                   :ref:
:PROPERTIES:
:ID:       ba1bcc2f-8468-4bb1-9425-3b01cfbc2db4
:END:
- https://osg-htc.org/
- [[id:D2FAA88D-70CC-4450-BBB3-8A446CB43AF3][Docker software]]
- https://github.com/orgs/genome/repositories?type=all
